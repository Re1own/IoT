!function(a){define(function(require,b,c){function d(){var a=location.hostname;return/:/.test(a)?/\[|\]/.test(a)?a:"["+a+"]":a}$hlsvideo=a('<div id="hlsvideo" style="background:rgb(0,0,0);position:absolute;top:-10000px;width:1px;height:1px"><div id="videoLoading" class="video_loading"><img src="image/videoLoading.gif" /></div><div id="videoFull" class="video_full" style="display:none" t="com.ResLimOpenVideoFailTip">'+tl("com.ResLimOpenVideoFailTip")+"</div></div>"),$hlsvideo.appendTo(document.body);var e,f,g=null,h=null,i=null,j=0,k="",l="",m=a("#videoLoading"),n=a("#videoFull"),o=0,p=5,q=0,r=c.exports={protocol:"http:",ip:d(),preivewport:"12965",playbackport:"12966",timeDelay:2e3,maxBufferLength:5,debug:!1,currentStream:0,sessionId:0,init:function(b,c,d){if(i=this,h=null,d&&d.length>0&&(i.sessionId=d),"playback"==b){var f={maxBufferLength:i.maxBufferLength,maxMaxBufferLength:6e3,debug:i.debug};h=new Hls(f);var j='<video id="hlsvideoplayer" width="100%" height="100%" controls></video>';$hlsvideo.find("video").remove(),$hlsvideo.append(j),g=a("#hlsvideoplayer"),g.on("mousemove",function(a){return a.preventDefault(),!1}),e=g[0]}else h=null,h=new Hls,$hlsvideo.find("video").remove(),$hlsvideo.append('<video id="hlsvideoplayer" width="100%" height="100%"></video>'),g=a("#hlsvideoplayer"),e=g[0]},cover:function(b){var c=a(b),d=c.offset(),e=c.width(),f=c.height();$hlsvideo.css({width:e,height:f,top:d.top,left:d.left,"z-index":9999}),"hls"==webApp.playMode?$hlsvideo.show():$hlsvideo.hide()},beginPlay:function(a,b){k=a,l=b,0==q&&(q=1,p>=o?(m.show(),n.hide()):n.show(),f=window.setTimeout(i.play,i.timeDelay))},play:function(){if(k)h&&(h.detachMedia(),h.loadSource(k),h.attachMedia(e),h.on(Hls.Events.MANIFEST_PARSED,function(){j=0,e.play(),g.on("ended",function(){j=1}),g.on("play",function(){n.hide(),m.hide(),o=0,1==j&&(j=0,l.dblclick())})}),g.on("timeupdate",function(){}),h.on(Hls.Events.ERROR,function(a,b){if(b.fatal)switch(b.type){case Hls.ErrorTypes.NETWORK_ERROR:n.show(),m.hide();break;case Hls.ErrorTypes.MEDIA_ERROR:}}),q=0);else{h.attachMedia(e);var a=r.protocol+"//"+r.ip+":"+r.preivewport+"/live/channel_0/streamType_"+i.currentStream+"/hls.m3u8?sessionId="+i.sessionId;h.loadSource(a),h.on(Hls.Events.MANIFEST_PARSED,function(){n.hide(),m.hide(),e.play(),o=0}),h.on(Hls.Events.ERROR,function(a,b){if(b.fatal)switch(b.type){case Hls.ErrorTypes.NETWORK_ERROR:o++,o>p&&(n.show(),m.hide()),q=0,i.stopLoad(),i.init("","",""),i.beginPlay();break;case Hls.ErrorTypes.MEDIA_ERROR:h.recoverMediaError()}}),q=1}},hideAndStopLoad:function(){h&&(h.stopLoad(),h.detachMedia(),h.destroy()),g&&g.remove(),$hlsvideo.hide(),m.hide(),o=0,h=null,k="",l="",q=0,window.clearTimeout(f)},stopLoad:function(){h&&(h.stopLoad(),h.detachMedia(),h.destroy()),g&&g.remove(),m.hide(),q=0,window.clearTimeout(f),h=null}}})}(jQuery);