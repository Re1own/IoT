!function(a){define(function(require,b,c){require("lib/aes"),require("lib/rsa");var d=c.exports={},e=0;d.webEncryption=function(b,c,d,e,f){void 0==c&&(c="OldDigest");var g={Protocol:"EncryptionProtocol",Params:{Encryption:c,Note:b}};d&&a.extend(g.Params,{Random:d}),e&&a.extend(g.Params,{Realm:e}),f&&a.extend(g.Params,{User:f});var h=g_ocx.ProtocolPluginWithWebCall(JSON.stringify(g));return JSON.parse(h).Result},d.setSession=function(a){e=a},d.getSession=function(){return e},d.devNotify={comet:!1,topics:{},getServerUrl:function(){var a="/SubscribeNotify.cgi?sessionId="+e;return a},initComet:function(){function b(b,c){if(0==b.comet){if(b.sessionID=e,a.browser.ie&&a.browser.version<9){var d={};d.connection=new ActiveXObject("htmlfile"),d.connection.open(),d.connection.write("<html>"),d.connection.write("<body>12345</body>"),d.connection.write("</html>"),d.connection.close(),d.iframediv=d.connection.createElement("div"),d.connection.appendChild(d.iframediv),d.connection.parentWindow.comet=d,d.iframediv.innerHTML="<iframe name='comet_iframe_new' src='"+c+"'></iframe>",d.connection.parentWindow.receiveMessage=b.publish.bind(b),b.iframe=d.connection.getElementsByTagName("iframe")[0]}else{var f=document.createElement("iframe");f.setAttribute("id","comet_iframe_new"),f.setAttribute("src",c),f.style.display="none",document.body.appendChild(f),b.iframe=f,window.receiveMessage=b.publish.bind(b)}b.comet=!0}else"ie"!=a.browser.name&&(window.receiveMessage=b.publish.bind(b))}b(this,this.getServerUrl())},subscribe:function(a,b){this.initComet(),this.sessionID!=e&&this.reconnect(),this.topics[a]||(this.topics[a]=[]),this.topics[a].push(b)},publish:function(b){var c=b.method;if(this.topics[c])try{var d=this.topics[c];a.each(d,function(a,c){c(b.params,b)})}catch(e){}},detach:function(b,c){if(c){var d=this.topics[b];a.each(d,function(a,b){return b===c?(d.splice(a,1),!1):void 0})}else delete this.topics[b]},reconnect:function(){this.iframe.src=this.getServerUrl(),this.sessionID=e}},d.Cookie=new function(){function a(a,c){var d={};if(b(a)&&a.length>0)for(var g,h,i,j=c?f:e,k=a.split(/;\s/g),l=0,m=k.length;m>l;l++){if(i=k[l].match(/([^=]+)=/i),i instanceof Array)try{g=f(i[1]),h=j(k[l].substring(i[1].length+1))}catch(n){}else g=f(k[l]),h="";g&&(d[g]=h)}return d}function b(a){return"string"==typeof a}function c(a){return b(a)&&""!==a}function d(a){if(!c(a))throw new TypeError("Cookie name must be a non-empty string")}function e(a){return a}var f=window.decodeURIComponent,g=window.encodeURIComponent,h=window.document;this.get=function(b,c){d(b),c="function"==typeof c?{converter:c}:c||{};var f=a(h.cookie,!c.raw);return(c.converter||e)(f[b])},this.set=function(a,b,e){d(a),e=e||{};var f=e.expires,i=e.domain,j=e.path;e.raw||(b=g(String(b)));var k=a+"="+b,l=f;return"number"==typeof l&&(l=new Date,l.setDate(l.getDate()+f)),l instanceof Date&&(k+="; expires="+l.toUTCString()),c(i)&&(k+="; domain="+i),c(j)&&(k+="; path="+j),e.secure&&(k+="; secure"),h.cookie=k,k},this.remove=function(a,b){return b=b||{},b.expires=new Date(0),this.set(a,"",b)}},d.Check=new function(){var b=this,c={alphaNumLine:/^[\da-zA-Z\-_]*$/,alphaNumLinePath:/^[\da-zA-Z\-_\/]*$/,alphaNumLineSpace:/^[\d\sa-zA-Z\-_]*$/,alphaNumLineQuoSpace:/^[\d\sa-zA-Z\-_\']*$/,number:/^[0-9]*$/,numAndLetter:/[^0-9a-zA-Z]/g,noQuotation:/^[^\'\"\“\”\’\‘]*$/,noQuotationColonAnd:/^[^\'\":;\&]*$/,noQuotationColonAndASCII:/^[^\":;\&|\x00-\x20]|\x7c*$/,filePath:/^[^\/:\*\?\"<>\|"]*$/,alphaNumUnderline:/^[\da-zA-Z_]*$/,alphaNumLineDot:/^[\da-zA-Z\-_\.]*$/,alphaNumLineDotA:/^[\da-zA-Z\-_\.@]*$/,email:/^[a-zA-Z\d_-]+((\.?[a-zA-Z\d_-])+|[a-zA-Z\d_-]?)@[a-zA-Z\d_-]+(\.{1}[a-zA-Z\d_-]+)+/,url:/^((http|https):\/\/(\w+:{0,1}\w*@)?(\S+)|)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?$/,ip:/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|0[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|0[0-9]{2}|[0-9]{1,2})$/i,mask:/^(254|252|248|240|224|192|128|0)\.0\.0\.0|255\.(254|252|248|240|224|192|128|0)\.0\.0|255\.255\.(254|252|248|240|224|192|128|0)\.0|255\.255\.255\.(255|254|252|248|240|224|192|128|0)$/,ipv6:/^\s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)(\.(25[0-5]|2[0-4]\d|1\d\d|[1-9]?\d)){3}))|:)))(%.+)?\s*$/,getnameString:/^[\w.@]+$/,mobile:/^[\d]{11}$/,noQuotationCN:/^[^\'\"|\u4E00-\u9FA5]*$/,noTagCharacter:/^[^\<\>]*$/,IC:/(^\d{15}$)|(^\d{18}$)|(^\d{17}(\d|X|x)$)/,Passport:/^[0-9a-zA-Z]{5,17}$/,noQuotationCNSpace:/^((?!\s|\'|\")[\x00-\xff])*$/};a.each(c,function(a,c){b[a]=function(a){return c.test(a)}}),b.require=function(a){return""!==a},b.ipv6ornull=function(a){return""===a||b.ipv6(a)},b.password=function(a){return!(/[\"]+/.test(a)||/[\']+/.test(a)||/[\u4E00-\u9FA5\u201C\u201D\u2018\u2019]+/.test(a)||/\s/.test(a))},b.phone=function(a){return!(/[\"]+/.test(a)||/[\']+/.test(a)||/[\u4E00-\u9FA5\u201C\u201D\u2018\u2019]+/.test(a))},b.rtsp=function(a){var b=/(rtsp:\/\/)(((\d+)[.]){3}(\d+))(.*)/i,c=a.match(b),d="";return c?(d=c[2],this.ip(d)?d:!1):!1},b.IPv6Ex=function(a){var b=/(^(::)$)|(^(:(:[0]{1,4}){1,7})$)|(^(([0]{1,4}:){1,7}([0]{1,4}))$)|(^(ff[a-f\d]{2}))/;return!b.test(a)}},d.Ip=function(){return{compareIpV4:function(a,b){for(var c=a.split("."),d=b.split("."),e=0;e<c.length;e++){var f=c[e]-d[e];if(0!=f)return f}return 0},compareIpv6:function(a,b){var c=compareIPv6(a,b);return 1==c?-1:2==c?1:0},isIpnull:function(a){return a.split(".").some(function(a){return""==a})},getIpValue:function(b){var c=[];b=a(b);var d=b.getAllNext("input");return d.splice(0,0,b),d.each(function(a){c.push(a.value)}),c.join("")?c.join("."):""},setIpValue:function(b,c){b=a(b),c=c||"...";var d=c.split("."),e=b.getAllNext("input");e.splice(0,0,b),e.each(function(a,b){a.value=d[b]})},isValidWithGateWay:function(a,b,c){for(var d=a.split("."),e=b.split("."),f=c.split("."),g=!0,h=0,i=0;4>i&&(h=h||e[i]-0,g=g&&(d[i]&e[i])==(e[i]&f[i]),g);i++);return g=g&&!!h},ipv4AddStep:function(b,c){var d=b.split("."),e=0,f=[];return a.each(d,function(a,b){e+=(b-0)*Math.pow(256,3-a)}),e+=c,f[0]=e>>>24>>>0,f[1]=e<<8>>>24>>>0,f[2]=e<<16>>>24,f[3]=e<<24>>>24,f.join(".")},getNetworkSegment:function(b,c){return c=c.split("."),a.map(b.split("."),function(a,b){return a&c[b]}).join(".")},validateMask:function(b){function c(a){return(a+256).toString(2).substring(1)}var d=a.map(b.split("."),function(a){return c(a-0)}).join("");return-1===d.indexOf("01")}}}(),function(){function b(a){var b=a.lastIndexOf(":"),d=a.slice(b+1);if(d.match(h)){var e=d.split(".");e=c(e[0])+c(e[1])+":"+c(e[2])+c(e[3]),a=a.slice(0,b+1)+e}return a.toLowerCase()}function c(a){return g(parseInt(a).toString(16),2)}function e(b){var c=[],d=b.split("::");if(2==d.length){var e=d[0].split(":"),f=d[1].split(":");1===e.length&&""===e[0]&&(e=[]),1===f.length&&""===f[0]&&(f=[]);var g=8-(e.length+f.length);for(a.each(e,function(a,b){c.push(b)});g;)c.push(0),g--;a.each(f,function(a,b){c.push(b)})}else 1==d.length&&(c=b.split(":"));return c}function f(b){return a.map(b,function(a){return g(a,4)}).join(":")}function g(a,b){for(var c=a.toString().length,d=b-c,e="";d;)e+="0",d--;return e+a.toString()}var h=/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/g;d.v6ToCanonicalForm=function(a){if(!d.Check.ipv6(a))return a;a=b(a);var c=e(a);return 8==c.length?f(c):a}}(),function(){for(var b=[1900,3800,5e3,5050,9999,37776,37777,37778,39999,42323],c=37780;37880>=c;c++)b.push(c);d.chkPort=function(c,d){return void 0===d?c-0>1024&&-1===a.inArray(c-0,b):c-0===d||c-0>1024&&-1===a.inArray(c-0,b)}}(),function(){function b(a){function c(a){a=a>16?16:a;var c=Math.random().toString();return"0"===c.substr(c.length-a,1)?b(a):c.substring(c.length-a)}return a>32?c(16)+c(16):a>16?c(16)+c(a-16):c(a)}d.EncryptInfo=function(c,d){var e="AES-128",f={},c=c.split(","),g=c[0].split(":"),h=c[1].split(":");return f[g[0]]=g[1],f[h[0]]=h[1],a.Deferred(function(a){require.async(["lib/aes","lib/rsa"],function(){var c,g,h,i,j=CryptoJS.mode.ECB,k=b(16),l={padding:CryptoJS.pad.ZeroPadding},m=new RSAKey;if(m.setPublic(f.N,f.E),webCaps.max_encryption_level){var n=webApp.EncryptInfo.cipher;~n.indexOf("ROAE")?(k=b(32),j=CryptoJS.mode.ECB,e="ROAE-256"):~n.indexOf("RPAC")&&(k=b(32),j=CryptoJS.mode.CBC,l.iv=CryptoJS.enc.Utf8.parse("0000000000000000"),e="RPAC-256")}l.mode=j,c=m.encrypt(k),g=CryptoJS.enc.Utf8.parse(k),h=CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(JSON.stringify(d)),g,l),i=h.toString(),a.resolve({salt:c,key:g,content:i,cipher:e})})}).promise()},d.EncryptInfoEx=function(a,c){var d={},a=a.split(","),e=a[0].split(":"),f=a[1].split(":");d[e[0]]=e[1],d[f[0]]=f[1];var g,h,i,j,k="AES-128",l=CryptoJS.mode.ECB,m=b(16),n={padding:CryptoJS.pad.ZeroPadding},o=new RSAKey;if(o.setPublic(d.N,d.E),webCaps.max_encryption_level){var p=webApp.EncryptInfo.cipher;~p.indexOf("ROAE")?(m=b(32),l=CryptoJS.mode.ECB,k="ROAE-256"):~p.indexOf("RPAC")&&(m=b(32),l=CryptoJS.mode.CBC,n.iv=CryptoJS.enc.Utf8.parse("0000000000000000"),k="RPAC-256")}return n.mode=l,g=o.encrypt(m),h=CryptoJS.enc.Utf8.parse(m),i=CryptoJS.AES.encrypt(CryptoJS.enc.Utf8.parse(JSON.stringify(c)),h,n),j=i.toString(),{salt:g,key:h,content:j,cipher:k}},d.UnEncryptInfo=function(b,c){return a.Deferred(function(a){require.async(["lib/aes","lib/rsa"],function(){var d=CryptoJS.mode.ECB,e={padding:CryptoJS.pad.ZeroPadding};if(webCaps.max_encryption_level){var f=webApp.EncryptInfo.cipher;~f.indexOf("ROAE")?d=CryptoJS.mode.ECB:~f.indexOf("RPAC")&&(d=CryptoJS.mode.CBC,e.iv=CryptoJS.enc.Utf8.parse("0000000000000000"))}e.mode=d;var g=CryptoJS.AES.decrypt(c,b,e);a.resolve(JSON.parse(CryptoJS.enc.Utf8.stringify(g)))})}).promise()},d.UnEncryptInfoEx=function(a,b){var c=CryptoJS.AES.decrypt(b,a,{mode:CryptoJS.mode.ECB,padding:CryptoJS.pad.ZeroPadding}),d=CryptoJS.mode.ECB,e={padding:CryptoJS.pad.ZeroPadding};if(webCaps.max_encryption_level){var f=webApp.EncryptInfo.cipher;~f.indexOf("ROAE")?d=CryptoJS.mode.ECB:~f.indexOf("RPAC")&&(d=CryptoJS.mode.CBC,e.iv=CryptoJS.enc.Utf8.parse("0000000000000000"))}e.mode=d;var c=CryptoJS.AES.decrypt(b,a,e);return JSON.parse(CryptoJS.enc.Utf8.stringify(c))}}(),function(){var a=function(a){return!/[^\d]/g.test(a)},b=function(a){return!/[^a-zA-Z]/.test(a)},c=function(a){return!/[a-zA-Z0-9]/.test(a)},e=function(a){return/\d/.test(a)},f=function(a){return/[a-zA-Z]/.test(a)},g=function(a){return/[A-Z]/.test(a)},h=function(a){return/[a-z]/.test(a)},i=function(a){return/[^a-zA-Z0-9]/.test(a)};d.pwdStrenthValidator=function(d){var g=d.length;return a(d)||b(d)||c(d)?5>=g?"weak":"middle":e(d)&&f(d)&&i(d)?g>3?"strong":"middle":4>g?"weak":8>=g?"middle":"strong"},d.newPwdStrenthValidator=function(a){for(var b=0,c=a.length,d=0,j=0,k=0;c>k;k++)e(a[k])&&d++,i(a[k])&&j++;return 4>=c?b+=5:c>4&&8>c?b+=10:c>=8&&(b+=25),g(a)&&h(a)||!f(a)?g(a)&&h(a)&&(b+=20):b+=10,1==d?b+=10:d>1&&(b+=20),1==j?b+=10:j>1&&(b+=25),e(a)&&g(a)&&h(a)&&i(a)?b+=5:e(a)&&(g(a)||h(a))&&i(a)?b+=3:e(a)&&(g(a)||h(a))&&(b+=2),b>=70?"strong":b>=50?"middle":"weak"},d.getPasswordStrong=function(a){var b=0,c=/[a-z]/;c.test(a)&&b++;var d=/[0-9]/;d.test(a)&&b++;var e=/[\`\~\!\@\#\$\%\^\*\(\)\-\_\=\+\\\|\[\{\}\]\,\<\.\>\/\?\ ]/;e.test(a)&&b++;var f=/[A-Z]/;return f.test(a)&&b++,b>=2?!0:!1}}(),d.chkMutilCallRet=function(b,c){var d=!0;if(a.isArray(b)){var e=a.grep(b,function(a){return a&&!a.result}).length;d=c?e!==b.length:!e}return d},function(){d.cgiGet=function(b,c,d,e){return a.ajax({url:b,username:c,password:d,success:e})}}(),function(){function a(a,b){for(var c,d=new Date(Date.UTC(a,b,0,0,0,0,0)),e=0,f=-1,g=-1*d.getTimezoneOffset()/60,h=0;50>h;h++){var i=new Date(Date.UTC(a,b,h,0,0,0,0)),j=-1*i.getTimezoneOffset()/60;if(j!==g){var k=0;for(e=h,i=new Date(Date.UTC(a,b,h-1,0,0,0,0)),j=-1*i.getTimezoneOffset()/60;-1===f;){if(i=new Date(Date.UTC(a,b,h-1,0,k,0,0)),j=-1*i.getTimezoneOffset()/60,j!==g){j=new Date(Date.UTC(a,b,h-1,0,k-1,0,0)),f=k;break}k++}return c=j.getMonth()+1,10>c&&(c="0"+c),c+="/"+j.getDate()+"/"+a+" ",i=new Date(Date.UTC(a,b,h-1,0,k,0,0)),c+=i.toTimeString().split(" ")[0]}}}d.displayDstSwitchDates=function(){var b=(new Date).getYear();1e3>b&&(b+=1900);for(var c=0,d=0,e=99,f=0;12>f;f++){var g=new Date(Date.UTC(b,f,0,0,0,0,0)),h=-1*g.getTimezoneOffset()/60;h>e?c=f-1:e>h&&(d=f-1),e=h}var i=a(b,d),j=a(b,c);return void 0===j&&void 0===i?[]:[j,i]}}(),d.preventM=function(b){a.browser.ie?document.documentElement.releaseCapture():(b=b?b:event,b.preventDefault())},d.getEncryptServerUrl=function(a,b){var c=a+"Security-cgi=1&salt=";return c=a+b}})}(jQuery);