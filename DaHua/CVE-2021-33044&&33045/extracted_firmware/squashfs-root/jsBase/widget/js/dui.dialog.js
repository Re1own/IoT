!function(a){var b=/%$/;a.widget("dui.dialog",{version:"1.0.1",widgetName:"dialog",widgetEventPrefix:"dialog",options:{model:!0,mask:"body",confirm:a.noop,"default":a.noop,cancel:a.noop,iframe:!1,beforeClose:a.noop,resize:a.noop,zIndex:10001,stopBubble:!0,dragable:!1},setting:function(b){this.options=a.extend(!0,this.options,b)},_create:function(){this._setupEvents(),this.options.dragable&&this._dragable()},_setupEvents:function(){this._on(this.handleEvents)},title:function(a){this.element.find(".u-dialog-head").find("h1").text(a)},show:function(b){var c=this,d=this.getPosition();if(c._trigger("show",null,null),c.options.model){var e=a.mask(c.options.mask,b||c.options.iframe);e&&e.zIndex((c.options.zIndex||10001)-1)}c.element.show().css({top:d.top,left:d.left,"z-index":c.options.zIndex||10001}),a(window).on("resize"+c.element.data("duiDialog").eventNamespace,function(){var a=c.getPosition();c.element.css({top:a.top,left:a.left}),c.options.resize()})},getPosition:function(){var b,c,d=this.element.outerWidth(),e=this.element.height(),f=document.documentElement.scrollWidth,g=document.documentElement.clientHeight;return/ie|firefox/.test(a.browser.name)&&(f=document.body.scrollWidth),b=(g-e)/2,c=(f-d)/2,b=0>b?0:b,c=0>c?0:c,{top:b/g*100+"%",left:c/f*100+"%"}},setPosition:function(a){this.element.css({top:b.test(a[0])?a[0]:a[0]+"px",left:b.test(a[1])?a[1]:a[1]+"px"})},close:function(){this.options.model&&a.unmask(this.options.mask),this.element.hide(),this._trigger("close",null,null),a(window).off("resize"+this.element.data("duiDialog").eventNamespace)},_dragable:function(){this.element.find(".u-dialog-head").css("cursor","move");var b,c,d,e=this.element.find(".u-dialog-head"),f=this.element,g=function(e){var g=f.position();c=g.left,d=g.top,b={posX:e.clientX-c,posY:e.clientY-d},document.onselectstart=new Function("return false"),a(document).on({mousemove:h,mouseup:i})},h=function(a){var c=f.css("top");f.css({left:a.clientX-b.posX+"px",top:a.clientY-b.posY+"px"}),f.offset().top<=0&&f.css("top",c)},i=function(){document.onselectstart=new Function("return true"),a(document).off({mousemove:h,mouseup:i})};e.mousedown(g)},handleEvents:{"click [data-action]":function(b){var c=a(b.currentTarget).attr("data-action");switch(c){case"cancel":case"close":var d=this;if(d[c]){var e=d.options.beforeClose();a.isDeferred(e)?e.done(function(){d[c].apply(d)}):e!==!1&&d[c].apply(d)}d.options.cancel&&d.options.cancel.call(d);break;default:this._trigger(c,null,{ui:this})}this.options.stopBubble&&b.stopPropagation()}}})}(jQuery),function(a){var b='<div class="u-dialog">                        <div class="u-dialog-head">                            <h1></h1>                            <i class="i-close" data-action="close"></i>                        </div>                        <div class="u-dialog-content"></div>                    </div>';a.dialog=function(b){return new a.dialog.init(b)},a.dialog.defaults={title:"",content:"",model:!0,mask:"body",closeable:!0,maincss:""},a.dialog.init=function(b){this.options=a.extend({},a.dialog.defaults,b),this.render(),this.events(),this.show()},a.dialog.prototype=a.dialog.init.prototype={render:function(){this.element=a(b),this.element.addClass(this.options.maincss),this.element.find(".u-dialog-head").find("h1").text(this.options.title),this.element.find(".u-dialog-content").html(this.options.content);var c,d=this.options.buttons;if(d&&d.length){c='<div class="u-dialog-foot">';for(var e=0;e<d.length;e++)c+='<a class="u-button" data-btnIndex="'+e+'" wgt='+d[e].name+"></a>";c+="</div>",this.element.append(c).trans_wgt()}this.options.closeable||this.element.find(".i-close").hide(),this.element.appendTo(document.body)},close:function(){this.options.model&&a.unmask(this.options.mask),this.element.hide().remove()},show:function(){var b=this.options.zIndex||10001;if(this.options.model){var c=a.mask(this.options.mask,this.options.iframe);c&&c.zIndex(b-1)}this.options.width&&this.element.css("width",this.options.width),this.element.css({"margin-top":"-"+this.element.height()/2+"px","margin-left":"-"+this.element.width()/2+"px","z-index":b}).show()},events:function(){var b=this.options.buttons,c=this.options.closeByNavigationHandle,d=this;this.element.on("click","[data-action=close]",function(){if(d.options.closeable){var e=d.options.iconIndex;if("number"==typeof e&&b[e]&&a.isFunction(b[e].callback))b[e].callback.call(d);else if(a.isFunction(c)){var f=c.call(d);f!==!1&&d.close()}}}),this.element.on("click","[data-btnIndex]",function(c){var e=a(c.currentTarget).attr("data-btnIndex");b[e]&&a.isFunction(b[e].callback)&&b[e].callback.call(d)})}},a.confirm=function(b,c,d,e,f,g){return a.dialog(a.extend({title:b,closeable:f,content:'<i class="i-dialog-warn"></i><span class="fn-lineh26 u-dialog-context">'+c+"</span>",buttons:[{name:"Yes",callback:function(){this.close(),a.isFunction(d)&&d()}},{name:"No",callback:function(){this.close(),a.isFunction(e)&&e()}}],iconIndex:1,zIndex:10005},g))},a.alert=function(b,c,d,e){return a.dialog(a.extend({closeable:d,content:'<i class="i-dialog-warn"></i><span class="fn-lineh26 u-dialog-context">'+b+"</span>",buttons:[{name:"Yes",callback:function(){this.close(),a.isFunction(c)&&c()}}],iconIndex:0,zIndex:10005},e))}}(jQuery);