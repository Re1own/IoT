!function(a){define(function(require,a,b){b.exports=require("jsCore/pageTab")}),define("rulesConfig",function(require,b,c){function d(a,b){return a-b}var e=require("jsCore/pageBase"),f=require("jsCore/rpc"),g=require("jsCore/rpcLogin"),h=require("jsCore/plugin"),i=require("jsCore/modules/timeSection");require("jsCore/modules/eventHandler");var j=null,k=null,l=null,m=null,n=null,o=null,p=null,q=[],r=!1,s=!1,t=null,u=null,v=8,w=a("#i_parking_tip"),x=0,y=!1,z=-1,A=null;c.exports=e.extend({init:function(){t=this,t._initParkTable(),first_tr_table_stutas=!0,t._getTemplates(),ability.get("VideoInputCaps").done(function(a){y=a&&a.ElectricFocus&&g.chkAuthority("VideoInputConfig")&&g.chkAuthority("Monitor_01")}),ability.get("IVSCaps").done(function(a){v=a&&a.SupportedScenes.ParkingSpace&&a.SupportedScenes.ParkingSpace.MaxRules||8}),webApp.EventCaps?f.EventManager.getEventLink(["TrafficParkingSpaceParking","TrafficParkingSpaceNoParking"]).done(function(b){var c=b.name,d=a.extend({},webApp.DefaultEvent),e=webApp.EventCaps;"default"===c[x][0]?d=e:c[x].each(function(a){d[a]=!0,"AlarmOutEnable"===a?d.AlarmOutLatch=e.AlarmOutLatch:"DejitterEnable"===a?d.DejitterRange=e.DejitterRange:"RecordEnable"===a&&(d.RecordLatch=e.RecordLatch)}),t.$("#parking_alrm_event").eventHandler(d)}).fail(function(){t.$("#parking_alrm_event").eventHandler()}):t.$("#parking_alrm_event").eventHandler(),t.bind(),t.render()},bind:function(){t.$("#parking_checkSensitivityNoLicense,#parking_checkSensitivityHasLicense").numberfield({max:10,min:1,allowDecimal:!1}),t.$("#parking_alrm_btn a").on("click",function(){t.$(this).hasClass("ui-channel-item-current")?t.$(this).removeClass("ui-channel-item-current"):t.$(this).addClass("ui-channel-item-current")}),t.$("#parking_timeSection").on("click",function(){var a=t._doubleDirBindData(),b=null,c=null;if(a){b=a.rule1,c=a.rule2,h.hide();var d=b.EventHandler.TimeSection;i.open(d).done(function(a){for(var b=0;b<n[x].length;b++)n[x][b].Class&&"ParkingSpace"==n[x][b].Class&&n[x][b].PtzPresetId==t.$("#ipcparkingSpace_presets").val()-0&&(n[x][b].EventHandler.TimeSection=a);h.cover("#i_parking_video")}).fail(function(){h.cover("#i_parking_video")})}}),t.$("#parking_checkSensitivityNoLicense,#parking_checkSensitivityHasLicense").on("blur",function(){var b=t._doubleDirBindData(),c=null,d=null;b&&(c=b.rule1,d=b.rule2,-1!=a(this).attr("id").indexOf("Has")?(c.Config.PlateSensitivity=a(this).val()-0,d.Config.PlateSensitivity=a(this).val()-0):(c.Config.NoPlateSensitivity=a(this).val()-0,d.Config.NoPlateSensitivity=a(this).val()-0))}),t.$("#parkingSpace_drawArea").on("click",function(){t._drawCarDeteArea()}),t.$("#parkingSpace_clearArea").on("click",function(){t._delCarDeteArea()})},render:function(){t._openVideo(),t._getRefreshData(!1),h.addEvent("OutPutStringInfo",function(a,b){"OutPutModuleRect"==a&&t._setCarDetecAreaValue(b),"OutPutGlobalInfo"==a&&t._setCarPosValue(b)})},leave:function(){t._closeVideo()},_openVideo:function(){h.cover("#i_parking_video",function(){h.SetModuleMode(2),webApp.CHANNEL_NUMBER>1?(h.SetVisibleView(0,x),h.ConnectRealVideo(x,1)):g.chkAuthority("Monitor_01")&&h.open()})},_closeVideo:function(){h.addEvent("OutPutStringInfo",null),h.EnableIVSConfig(!1),h.ReasetShapeShow(0),h.hide(),h.close()},_initParkTable:function(){u=t.$("#parkingSpace_ruleManager").table({height:180,selectAllPage:!0,columns:[{check:"carPosEnable",width:"8%",handle:function(){return!1}},{t:tl("com.Number"),width:"8%",render:function(b){return a("<i class='onlyCarNum' onlynum='"+b.number+"'>"+(b._index+1)+"</i>")}},{t:tl("ivs.CarposName"),width:"30%",fields:"carLaneName",editor:function(){return a('<input type="text" class="u-input"/>').textfield({length:32,asciiByte:2,notAsciiByte:3,validReg:/^[^'"\|\&]+$/,errorHandle:"prevent",error:function(){t.$("#i_parking_tip").tip("error",tl("com.LimitStringInput"))}})}},{title:tl("com.Name"),width:"30%",fields:"rulesType",valueMap:{1:tl("ivs.CarposDete")},editor:function(b,c){var d="",e=c.valueMap;if(e){d="<select>";for(var f in e)d+='<option value="'+f+'">'+e[f]+"</option>";d+="</select>"}return a(d)}},{t:tl("ivs.Protract"),width:"12%",action:"paintCarpos",icon:"ui-table-icon-area drawEx",preventEvt:!1,handle:function(b){var c=b.number-0,d=b.carLaneName;t._drawCarpos(c,d);var e=a("i[onlynum='"+c+"']").parents("tr").children("td").children("i[data-action='paintCarpos']");e.hasClass("deawEX-open")?e.removeClass("deawEX-open").addClass("deawEX-close"):e.removeClass("deawEX-close").addClass("deawEX-open")}},{action:"com.Delete",icon:"i-clear",width:"12%",titleIcon:"i-add",handle:function(a){this.del(a);for(var b=a.number-0,c=a.carLaneName,d=0;d<q.length;d++)b==q[d].Number&&q[d].PtzPresetId==t.$("#ipcparkingSpace_presets").val()-0&&q.splice(d,1);for(var d=0;d<n[x].length;d++)n[x][d].Class&&"ParkingSpace"==n[x][d].Class&&n[x][d].Config.LaneNumber==b&&n[x][d].PtzPresetId==t.$("#ipcparkingSpace_presets").val()-0&&(n[x].splice(d,1),d--);return t._delCarpos(b,c),0==q.length&&t.$("#parking_rules_field").addClass("fn-hide"),!1},titleAction:function(){if(null!==q){var b=[];if(a.each(q,function(a,c){c.PtzPresetId===z&&b.push(c)}),b.length>=v/2)return void alert(tl("ivs.MaxCarposCounts")+v/2+"！");var c=t._findCarLaneNum(),d={number:"",carLaneName:"",rulesType:"1",area:[],carPosEnable:!0,PtzPresetId:0};d.number=c,d.carLaneName="N100"+(c+1),d.rulesType="1",d.area=[],d.carPosEnable=!0,d.PtzPresetId=t.$("#ipcparkingSpace_presets").val()-0;var e=q.length;u.table("add",d,e).table("selectRow",e);var f={};f.Number=d.number,f.CustomParkNo=d.carLaneName,f.Area=jQuery.extend(!0,[],d.area),f.PtzPresetId=d.PtzPresetId,q.push(f);var g=jQuery.extend(!0,{},k.ParkingSpace.TrafficParkingSpaceNoParking),h=jQuery.extend(!0,{},k.ParkingSpace.TrafficParkingSpaceParking);g.Config.LaneNumber=f.Number,h.Config.LaneNumber=f.Number,g.Name="N100"+(f.Number+1),h.Name="N100"+(f.Number+1),g.Enable=d.carPosEnable,h.Enable=d.carPosEnable,g.PtzPresetId=d.PtzPresetId,h.PtzPresetId=d.PtzPresetId,a.each(n[x],function(a,b){"ParkingSpace"===b.Class&&b.PtzPresetId===d.PtzPresetId&&(g.EventHandler.TimeSection=b.EventHandler.TimeSection,h.EventHandler.TimeSection=b.EventHandler.TimeSection)}),n[x].push(g,h),0!=q.length&&t.$("#parking_rules_field").removeClass("fn-hide")}}}],onRowSelect:function(b,c){var d=!1;a.each(n[x],function(a,b){"ParkingSpace"===b.Class&&b.PtzPresetId===z&&(d=!0)}),null!==A&&d&&t._saveruleEventhandle(A);var e=c.data.number-0,f=c.data.carLaneName;A=e,t._selectCarPosRenderRules(e),t._showHighlightCurCarpos(e,f);var g=t.$("i[onlynum='"+e+"']").parents("tr").children("td").children("i[data-action='paintCarpos']");g.hasClass("deawEX-open")&&t._drawCarpos(e,f)},onblurEditor:function(a,b){if("carLaneName"==b.field){var c=b.editVal,d=b.data.number,e=b.data.carLaneName;t._editorCurposName(d,c,e)}}})},_doubleDirBindData:function(a){if(q&&t.$("#parkingSpace_ruleManager tbody tr.current").length>0){if(void 0!==a)var b=a;else var b=t.$("#parkingSpace_ruleManager tbody tr.current i.onlyCarNum").attr("onlynum")-0;for(var c=null,d=null,e=0;e<n[x].length;e++)n[x][e].Class&&"ParkingSpace"==n[x][e].Class&&(n[x][e].Config.LaneNumber==b&&"TrafficParkingSpaceNoParking"==n[x][e].Type&&n[x][e].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0&&(c=n[x][e]),n[x][e].Config.LaneNumber==b&&"TrafficParkingSpaceParking"==n[x][e].Type&&n[x][e].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0&&(d=n[x][e]));return{rule1:c,rule2:d}}return null},_saveruleEventhandle:function(a){var b=t._doubleDirBindData(a),c=null,d=null;b&&(c=b.rule1,d=b.rule2,c.EventHandler=t.$("#parking_alrm_event").eventHandler("get"),d.EventHandler=t.$("#parking_alrm_event").eventHandler("get"))},_selectCarPosRenderRules:function(b){for(var c=null,d=!1,e=0,f=0;f<n[x].length;f++)if(n[x][f].Class&&"ParkingSpace"==n[x][f].Class&&n[x][f].PtzPresetId===z&&(d=!0,e=f,n[x][f].Config.LaneNumber==b)){c=n[x][f];break}null===c&&(c=a.extend(!0,{},k.ParkingSpace.TrafficParkingSpaceNoParking),d&&(c.EventHandler.TimeSection=n[x][e].EventHandler.TimeSection)),t.$("#parking_alrm_event").eventHandler("set",c.EventHandler),t.$("#parking_checkSensitivityNoLicense").val(c.Config.NoPlateSensitivity),t.$("#parking_checkSensitivityHasLicense").val(c.Config.PlateSensitivity)},_findCarLaneNum:function(){for(var a=[],b=[],c=0;v>c;c++)a.push(c);for(var c=0;c<q.length;c++)q[c].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0&&b.push(q[c].Number);if(0==b.length)return 0;for(var c=0;c<b.length;c++)for(var d=0;d<a.length;d++)a[d]==b[c]&&(a.splice(d,1),d--);return a[0]},_getTemplates:function(){f.VideoInAnalyse.getTemplateGlobal().done(function(a){j=a}),f.VideoInAnalyse.getTemplateRule("ParkingSpace").done(function(a){k=a}).fail(function(){k={ParkingSpace:{TrafficParkingSpaceNoParking:{Class:"ParkingSpace",Config:{Delay:2,LaneNumber:0,NoPlateSensitivity:7,PlateSensitivity:4},Enable:!0,EventHandler:{AlarmOutChannels:[0],AlarmOutEnable:!0,AlarmOutLatch:10,BeepEnable:!1,Dejitter:0,Delay:30,ExAlarmOutChannels:[0],ExAlarmOutEnable:!1,LinkDetailCamera:{Enable:!1,Item:"AutoTrack"},LogEnable:!1,MMSEnable:!1,MailEnable:!1,MatrixChannels:[0],MatrixEnable:!1,MessageEnable:!1,OnVideoMessageEnable:!1,PtzLink:[["None",0,0,0,0]],PtzLinkEnable:!1,RecordChannels:[0],RecordEnable:!1,RecordLatch:10,Snapshot:1,SnapshotChannels:[0],SnapshotEnable:!0,SnapshotPeriod:0,SnapshotTimes:1,SnapshotTitleEnable:!0,TimeSection:[["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"]],TourChannels:[0],TourEnable:!1,VoiceEnable:!1},Id:0,Name:"TrafficParkingSpaceNoParking0",ObjectTypes:["Unknown"],PtzPresetId:0,Type:"TrafficParkingSpaceNoParking"},TrafficParkingSpaceParking:{Class:"ParkingSpace",Config:{Delay:2,LaneNumber:0,NoPlateSensitivity:7,PlateSensitivity:4},Enable:!0,EventHandler:{AlarmOutChannels:[0],AlarmOutEnable:!0,AlarmOutLatch:10,BeepEnable:!1,Dejitter:0,Delay:30,ExAlarmOutChannels:[0],ExAlarmOutEnable:!1,LinkDetailCamera:{Enable:!1,Item:"AutoTrack"},LogEnable:!1,MMSEnable:!1,MailEnable:!1,MatrixChannels:[0],MatrixEnable:!1,MessageEnable:!1,OnVideoMessageEnable:!1,PtzLink:[["None",0,0,0,0]],PtzLinkEnable:!1,RecordChannels:[0],RecordEnable:!1,RecordLatch:10,Snapshot:1,SnapshotChannels:[0],SnapshotEnable:!0,SnapshotPeriod:0,SnapshotTimes:1,SnapshotTitleEnable:!0,TimeSection:[["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"],["1 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59","0 00:00:00-23:59:59"]],TourChannels:[0],TourEnable:!1,VoiceEnable:!1},Id:0,Name:"TrafficParkingSpaceParking0",ObjectTypes:["Unknown"],PtzPresetId:0,Type:"TrafficParkingSpaceParking"}}}}),f.VideoInAnalyse.getTemplateModule("Normal").done(function(a){l=a})},_getNewConfig:function(){t._getTemplates(),p={};var b=t.$("[sel-for = onChangePreset]").empty();webApp.DeviceType.indexOf("IPC")>-1?(p[0]="Scene",b.append("<option value = 0>0</option>"),b.val(z).change()):f.PTZ.getPresets().done(function(c){var e=c||[],g={},i=[],j=[];a.each(e,function(a,b){g[b.Index]=b.Name,j.push(b.Index)}),a.each(m[x],function(b,c){b.indexOf("Scene")>-1&&a.inArray(c.PtzPresetId,j)>-1&&("ParkingSpace"==c.Type||c.TypeList&&a.inArray("ParkingSpace",c.TypeList)>-1)&&(i.push(c.PtzPresetId),p[c.PtzPresetId]=b,i=i.sort(d))});for(var k=0;k<i.length;k++)b.append("<option value = "+i[k]+' class = "fn-color-ivsGreen">'+g[i[k]]+"</option>"),b.addClass("fn-color-ivsGreen");i.length<1&&(b.removeClass("fn-color-ivsGreen"),b.append("<option value = -1>"+tl("com.AddPlanFirstTip")+"</option>"),z=-1,s=!0),s?(t.$("#tr_sc_tip").tip("warning",tl("com.AddPlanFirstTip")),h.SetIVSConfig("",0),t._renderElements()):(s=!1,f.ConfigManager.getConfig("PtzMovement").done(function(a){"Preset"==a[x].Function&&(z=a[x].Index+1)}).always(function(){var c=z;a.inArray(z,i)<0&&(c=i[0]),b.val(c).change(),t._renderElements()}))})},onChangePreset:function(){z=t.$("#ipcparkingSpace_presets").val()-0,h.SetIVSConfig("",0),f.PTZ.gotoPreset(z).always(function(){t._renderElements()})},_preHandleGlobal:function(){q=[],r=!1;for(var a=0;a<m.length;a++)for(var b in m[a])if(-1!==b.indexOf("Scene")&&"ParkingSpace"===m[a][b].Type){if(m[a][b].Detail.ParkingSpace){m[a][b].Detail.Type="ParkingSpace";for(var c=0;c<m[a][b].Detail.ParkingSpace.length;c++)q.push(m[a][b].Detail.ParkingSpace[c])}else;r=!0}r?(t.$(".existPreset").removeClass("disabled"),t.$("[data-action='titleAction']").removeClass("disabled"),y&&t.$("#parking_sceneDefault").removeClass("fn-hide")):(q=new Array,w.tip("warning",tl("ivs.SetCarpos")),t.$(".existPreset").addClass("disabled"),t.$("[data-action='titleAction']").addClass("disabled"),y&&t.$("#parking_sceneDefault").addClass("fn-hide")),n[x]||(n[x]=new Array)},_getRefreshData:function(a){f.ConfigManager.getConfig(["VideoAnalyseGlobal","VideoAnalyseRule","VideoAnalyseModule"]).done(function(b){m=b[0].params.table,n=b[1].params.table,o=b[2].params.table,t._preHandleGlobal(),t._getNewConfig(),a&&w.tip("success",tl("com.OperateSuccessTip"))})},_renderElements:function(){var a=[];if(A=null,q){for(var b=jQuery.extend(!0,[],q),c=0;c<b.length;c++){var d={number:"",carLaneName:"",rulesType:"1",area:[],carPosEnable:!0,PtzPresetId:0};if(n)for(var e=0;e<n[x].length;e++)"ParkingSpace"==n[x][e].Class&&n[x][e].Config.LaneNumber==b[c].Number&&(d.carPosEnable=n[x][e].Enable);d.number=b[c].Number,d.carLaneName=b[c].CustomParkNo,d.rulesType="1",d.area=b[c].Area,d.PtzPresetId=b[c].PtzPresetId,b[c].PtzPresetId==t.$("#ipcparkingSpace_presets").val()-0&&a.push(d)}u.table("dataSource",a),0==q.length?t.$("#parking_rules_field").addClass("fn-hide"):t.$("#parking_rules_field").removeClass("fn-hide")}var f=t.$("#parkingSpace_ruleManager tbody tr[data-index='0']");0!=f.length&&f.click(),t._freshDrawCarpos(),t._freshDrawDeteArea()},_onSaveData:function(){var b=u.table("dataSource");if(q)for(var c=0;c<b.length;c++)for(var d=0;d<q.length;d++)q[d].PtzPresetId==b[c].PtzPresetId&&q[d].Number==b[c].number&&(q[d].CustomParkNo=b[c].carLaneName);if(m)for(var e=0;e<m.length;e++)for(var f in m[e])-1!==f.indexOf("Scene")&&"ParkingSpace"===m[e][f].Type&&(0===q.length?m[e][f].Detail.ParkingSpace=new Array:(m[e][f].Detail.ParkingSpace=new Array,a.each(q,function(a,b){b.PtzPresetId==m[e][f].PtzPresetId&&m[e][f].Detail.ParkingSpace.push(b)})));if(n)for(var d=0;d<n[x].length;d++)if("ParkingSpace"==n[x][d].Class){for(var g=~~n[x][d].Config.LaneNumber,c=0;c<b.length;c++)g==b[c].number&&n[x][d].PtzPresetId===b[c].PtzPresetId&&(n[x][d].Enable=b[c].carPosEnable,n[x][d].Name=b[c].carLaneName);a.each(q,function(a,b){b.Number===g&&b.PtzPresetId===n[x][d].PtzPresetId&&(n[x][d].Config.DetectRegion=q[a].Area)})}},onDefault:function(){},onRefresh:function(a){t.$(a.currentTarget).hasClass("disabled")||(t._getRefreshData(!0),t._renderElements())},onConfirm:function(a){if(!t.$(a.currentTarget).hasClass("disabled")){t._onSaveData(),t._saveruleEventhandle();var b=["VideoAnalyseGlobal","VideoAnalyseRule","VideoAnalyseModule"],c=[m,n,o];f.ConfigManager.setConfig(b,c).done(function(){w.tip("success",tl("com.SaveSuccessTip")),t._preHandleGlobal()})}},onSceneDefault:function(){a.when(f.DevVideoInput.getFocusStatus(),f.ConfigManager.getConfig("CalibrateMatrix")).then(function(a,b){var c=a.Focus,d=b[0].pointPairEx[0];f.DevVideoInput.adjustFocus(c,d.masterZoom)})},_setCarDetecAreaValue:function(a){var b=[];if(JSON.decode(a).DetectRegion&&(b=JSON.decode(a).DetectRegion),o)for(var c=0;c<o.length;c++)for(var d=0;d<o[c].length;d++)if(o[c][d]&&"ParkingSpace"==o[c][d].Type&&o[c][d].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0){o[c][d].DetectRegion=b,o[c][d].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0;break}},_drawCarDeteArea:function(){{var a="DetectRegion";t.$("#ipcparkingSpace_presets").val()-0}h.DelDetectRegionShape(),h.AddDetectionRegion(a,0)},_freshDrawDeteArea:function(){for(var a=jQuery.extend(!0,[],o),b={},c=0;c<a.length;c++)for(var d=0;d<a[c].length;d++)if(a[c][d]&&"ParkingSpace"==a[c][d].Type&&a[c][d].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0){b=a[c][d];break}var e={params:{table:[[{DetectRegion:b.DetectRegion,ExcludeRegion:"",PtzPresetId:t.$("#ipcparkingSpace_presets").val()-0}]]}};h.SetIVSConfig(JSON.encode(e),9)},_delCarDeteArea:function(){if(h.DelDetectRegionShape(),o)for(var a=0;a<o[0].length;a++)"ParkingSpace"==o[0][a].Type&&o[0][a].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0&&(o[0][a].DetectRegion=[[0,0],[0,0],[0,0],[0,0]])},_setCarPosValue:function(a){for(var b=JSON.decode(a),c=b[0].config.ParkingSpace[0].CustomParkNo.split("&")[1]-0,d=b[0].config.ParkingSpace[0].Area,e=0;e<q.length;e++)q[e].Number==c&&q[e].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0&&(q[e].Area=d)},_drawCarpos:function(a,b){var c=b+"&"+a;h.DeleteShape(c),h.AddShape(0,"ParkingSpace",c,-1,0)},_freshDrawCarpos:function(){for(var a=[],b=0;b<q.length;b++)q[b].PtzPresetId===t.$("#ipcparkingSpace_presets").val()-0&&a.push(q[b]);var c=jQuery.extend(!0,[],a),d={params:{table:[[{Scene:{Detail:{ParkingSpace:c}}}]]}};h.EnableIVSConfig(!0),h.SetIVSConfig(JSON.encode(d),0)},_delCarpos:function(a,b){var c=b+"&"+a;h.DeleteShape(c)},_showHighlightCurCarpos:function(a,b){var c=b+"&"+a;h.SetCurShape(c)},_editorCurposName:function(a,b,c){var b=b+"&"+a,c=c+"&"+a;h.SetCurNameEx(c,b)}})})}(jQuery);