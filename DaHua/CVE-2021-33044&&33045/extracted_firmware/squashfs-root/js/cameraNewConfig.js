!function(a){define(function(require,b,c){c.exports=require("jsCore/pageTab");var d=require("jsCore/ability"),e=require("jsCore/rpcLogin");c.exports.prototype.camera_focus=function(){return a.when(d.get("VideoInputCapsEx"),d.get("VideoInputCaps")).then(function(b,c){return setTimeout(function(){var d=a('[data-for="camera_focus"][t="itc.ZoomFocus"]'),e="itc.ZoomFocus";b&&b.ABFFunction.Support?e="med.Focus":c&&c.SyncFocus&&(e="itc.Zoom"),d.attr("t",e).parent().translation()},0),(b&&b.ABFFunction.Support||c&&(c.ElectricFocus||c.SyncFocus))&&e.chkAuthority("VideoInputConfig")&&e.chkAuthority("Monitor_01")&&-1===webApp.DeviceType.indexOf("TPC")})},c.exports.prototype.camera_steady=d.get("SteadyLightControl").then(function(a){return!(!a||!a.Support)}),c.exports.prototype.camera_flick=d.get("VideoInputCapsEx").then(function(a){return!!(a&&a.Flicker&&a.Flicker.Support)}),c.exports.prototype.camera_matrixSwitch=d.get("CSCMatrixSwitch").then(function(a){return!(!a||!a.RGBTOYUV)})}),define("camera_attr",function(require,b,c){var d=require("jsCore/rpc"),e=require("jsCore/pageBase"),f=require("jsCore/plugin"),g=require("jsCore/rpcLogin"),h=require("jsCore/ability"),i=require("jsCore/pluginCanvas"),j=require("common/common");require("widget/js/dui.slider"),require("widget/js/dui.iconlist"),require("widget/js/dui.iconSelect");var k=null,l=0,m=null,n=null;c.exports=e.extend({init:function(){k=this,k._initTab(),k.$("[page-btn]").find("a[btn-for]").off("click").on("click",function(b){var c=a(this),d=c.attr("btn-for"),e=c.closest("[page-btn]").attr("page-btn"),f=k.$("[channel-page=camera_attr_"+e+"]").data("tabInstance");return a.isFunction(f[d])?f[d].call(k,b):!1}),isEnable("is_show_FourConfig")?(k.$("#camera_selNor").remove(),k.$("#camera_selMor,#camera_selEve").show()):k.$("#camera_selMor,#camera_selEve").remove()},_initTab:function(){a.each(["thermal","visible"],function(b,c){-1===a.inArray(c,webApp.CHANNEL_TYPE)&&k.$("[channel-page=camera_attr_"+c+"]").remove()}),k.$("[channel-page]:first").addClass("current").show();var b=k.$("#camera_attr_channel");webApp.CHANNEL_NUMBER>1?(b.parent().removeClass("fn-hide"),b.parent().next("div").removeClass("fn-hide"),b.iconSelect({channelNumber:webApp.CHANNEL_NUMBER,allEnable:!1,change:function(a,b){l=b.ch,k.$("[channel-page].current").removeClass("current").hide().data("tabInstance").leave(),k.$("[channel-page=camera_attr_"+webApp.CHANNEL_TYPE[l]+"]").addClass("current"),k.$("[channel-page].current").show().data("tabInstance").render()}}),b.iconSelect("index",l)):(b.parent().next("div").remove(),b.parent().remove()),k.$("[channel-page]").each(function(a,b){var c=k.$(b),d=c.attr("channel-page");require.async(d,function(a){c.data("tabInstance",new a({element:c}))})})},render:function(){f.SetIVSDrawingEnable(!1),k.$("[channel-page].current").data("tabInstance").render()},leave:function(){k.$("[channel-page].current").data("tabInstance").leave()},destory:function(){k.$("[channel-page]").each(function(a,b){k.$(b).data("tabInstance").destory()})}}),define("camera_attr_visible",function(require,b,c){function k(){var b=[],c=arguments[0],e=!0;if(c||(e=!1),"string"==typeof c?b.push(c):b=c,b.indexOf("WDR")>-1){var f=!1;a.each(z.VideoInBacklight[l],function(a,b){return"WideDynamic"===b.Mode||"SSA"===b.Mode?(f=!0,!1):void 0}),e=e&&f}return b.indexOf("Rotate")>-1&&(e=e&&z.VideoImageControl[l].Rotate90),b.indexOf("TVOut")>-1?d.ConfigManager.getConfig("VideoOut").then(function(a){return e&&a[l].Enable}):a.Deferred(function(a){a.resolve(e)})}function o(){var a=r(z).keys;return a.push("VideoInMode"),d.ConfigManager.restoreTemporaryConfig(a)}function p(a,b,c){var e=b.split(".");return"VideoImageControl"===a||"LDCorrection"===a?1===e.length?z[a][l][b]=c:2===e.length?z[a][l][e[0]][e[1]]=c:3===e.length&&(z[a][l][e[0]][e[1]][e[2]]=c):1===e.length?z[a][l][A][b]=c:2===e.length?z[a][l][A][e[0]][e[1]]=c:3===e.length&&(z[a][l][A][e[0]][e[1]][e[2]]=c),d.ConfigManager.setTemporaryConfig(a,z[a])}function q(a,b){var c=b.split(".");if("VideoImageControl"===a||"LDCorrection"===a){if(1===c.length)return z[a][l][b];if(2===c.length)return z[a][l][c[0]][c[1]];if(3===c.length)return z[a][l][c[0]][c[1]][c[2]]}else if(1===c.length){if(z[a][l])return z[a][l][A][b]}else{if(2===c.length)return z[a][l][A][c[0]][c[1]];if(3===c.length)return z[a][l][A][c[0]][c[1]][c[2]]}}function r(b){var c={keys:[],values:[]};return a.isPlainObject(b)?(a.each(b,function(a,d){b.hasOwnProperty(a)&&(c.keys.push(a),c.values.push(d))}),c):c}function s(a,b){if(!z.VideoImageControl||!z.VideoImageControl[l])return a;var c=[],d=[],e=q("VideoImageControl","Flip"),f=q("VideoImageControl","Rotate90"),g=q("VideoImageControl","Mirror");if(1===f?(c[0]=a[1],c[1]=8191-a[0],c[2]=a[3],c[3]=8191-a[2]):2===f?(c[0]=8191-a[1],c[1]=a[0],c[2]=8191-a[3],c[3]=a[2]):b?(c[0]=8191-a[0],c[1]=8191-a[1],c[2]=8191-a[2],c[3]=8191-a[3],e=!1):e?webApp.DeviceType.indexOf("SD")>-1&&-1===webApp.DeviceType.indexOf("TPC")?(c[0]=8191-a[0],c[1]=8191-a[1],c[2]=8191-a[2],c[3]=8191-a[3]):(c[0]=a[0],c[1]=8191-a[1],c[2]=a[2],c[3]=8191-a[3]):(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]),c[0]>c[2]){var h=c[0];c[0]=c[2],c[2]=h}if(c[1]>c[3]){var i=c[1];c[1]=c[3],c[3]=i}return g?(d[0]=8191-c[2],d[1]=c[1],d[2]=8191-c[0],d[3]=c[3],d):c}function t(a,b){if(!z.VideoImageControl||!z.VideoImageControl[l])return a;var c=[],d=[],e=q("VideoImageControl","Flip"),f=q("VideoImageControl","Rotate90"),g=q("VideoImageControl","Mirror");if(1===f?(c[0]=8191-a[1],c[1]=a[0],c[2]=8191-a[3],c[3]=a[2]):2===f?(c[0]=a[1],c[1]=8191-a[0],c[2]=a[3],c[3]=8191-a[2]):b?(c[0]=8191-a[0],c[1]=8191-a[1],c[2]=8191-a[2],c[3]=8191-a[3],e=!1):e?webApp.DeviceType.indexOf("SD")>-1&&-1===webApp.DeviceType.indexOf("TPC")?(c[0]=8191-a[0],c[1]=8191-a[1],c[2]=8191-a[2],c[3]=8191-a[3]):(c[0]=a[0],c[1]=8191-a[1],c[2]=a[2],c[3]=8191-a[3]):(c[0]=a[0],c[1]=a[1],c[2]=a[2],c[3]=a[3]),c[0]>c[2]){var h=c[0];c[0]=c[2],c[2]=h}if(c[1]>c[3]){var i=c[1];c[1]=c[3],c[3]=i}return g?(0===f?(d[0]=8191-c[2],d[1]=c[1],d[2]=8191-c[0],d[3]=c[3]):(d[0]=c[0],d[1]=8191-c[3],d[2]=c[2],d[3]=8191-c[1]),d):c}var u=null,w=require("jsCore/hlsplayer"),x=require("jsCore/flashplayer"),y=require("jsCore/h5player"),z={},A=0,B=null,C=null,D=null,E=null,F=null,G=!1,H=!1,I=!1,J=!1,K=!1,L=!1,M=0,N=!1,O=!1,P=!1,Q=!1;c.exports=e.extend({init:function(){u=this,f.CheckFuncSupport(2).done(function(b){b&&-1===webApp.DeviceType.indexOf("TPC")?a("#c_a_fullscreen").show():a("#c_a_fullscreen").hide()}),a("[btn-for=onFullScreen]").click(function(){u.onFullScreen()}),a.when(h.get("VideoInputCapsEx"),h.is("LDC")).done(function(b,c){if(C=b,m=c,C&&C.LightingControl){if(F=C.LightingControl,F.LinkingDetail&&F.LinkingDetail.FilckerLighting&&F.LinkingDetail.FilckerLighting.Ability){var d=F.LinkingDetail.FilckerLighting.Ability;D=a.inArray("MotionDetect",d.SupportEvents)>-1?!0:!1,E=a.inArray("Normal",d.SupportIntelliScence)>-1?!0:!1}!C.LightingControl.SupportByTime||-1===webApp.DeviceType.indexOf("IPC")&&-1===webApp.DeviceType.indexOf("SD")||(H=!0),2===F.ConfigVersion?(u.$('li[data-for="attr_light"]').remove(),u.$('div[data-page="attr_light"]').remove()):(u.$('li[data-for="attr_light_V2"]').remove(),u.$('div[data-page="attr_light_V2"]').remove())}if(require.async("jsCore/modules/minPtzControl",function(){u._initPtz(),u._initTab(),u.render()}),C&&C.VideoInConflict&&C.VideoInConflict.IsConflict){var e=!1;a.each(C.VideoInConflict.ConflictTable,function(b,c){return 3===c.length&&-1!==a.inArray("TVOut",c)&&-1!==a.inArray("WDR",c)&&-1!==a.inArray("Rotate_90",c)?(e=!0,!1):void 0}),e||(k=function(){return a.Deferred(function(a){return a.resolve(!1)})})}else k=function(){return a.Deferred(function(a){return a.resolve(!1)})}}),-1!==webApp.DeviceType.indexOf("TPC")&&a.when(h.get("LensControl"),h.get("LensControlMix")).done(function(a,b){K=!a,L=!!b}),a.when(h.get("IVSCaps"),h.is("DSPConflict",!0)).then(function(b,c){N=!c&&(webCaps.is_new_IVSUI?!0:webApp.IsIPCIntel)&&b&&-1!==a.inArray("SmokeFire",b.SupportedScene)&&-1===webApp.DeviceType.indexOf("TPC")})},_initPtz:function(){a("#attr_mptz").minPtzControl("init")},_initTab:function(){var b=u.$(".u-tab"),c=u.$(".u-tab-content");C&&C.VideoInWhiteBalance&&C.VideoInWhiteBalance.Support||(b.find("[data-for=attr_whitebalance]").remove(),c.find("[data-page=attr_whitebalance]").remove()),C&&C.VideoInDefog&&C.VideoInDefog.Support||(b.find("[data-for=attr_defog]").remove(),c.find("[data-page=attr_defog]").remove()),m.Support?b.find("[data-for=attr_ldc]").show():(b.find("[data-for=attr_ldc]").remove(),c.find("[data-page=attr_ldc]").remove()),C&&C.VideoInDayNight&&C.VideoInDayNight.Support||(b.find("[data-for=attr_daynight]").remove(),c.find("[data-page=attr_daynight]").remove());var e=C&&C.VideoInZoom&&C.VideoInZoom.Support;if(e=e||C.VideoInFocus&&C.VideoInFocus.Support,e||(b.find("[data-for=attr_zoomfocus]").remove(),c.find("[data-page=attr_zoomfocus]").remove()),C&&C.LightingControl&&C.LightingControl.Support&&-1===webApp.DeviceType.indexOf("TPC")){if(a.inArray("ExclusiveManual",C.LightingControl.Modes)>-1){var f=b.find("[data-for=attr_light]"),g=f.attr("cfg");f.attr("cfg",g+",ExclusiveManualLighting")}}else b.find("[data-for=attr_light]").remove(),c.find("[data-page=attr_light]").remove(),b.find("[data-for=attr_light_V2]").remove(),c.find("[data-page=attr_light_V2]").remove();C&&C.VideoInBacklight&&C.VideoInBacklight.Support||(b.find("[data-for=attr_backlight]").remove(),c.find("[data-page=attr_backlight]").remove());var h=C&&C.VideoInColor&&C.VideoInColor.Support;if(h=h||C.VideoImageControl&&C.VideoImageControl.Support,h=h||C.VideoInSharpness&&C.VideoInSharpness.Support,h||(b.find("[data-for=attr_picture]").remove(),c.find("[data-page=attr_picture]").remove()),C&&C.VideoInSubColor&&C.VideoInSubColor.Adapt.Support){if(b.find("[data-for=attr_picture]")){var i=b.find("[data-for=attr_picture]").attr("cfg");b.find("[data-for=attr_picture]").attr("cfg",i+",VideoSubColor")}}else a("#attr_pic_adaptDiv").remove();var j=C&&C.VideoInExposure&&C.VideoInExposure.Support;j=j||C.VideoInDenoise&&C.VideoInDenoise.Support,j||(b.find("[data-for=attr_exposure]").remove(),c.find("[data-page=attr_exposure]").remove());var k=C&&C.VideoInFishEye,l=k&&"Plugin"===k.Type&&k.MountMode.length<=1;k&&!l?b.find("[data-for=attr_fisheye]").show():(b.find("[data-for=attr_fisheye]").remove(),c.find("[data-page=attr_fisheye]").remove()),C&&C.NotifyScene&&C.NotifyScene.Support?b.find("[data-for=attr_scene]").show():(b.find("[data-for=attr_scene]").remove(),c.find("[data-page=attr_scene]").remove()),b.children("li[data-for]").each(function(b,d){var e=u.$(d),f=e.attr("data-for");require.async(f,function(a){e.data("tabInstance",new a({element:c.find("[data-page="+f+"]")}))});var g=e.attr("cfg");g&&(g=g.split(","),a.each(g,function(a,b){z[b]=null}))}),b.tab({switched:function(a,c){c.from&&(b.children("li[data-for="+c.from+"]").data("tabInstance").leave(),b.children("li[data-for="+c.to+"]").data("tabInstance").render())}}),d.PTZ.getCurrentProtocolCaps().done(function(a){var d=a;d&&d.SupportRestartCam?b.find("[data-for=attr_jxcq]").show():(b.find("[data-for=attr_jxcq]").remove(),c.find("[data-page=attr_jxcq]").remove())})},render:function(){"hls"==webApp.playMode?(a(".ui-video-iconbar-hls").hide(),w&&w.cover(a("#attr_video")),f.hide(),w&&(w.init("","",""),w.beginPlay())):"flash"==webApp.playMode?(a(".ui-video-iconbar-hls").hide(),x&&x.cover(a("#attr_video")),f.hide(),x&&x.playPreview(1,0),d.ConfigManager.getConfig("Encode").done(function(a){webApp.resolution.x=a[0].MainFormat[0].Video.Width,webApp.resolution.y=a[0].MainFormat[0].Video.Height,i.cover("#attr_video",webApp.resolution.x+"*"+webApp.resolution.y)})):"h5"===webApp.playMode?(a(".ui-video-iconbar-hls").hide(),f.hide(),n=new a.Deferred,y.playPreview(1,0,a("#attr_video"),null,n,!0),n.done(function(){})):f.cover("#attr_video",function(b){if(a(".ui-video-iconbar-hls").show(),f.SetRegionNum(0),f.SetModuleMode(1),-1!==webApp.DeviceType.indexOf("TPC")||webApp.CHANNEL_NUMBER>1){var c="Monitor_0"+(l+1);f.SetVisibleVideoWnd(1,l),g.chkAuthority(c)?f.ConnectRealVideoEx(l,l,0):f.SetVideoWndTip(l,tl("noVideoAuthoity"))}else f.open();b&&u.$(".u-tab").children("li.current").data("tabInstance").render()}),a("[page-btn=visible]").removeClass("fn-hide").siblings("[page-btn=thermal]").addClass("fn-hide"),u._getConfig(!1)},_render:function(){0===B[l].Mode?u.$("[sel-for=onSelectConfig]").val(B[l].Config[0]).change():2===B[l].Mode?d.DevVideoInput.getVideoInStatus().done(function(a){var b;b=0===a.ExtSyncPhaseMode?1:0,u.$("[sel-for=onSelectConfig]").val(b).change()}):d.Global.getCurrentTime().done(function(a){var b,c=new Date(a.replace(/-/g,"/")),d=new Date(a.replace(/-/g,"/")),e=new Date(a.replace(/-/g,"/"));if(isEnable("is_show_FourConfig")){var f=global.parsrTimeEx(B[l].TimeSection[0][0]),g=global.parsrTimeEx(B[l].TimeSection[0][1]),h=global.parsrTimeEx(B[l].TimeSection[0][2]),i=global.parsrTimeEx(B[l].TimeSection[0][3]);c=new Date(a.replace(/-/g,"/"));var j=new Date(a.replace(/-/g,"/")),k=new Date(a.replace(/-/g,"/"));d=new Date(a.replace(/-/g,"/")),e=new Date(a.replace(/-/g,"/"));var m=new Date(a.replace(/-/g,"/")),n=new Date(a.replace(/-/g,"/")),o=new Date(a.replace(/-/g,"/")),p=new Date(a.replace(/-/g,"/"));j.setHours(f[1],f[2],f[3]),k.setHours(f[4],f[5],f[6]),d.setHours(g[1],g[2],g[3]),e.setHours(g[4],g[5],g[6]),m.setHours(h[1],h[2],h[3]),n.setHours(h[4],h[5],h[6]),o.setHours(i[1],i[2],i[3]),p.setHours(i[4],i[5],i[6]),c>d&&e>c?b=0:c>o&&p>c?b=1:c>j&&k>c?b=3:c>m&&n>c&&(b=4),void 0===b&&(0>e-d?b=0:0>p-o?b=1:0>k-j?b=3:0>n-m&&(b=4))}else{var q=global.parsrTimeEx(B[l].TimeSection[0][0]);d.setHours(q[1],q[2],q[3]),e.setHours(q[4],q[5],q[6]),b=c>d&&e>c?0:1}u.$("[sel-for=onSelectConfig]").val(b).change()})},leave:function(){f.hide(),w&&w.hideAndStopLoad(),x&&x.hide(),y&&y.hide(),i&&i.hide(),o();var a=u.$(".u-tab").children("li.current").data("tabInstance");a&&a.leave()},destory:function(){l=0,o(),u.$(".u-tab").children().each(function(a,b){u.$(b).data("tabInstance").destory()})},onDefaultV:function(){return d.ConfigManager.restoreTemporaryConfig("VideoInMode"),d.ConfigManager.getConfig("VideoInMode").done(function(b){B=b;var c=r(z).keys;d.ConfigManager.getDefault(c).done(function(b){a.each(b,function(a,b){b.result&&(z[c[a]][l]=b.params.table[l])}),u._render(),d.ConfigManager.setTemporaryConfig(c,r(z).values),a("#attr_tip").tip("success",tl("com.DefaultSuccessTip")),F&&a.inArray("Timing",F.Modes)>-1&&(G=!0)}).fail(function(){a("#attr_tip").tip("error",tl("com.DefaultfailureTip"))})}),!1},onRefreshV:function(){return o().done(function(){u._getConfig(!0),G&&(G=!1)}),!1},onSaveV:function(){if(F&&F.Modes&&!G&&a.inArray("Timing",F.Modes)>-1){var b=u._checkTimeData();if(!b)return void a("#attr_tip").tip("error",tl("com.TimingSameTip"));z.LightingSchedule[l][M]=u._saveTimeData()}if(I&&!u.$("[name=attr_pic_imageSta][off]").prop("checked"))return void a("#attr_tip").tip("warning",tl("ivs.StereoStabilizeConflict"));if(Q)return void a("#attr_tip").tip("warning",tl("ivs.WDFireConflictTip"));if(J&&!u.$("[name=attr_pic_imageSta][off]").prop("checked"))return void a("#attr_tip").tip("warning",tl("com.TVoutStableConflictTip"));G&&(G=!1);var c=r(z);return d.ConfigManager.setConfig(c.keys,c.values).done(function(b){if(j.chkMutilCallRet(b))a("#attr_tip").tip("success",tl("com.SaveSuccessTip"));else{var c="com.SaveConfigFailTip";u.$("#attr_pic_flip").data("notSupport")&&(c="com.CanNotFilp"),(u.$("[btn-for = onSelBLMode]").data("conflict")||u.$("#attr_pic_flip").data("conflict"))&&(c="com.TVOutRotateWDRSSA"),a("#attr_tip").tip("error",tl(c))}}).fail(function(){a("#attr_tip").tip("error",tl("com.SaveConfigFailTip"))}),z.FishEye&&u.$(".u-tab").children("li[data-for= attr_fisheye]").data("tabInstance").save(),!1},_saveTimeData:function(){return u.$("div[id^=light_time_wrap]").each(function(a,b){var c=(new Array(u.$("div[id^=light_time_wrap]").length),u.$(b)),d=c.attr("index")-0;if("none"!==c.css("display")){var e=u.$("#light_time_enable"+d).prop("checked")?"1":"0",f=[];f[0]=u.$("#light_timesec_begin"+d).timefield("value"),f[1]=u.$("#light_timesec_end"+d).timefield("value"),z.LightingSchedule[l][M][d].LightType=u.$("#light_time_mode"+d).val(),z.LightingSchedule[l][M][d].TimeSection=e+" "+f[0]+"-"+f[1]}}),z.LightingSchedule[l][M]},_checkTimeData:function(){var a=[],b=[];u.$("div[id^=light_time_wrap]").each(function(c,d){var e=u.$(d),f=e.attr("index")-0;if("none"!==e.css("display")&&u.$("#light_time_enable"+f).prop("checked")){var g=[];g[0]=u.$("#light_timesec_begin"+f).timefield("value").split(":"),g[1]=u.$("#light_timesec_end"+f).timefield("value").split(":"),g[0]=g[0][0]+g[0][1]+g[0][2],g[1]=g[1][0]+g[1][1]+g[1][2],a.push(g[0]-0),b.push(g[1]-0)}});for(var c=0;c<b.length-1;c++)for(var d=c+1;d<a.length;d++)if(b[c]>a[d]){if(a[c]<a[d])return!1;if(a[c]>a[d]&&b[d]>a[c])return!1}return!0},onFullScreen:function(){return f.SetFullScreen(),!1},onSelectConfig:function(a){return A=u.$(a.target).val()-0,a.isTrigger?u.$(".u-tab").children("li.current").data("tabInstance").render():(B[l].Mode=0,B[l].Config=[A],B[l].TimeSection=B[l].TimeSection,d.ConfigManager.setTemporaryConfig("VideoInMode",B).done(function(){u.$(".u-tab").children("li.current").data("tabInstance").render()})),!1},_getConfig:function(b){d.ConfigManager.getConfig("VideoInMode").done(function(c){B=c;var e=r(z).keys;F&&a.inArray("ZoomPrio",F.Modes)>-1&&F.LightTypeComplex&&e.push("LightingZoomPrio"),F&&a.inArray("Timing",F.Modes)>-1&&e.push("LightingSchedule"),d.ConfigManager.getConfig(e).done(function(b){a.each(b,function(a,b){b.result&&(z[e[a]]=b.params.table)})}).done(function(){u._render(),b&&a("#attr_tip").tip("success",tl("com.OperateSuccessTip"))}).fail(function(){a("#attr_tip").tip("error",tl("com.OperateFailTip"))})})}}),define("attr_picture",function(require,b,c){var g=null,i=!1,j=!1,m=!1,n=!1,o=!1,r=null,s={Standard:"standard",Gentle:"gentle",Flamboyant:"flamboyant"},t=["ObjectDetect","FaceAnalysis","Normal","TrafficPark","IntelliCityMgr"];c.exports=e.extend({init:function(){g=this,g._initSelect(),g._initSlider(),g._initInput(),g.bind()},_initSelect:function(){var b=g.$("#attr_pic_style").empty();C.VideoInColor&&C.VideoInColor.Style&&C.VideoInColor.Style.Support?(a.each(C.VideoInColor.Style.SupportList,function(a,c){b.append("<option value="+c+" t="+s[c]+"></option>")}),b.translation().change(function(a){return p("VideoColor","Style",g.$(a.target).val()),!1})):b.parent().remove();var c=g.$("#attr_pic_flip").empty();if(h.is("RotateConflict").done(function(b){C.VideoImageControl&&(C.VideoImageControl.Flip||C.VideoImageControl.Rotate90)?(C.VideoImageControl.Flip&&C.VideoImageControl.Rotate90?(c.append('<option value="0" t="com.NoFlipEx"></option>'),b||c.append('<option value="1" t="med.Clockwise90Ex"></option>'),c.append('<option value="3" t="med.Flip180Ex"></option>'),b||c.append('<option value="2" t="med.Clockwise90Ex2"></option>')):C.VideoImageControl.Flip?(c.append('<option value="0" t="com.NoFlipEx"></option>'),c.append('<option value="3" t="med.Flip180Ex"></option>')):(c.append('<option value="0" t="com.NoFlipEx"></option>'),b||(c.append('<option value="1" t="med.Clockwise90Ex"></option>'),c.append('<option value="2" t="med.Clockwise90Ex2"></option>'))),c.translation().change(function(b){var d,e,f=g.$(b.target),h=f.val();return"0"===h?(d=!1,e=0):"1"===h?(d=!1,e=1):"3"===h?(d=!0,e=0):"2"===h&&(d=!1,e=2),z.VideoImageControl[l].Flip=d,c.data("notSupport",!1),p("VideoImageControl","Rotate90",e).done(function(){"flash"===webApp.playMode&&x.playPreview(1,0)}).fail(function(){k(["WDR","TVOut"]).done(function(b){c.data("conflict",!1),b&&(a("#attr_tip").tip("warning",tl("com.TVOutRotateWDRSSA")),c.data("conflict",!0))}).always(function(){e&&c.data("notSupport",!0)})}),!1})):c.parent().remove()}),C.VideoImageControl&&C.VideoImageControl.FlipModes&&C.VideoImageControl.FlipModes.length>0){var d=g.$("#attr_flipMode").empty();a.each(C.VideoImageControl.FlipModes,function(a,b){d.append("<option value="+b+" t="+b+"></option>").translation()})}else g.$("#flipExMode_div").hide();C&&C.VideoInSubColor&&C.VideoInSubColor.Adapt.Support&&(i=C.VideoInSubColor.Adapt.Support,C.VideoInSubColor.Adapt.SupportList.forEach(function(b){a("#attr_pic_adapt").append("Network"===b?"<option value='"+b+"' >"+tl("net.Network")+"</option>":"<option value='"+b+"' >"+b+"</option>")}))},bind:function(){a("#attr_flipMode").on("change",function(){var b=a(this).val();z.VideoImageControl[0].FlipMode=b,a("#flipEx_div").css("Manual"===b?{display:"block"}:{display:"none"}),d.ConfigManager.setTemporaryConfig("VideoImageControl",z.VideoImageControl)}),i&&a("#attr_pic_adapt").on("change",function(){var b=a(this).val();z.VideoSubColor[l][A].Adapt=b,d.ConfigManager.setTemporaryConfig("VideoSubColor",z.VideoSubColor)})},_initSlider:function(){C.VideoInColor&&C.VideoInColor.Brightness||g.$("[slider][key=Brightness]").parent().remove(),C.VideoInColor&&C.VideoInColor.Contrast||g.$("[slider][key=Contrast]").parent().remove(),C.VideoInColor&&C.VideoInColor.Saturation||g.$("[slider][key=Saturation]").parent().remove(),C.VideoInColor&&C.VideoInColor.ChromaSuppress||g.$("[slider][key=ChromaSuppress]").parent().remove(),C.VideoInColor&&C.VideoInColor.Gamma||g.$("[slider][key=Gamma]").parent().remove(),C.VideoInSharpness&&C.VideoInSharpness.Support||g.$("[slider][key=Sharpness]").parent().remove(),C.VideoInSharpness&&C.VideoInSharpness.Restrain&&C.VideoInSharpness.Restrain.Support||g.$("[slider][key=Level]").parent().remove(),g.$("[slider][key]").slider({min:0,max:100,complete:function(a,b){var c=g.$(a.target),d=c.attr("cfg"),e=c.attr("key");p(d,e,b.value)}})},_initInput:function(){C.VideoImageControl&&C.VideoImageControl.Mirror||g.$("#attr_pic_mirror_wrap").remove(),C.VideoImageControl&&C.VideoImageControl.Freeze||g.$("#attr_pic_imageFre_wrap").remove(),C.VideoImageControl&&C.VideoImageControl.Stable?(2===C.VideoImageControl.Stable?g.$("#attr_pic_imageStaLable_wrap").text(tl("com.PhotolotyAnti")):1===C.VideoImageControl.Stable&&g.$("#attr_pic_imageStaLable_wrap").text(tl("ivs.ImageStabilization")),h.get("IVSCaps").done(function(b){j=webApp.IsIPCIntel&&b&&(-1!==a.inArray("StereoNumber",b.SupportedScene)||-1!==a.inArray("StereoVision",b.SupportedScene)),m=webApp.IsSDIntel&&b&&b.SupportedScene.length>0}),r=d.DevVideoOutput.getCollect(),a.when(r,h.is("TVOutConflict")).done(function(a,b){!b&&a&&(g.$("#gen_TVShow").show(),o=!0)})):g.$("#attr_pic_imageSta_wrap").remove(),-1===webApp.DeviceType.indexOf("TPC")||K||(g.$("#attr_pic_mirror_wrap").remove(),g.$("#attr_pic_flip").parent().remove()),g.$("input[name^=attr_pic_]").click(function(b){var c=g.$(b.target),d=!c.is("[off]");"attr_pic_imageSta"===c.attr("name")&&(4&C.VideoImageControl.Stable&&f.ControlVideoStable(d),d=d?C.VideoImageControl.Stable:0),p(c.attr("cfg"),c.attr("key"),d).fail(function(){C.VideoInZoom&&C.VideoInZoom.DigitalZoomSupport&&"VideoImageControl"===c.attr("cfg")&&"Stable"===c.attr("key")&&g.$("[name=attr_pic_imageSta]")[0].checked&&(n?a("#attr_tip").tip("warning",tl("ivs.IntellStableConflict")):a("#attr_tip").tip("warning",tl("med.DigitalOrStable")),g.$("[name=attr_pic_imageSta]")[0].checked=!1,g.$("[name=attr_pic_imageSta]")[1].checked=!0,p("VideoImageControl","Stable",0))})})},render:function(){if(g.$("[slider][cfg][key]").each(function(a,b){var c=g.$(b),d=c.attr("cfg"),e=c.attr("key");c.slider("value",q(d,e))}),g.$("#attr_pic_flip,#attr_pic_style").each(function(a,b){var c=g.$(b),d=c.attr("cfg"),e=c.attr("key");if(e)c.val(q(d,e));else{var f=0,h=q(d,"Flip"),i=q(d,"Rotate90");h===!1&&0===i?f=0:h===!1&&1===i?f=1:h===!0&&0===i?f=3:h===!1&&2===i&&(f=2),c.val(f)}}),g.$("[name^=attr_pic_]").each(function(a,b){var c=g.$(b),d=q(c.attr("cfg"),c.attr("key"));"attr_pic_imageSta"===c.attr("name")&&(d=!!d,4&C.VideoImageControl.Stable&&f.ControlVideoStable(d)),c.prop("checked",d!==c.is("[Off]"))}),i){{a("[sel-for='onSelectConfig']").val()-0}a("#attr_pic_adapt").val(q("VideoSubColor","Adapt"))}var b=z.VideoImageControl[0].FlipMode;a("#attr_flipMode").val(b),a("#flipEx_div").css("Auto"===b?{display:"none"}:{display:"block"}),j&&(I=!1,d.ConfigManager.getConfig("VideoAnalyseGlobal").done(function(a){("StereoNumber"===a[l].Scene.Type||"StereoVision"===a[l].Scene.Type)&&(I=!0)})),m&&(n=!1,d.ConfigManager.getConfig("VideoAnalyseGlobal").done(function(b){for(var c in b[l])c.indexOf("Scene")>-1&&a.inArray(b[l][c].Type,t)>-1&&(n=!0)})),o&&(J=!1,d.ConfigManager.getConfig("VideoOut").done(function(b){b&&b[l].Mode&&b[0].Enable&&C&&C.VideoInConflict&&C.VideoInConflict.IsConflict&&a.each(C.VideoInConflict.ConflictTable,function(b,c){-1!==a.inArray("Stabilize",c)&&-1!==a.inArray("TVOut",c)&&(J=!0)})}))}})}),define("attr_exposure",function(require,b,c){function d(a){return(1e3/a).toFixed(2)-0}var f=null,g={Outdoor:0,"50Hz":1,"60Hz":2},h={0:"Outdoor",1:"50Hz",2:"60Hz"},i={Outdoor:"ivs.Outdoor","50Hz":"50Hz","60Hz":"60Hz"},j={Auto:0,Manual:4,Shutter:8,Iris:5,Gain:7,ManualFixed:6},k={0:"Auto",4:"Manual",8:"Shutter",5:"Iris",7:"Gain",6:"ManualFixed"},m={Auto:"com.Auto",Manual:"med.Manual",Shutter:"med.ShutterFirst",Iris:"med.IrisFirst",Gain:"med.GainFirst",ManualFixed:"med.Manual"},n=null,o=null;c.exports=e.extend({init:function(){f=this,n=C.VideoInExposure&&C.VideoInExposure.Speed?C.VideoInExposure.Speed:{Manual:[1e5,3e4,1e4,4e3,2e3,1e3,500,250,120,100,60,50,30,25,15,12,10,8,6,5,4,3,-1],Manual50Hz:[100,50,25,10,5,4],Manual60Hz:[120,60,30,12,6,4],ShutterPAL:[1e5,3e4,1e4,4e3,2e3,500,250,100,50,25,-1],ShutterNTSC:[1e5,3e4,1e4,4e3,2e3,500,250,120,60,30,-1]},webApp.GongAnDetect&&n.Manual.splice(-1,0,1),f._initSelect(),f._initInput(),f._initSlider(),f._backLightExposureCaps()},_initSelect:function(){var b=f.$("[sel-for=onSelSS]").empty(),c="PAL"===webApp.VideoStandard?"Pal":"Ntsc";C.VideoInExposure.SlowSpeed&&C.VideoInExposure.SlowSpeed[c]?a.each(C.VideoInExposure.SlowSpeed[c],function(a,c){b.append("<option value="+c+">1/"+c+"</option>")}):b.parent().remove(),C.VideoInExposure&&C.VideoInExposure.RecoveryTime||f.$("[sel-for=onSelRT]").parent().remove()},onSelSS:function(a){return p("VideoInExposure","SlowSpeed",f.$(a.target).val()-0),!1},onSelRT:function(a){return p("VideoInExposure","RecoveryTime",f.$(a.target).val()-0),!1},onSelFlicker:function(b){var c=f.$(b.target).val(),d=f.$("[sel-for=onSelMode]").val();f.$(b.target).data("isTrigger",!!b.isTrigger||"Manual"!==d&&"Outdoor"===c),z.VideoInExposure[l][A].AntiFlicker=g[c];var e=q("VideoInBacklight","Mode"),h=C.VideoInBacklight&&2===C.VideoInBacklight.WideDynamicRange;h=h&&"WideDynamic"===e;var i=a.grep(C.VideoInExposure.Modes,function(a){return"Outdoor"!==c||h?"Manual"===a||"Auto"===a||"ManualFixed"===a:a});o[e]&&a.each(o[e],function(a,b){a===c&&(i=b)});var j=f.$("[sel-for=onSelMode]").empty(),n=k[q("VideoInExposure","Mode")];return a.each(i,function(a,b){j.append("<option value="+b+" t="+m[b]+"></option>")}),j.translation(),-1!==a.inArray(n,i)&&j.val(n),j.change(),!1},onSelMode:function(b){function c(b){a.each(b,function(a,b){r.append(-1===b?'<option value="Custom" t="pfm.CostomDifsec"></option>':"<option value="+d(b)+">1/"+b+"</option>")}),r.translation().parent().show(),.2899999999999999===s&&(s=t=.29);{var c=f.$("[sel-for=onSelFlicker]").data("isTrigger");f.$("[sel-for=onSelMode]").val()}"boolean"!==a.type(c)||c?s===t&&r.is(":has(option[value="+s+"])")?r.val(s).change():r.is(":has(option[value=Custom])")?r.val("Custom").change():r.change():(f.$("[sel-for=onSelFlicker]").removeData("isTrigger"),a.inArray("10",b)&&"50Hz"===u?r.val(10).change():a.inArray("8.33",b)&&"60Hz"===u?r.val(8.33).change():a.inArray("40",b)&&"Outdoor"===u&&"PAL"===webApp.VideoStandard?r.val(40).change():a.inArray("33.33",b)&&"Outdoor"===u&&"PAL"!==webApp.VideoStandard?r.val(33.33).change():r.change())}var e=f.$(b.target).val();webCaps.is_show_CompensationInHandle||("ManualFixed"===e||"Manual"===e?(f.$("[slider][key=Compensation]").parent().hide(),f.$("[slider][key=SlowAutoExposure]").parent().hide()):(f.$("[slider][key=Compensation]").parent().show(),f.$("[slider][key=SlowAutoExposure]").parent().show()));var g=f.$("#attr_ex_minIris"),i=f.$("#attr_ex_maxIris"),k=f.$("[slider][key=Iris]");"ManualFixed"===e||"Manual"===e||"Iris"===e?C.VideoInExposure&&C.VideoInExposure.SupportIrisRange?(k.parent().hide(),i.numberfield("value",q("VideoInExposure","IrisMax")),g.numberfield("value",q("VideoInExposure","IrisMin")).parent().show()):(k.parent().show(),i.parent().hide()):(k.parent().hide(),i.parent().hide());var m=f.$("#attr_ex_minGain"),o=f.$("#attr_ex_maxGain");"Manual"===e||"Gain"===e?(o.numberfield("value",q("VideoInExposure","GainMax")),m.numberfield("value",q("VideoInExposure","GainMin")).parent().show()):m.parent().hide(),"ManualFixed"===e?f.$("[slider][key=Gain]").parent().show():f.$("[slider][key=Gain]").parent().hide(),"Iris"===e||"Auto"===e||"Shutter"===e?(f.$("[slider][key=GainMax]").slider("value",q("VideoInExposure","GainMax")).parent().show(),z.VideoInExposure[l][A].GainMin=0):f.$("[slider][key=GainMax]").parent().hide();var r=f.$("[sel-for=onSelShutter]").empty(),s=q("VideoInExposure","Value1").toFixed(5),t=q("VideoInExposure","Value2").toFixed(5);if(s=parseFloat(s),t=parseFloat(t),"Manual"===e||"ManualFixed"===e||"Shutter"===e)if(z.VideoInExposure[l][A].Mode=j[e],f.$("#attr_ex_ss_wrap").hide(),f.$("[sel-for=onSelSS]").parent().hide(),"Manual"===e||"ManualFixed"===e){var u=h[q("VideoInExposure","AntiFlicker")];if("Outdoor"===u){var v=C.VideoInBacklight&&2===C.VideoInBacklight.WideDynamicRange;v=v&&"WideDynamic"===q("VideoInBacklight","Mode");var w=a.grep(n.Manual,function(a){return v&&-1!==a?"PAL"===webApp.VideoStandard?a>=25:a>=30:!0});c(w)}else c("50Hz"===u?n.Manual50Hz:n.Manual60Hz)}else c("PAL"===webApp.VideoStandard?n.ShutterPAL:n.ShutterNTSC);else r.parent().hide(),f.$("#attr_ex_minShutter").parent().hide(),f.$("#attr_ex_ss_wrap").show(),f.$("[sel-for=onSelSS]").parent().show(),p("VideoInExposure","Mode",j[e]);return!1},onSelShutter:function(a){var b=f.$(a.target),c=b.val();if("Custom"===c){var d=b.children(":last").prev().val()-0,e=f.$("#attr_ex_minShutter").numberfield("value",0).numberfield("min",0).numberfield("max",d),g=f.$("#attr_ex_maxShutter").numberfield("value",0).numberfield("min",0).numberfield("max",d);a.isTrigger?(e.numberfield("value",q("VideoInExposure","Value1")).parent().show(),g.numberfield("value",q("VideoInExposure","Value2")),p("VideoInExposure","Value1",q("VideoInExposure","Value1"))):(e.numberfield("value",0).parent().show(),g.numberfield("value",q("VideoInExposure","Value2")),p("VideoInExposure","Value1",0)),f.$("#attr_ex_maxShutterTip").text(d)}else f.$("#attr_ex_minShutter").parent().hide(),z.VideoInExposure[l][A].Value1=c-0,p("VideoInExposure","Value2",c-0);return!1},on2DLevel:function(a){var b=f.$(a.target),c=b.attr("cfg"),d=b.attr("key"),e=b.val()-0;p(c,d,e)},on3DLevel:function(a){var b=f.$(a.target),c=b.attr("cfg"),d=b.attr("key"),e=b.val();"custom"==e?(e=2,b.next("[slider]").show().slider("value",2)):(e-=0,b.next("[slider]").hide().slider("value",e)),p(c,d,e)},_initInput:function(){f.$("#attr_ex_minShutter,#attr_ex_maxShutter").numberfield({allowNegative:!1,decimalPrecision:5,error:function(a,b){"range"===b.type&&("attr_ex_minShutter"===b.ui.element.attr("id")?z.VideoInExposure[l][A].Value1=b.ui.value():z.VideoInExposure[l][A].Value2=b.ui.value())}}).blur(function(){var a=f.$("#attr_ex_minShutter").numberfield("value"),b=f.$("#attr_ex_maxShutter").numberfield("value");a>b&&f.$("#attr_ex_maxShutter").numberfield("value",b=a),z.VideoInExposure[l][A].Value1=a,p("VideoInExposure","Value2",b)}),f.$("#attr_ex_minIris,#attr_ex_maxIris").numberfield({min:0,max:100,allowNegative:!1,allowDecimal:!1}).blur(function(){var a=f.$("#attr_ex_minIris").numberfield("value"),b=f.$("#attr_ex_maxIris").numberfield("value");a>b&&f.$("#attr_ex_maxIris").numberfield("value",b=a),z.VideoInExposure[l][A].IrisMin=a,p("VideoInExposure","IrisMax",b)}),f.$("#attr_ex_minGain,#attr_ex_maxGain").numberfield({allowNegative:!1,allowDecimal:!1,min:0,max:100}).blur(function(){var a=f.$("#attr_ex_minGain").numberfield("value"),b=f.$("#attr_ex_maxGain").numberfield("value");
a>b&&f.$("#attr_ex_maxGain").numberfield("value",b=a),z.VideoInExposure[l][A].GainMin=a,p("VideoInExposure","GainMax",b)}),C.VideoInExposure&&C.VideoInExposure.SlowShutter||f.$("#attr_ex_ss_wrap").remove(),webApp.GongAnDetect?f.$("#attr_ex_IR_wrap").removeClass("fn-hide"):C.VideoInIRExposure&&C.VideoInIRExposure.Support||f.$("#attr_ex_IR_wrap").remove(),C.VideoInExposure&&C.VideoInExposure.IrisAuto||f.$("#attr_ex_IA_wrap").remove(),f.$("[name=attr_ex_ss],[name=attr_ex_IR],[name=attr_ex_IA]").click(function(a){var b=f.$(a.target);a.isTrigger||p(b.attr("cfg"),b.attr("key"),!b.is("[off]"))}),C.VideoInDenoise&&C.VideoInDenoise["2D"]&&C.VideoInDenoise["2D"].Support?(-1!==webApp.DeviceType.indexOf("TPC")?(f.$("#attr_ex_2d_wrap .ui-label").text(tl("med.BasicDenoise")),f.$("[sel-for=on2DLevel]").next("div").remove()):f.$("[sel-for=on2DLevel]").remove(),f.$("[name=attr_ex_2d]").click(function(a){var b=f.$(a.target),c=b.is("[off]");c?f.$("[slider][key=2DLevel]").parent().hide():f.$("[slider][key=2DLevel]").parent().show(),a.isTrigger||p(b.attr("cfg"),b.attr("key"),!c)})):f.$("#attr_ex_2d_wrap").remove(),C.VideoInDenoise&&C.VideoInDenoise["3D"]&&C.VideoInDenoise["3D"].Support?(-1!==webApp.DeviceType.indexOf("TPC")?(f.$("#attr_ex_3d_wrap .ui-label").text(tl("med.AdvanceDenoise")),f.$("[sel-for=on3DLevel]").next("[slider]").hide().addClass("fn-padl95 fn-clearonly")):(f.$("[sel-for=on3DLevel]").next("[slider]").show(),f.$("[sel-for=on3DLevel]").remove()),f.$("[name=attr_ex_3d]").click(function(a){var b=f.$(a.target),c=b.attr("mode");a.isTrigger||p(b.attr("cfg"),b.attr("key"),c),"Off"===c?f.$("[slider][key='3DAutoType.AutoLevel']").parent().hide():f.$("[slider][key='3DAutoType.AutoLevel']").parent().show()})):f.$("#attr_ex_3d_wrap").remove(),C.VideoInDenoise&&C.VideoInDenoise.DenoiseAlgorithm1&&C.VideoInDenoise.DenoiseAlgorithm1.Support?f.$("[name=attr_ex_adv]").click(function(a){var b=f.$(a.target),c=b.attr("mode");"Off"===c?f.$("[slider][key^=DenoiseAlgorithm1]").parent().hide():f.$("[slider][key^=DenoiseAlgorithm1]").parent().show(),a.isTrigger||p(b.attr("cfg"),b.attr("key"),c)}):f.$("#attr_ex_adv_wrap").remove()},_initSlider:function(){C.VideoInExposure&&-1!==a.inArray("ManualFixed",C.VideoInExposure.Modes)||f.$("[slider][key=Gain]").parent().remove(),C.VideoInExposure&&C.VideoInExposure.SupportGainUpperLimit||f.$("[slider][key=GainMax]").parent().remove(),C.VideoInExposure&&-1!==a.inArray("Iris",C.VideoInExposure.Modes)||(f.$("[slider][key=Iris]").parent().remove(),f.$("#attr_ex_maxIris").parent().remove()),C.VideoInExposure&&C.VideoInExposure.Compensation||f.$("[slider][key=Compensation]").parent().remove(),C.VideoInExposure&&C.VideoInExposure.SlowAutoExposure||f.$("[slider][key=SlowAutoExposure]").parent().remove(),C.VideoInDenoise&&C.VideoInDenoise["2D"]&&C.VideoInDenoise["2D"].Support||f.$("[slider][key=2DLevel]").parent().remove(),C.VideoInDenoise&&C.VideoInDenoise["3D"]&&C.VideoInDenoise["3D"].Support||f.$('[slider][key="3DAutoType.AutoLevel"]').parent().remove(),C.VideoInDenoise&&C.VideoInDenoise.DenoiseAlgorithm1&&C.VideoInDenoise.DenoiseAlgorithm1.Support||f.$('[slider][key^="DenoiseAlgorithm1"]').parent().remove(),f.$("[slider][cfg][key]").slider({min:0,max:100,complete:function(a,b){var c=f.$(a.target),d=c.attr("cfg"),e=c.attr("key");p(d,e,b.value)}})},_backLightExposureCaps:function(){o={};var b=C.VideoInExposure.HDRSupport;b&&b.Support&&(o.WideDynamic={},a.each(b.AntiFlickersupport,function(a,b){o.WideDynamic[b.AntiFlickerMode]=b.SupportModesList}));var c=C.VideoInExposure.SSASupport;c&&c.Support&&(o.SSA={},a.each(c.AntiFlickersupport,function(a,b){o.SSA[b.AntiFlickerMode]=b.SupportModesList}))},render:function(){-1!==webApp.DeviceType.indexOf("SD")&&-1===webApp.DeviceType.indexOf("TPC")&&f._initSelect();var b=q("VideoInBacklight","Mode"),c=C.VideoInBacklight&&2===C.VideoInBacklight.WideDynamicRange;c=c&&"WideDynamic"===b;var d=f.$("[sel-for=onSelFlicker]").empty();if(C.VideoInExposure.AntiFlicker&&C.VideoInExposure.AntiFlicker.Support){var e=a.grep(C.VideoInExposure.AntiFlicker.SupportList,function(a){return c?"Outdoor"===a:a});o[b]&&(e.empty(),a.each(o[b],function(a){e.push(a)}));var g=h[q("VideoInExposure","AntiFlicker")];a.each(e,function(a,b){d.append("<option value="+b+" t="+i[b]+"></option>")}),d.translation(),d.is(":has(option[value="+g+"])")&&d.val(g),d.change()}else{d.parent().remove();var j=a.grep(C.VideoInExposure.Modes,function(a){return c?"Manual"===a||"Auto"===a||"ManualFixed"===a:a}),l=f.$("[sel-for=onSelMode]").empty(),n=k[q("VideoInExposure","Mode")];a.each(j,function(a,b){l.append("<option value="+b+" t="+m[b]+"></option>")}),l.translation(),l.is(":has(option[value="+n+"])")&&l.val(n),l.change()}if(f.$("[sel-for=onSelSS],[sel-for=onSelRT]").each(function(a,b){var c=f.$(b);c.val(q(c.attr("cfg"),c.attr("key")))}),-1!==webApp.DeviceType.indexOf("TPC")){var p=q("VideoInDenoise","3DAutoType.AutoLevel");f.$("[sel-for=on2DLevel]").val(q("VideoInDenoise","2DLevel")),1==p||50==p||100==p?(f.$("[sel-for=on3DLevel]").val(p),f.$("[sel-for=on3DLevel]").next("[slider]").hide()):(f.$("[sel-for=on3DLevel]").val("custom"),f.$("[sel-for=on3DLevel]").next("[slider]").show())}f.$("[slider][cfg][key]").each(function(a,b){var c=f.$(b);c.slider("value",q(c.attr("cfg"),c.attr("key")))}),f.$('[key=3DType],[key="DenoiseAlgorithm1.Type"]').each(function(a,b){var c=f.$(b),d=c.attr("key");q(c.attr("cfg"),d)===c.attr("mode")&&c.click(),"3DType"===d?f.$('[slider][key="3DAutoType.AutoLevel"]').slider("value",q("VideoInDenoise","3DAutoType.AutoLevel")):(f.$('[key="DenoiseAlgorithm1.TnfLevel"]').slider("value",q("VideoInDenoise","DenoiseAlgorithm1.TnfLevel")),f.$('[key="DenoiseAlgorithm1.SnfLevel"]').slider("value",q("VideoInDenoise","DenoiseAlgorithm1.SnfLevel")))}),f.$("[key=2DEnable],[key=SlowShutter],[key=IrisAuto],[cfg=VideoInIRExposure][key=Enable]").each(function(a,b){var c=f.$(b),d=c.attr("key");q(c.attr("cfg"),d)!==c.is("[off]")&&c.click(),"2DEnable"===d&&f.$("[slider][key=2DLevel]").slider("value",q("VideoInDenoise","2DLevel"))})}})}),define("attr_backlight",function(require,b,c){var g=null,h=!1,j={Off:"com.Off",Backlight:"med.BLC",GlareInhibition:"pfm.GlareInhibition",WideDynamic:"med.WideDynamicRange",SSA:"ivs.SSA"},m={Backlight:"med.DefogOrBLC",GlareInhibition:"med.DefogOrHLC",WideDynamic:"med.DefogOrWDR",SSA:"med.DefogOrSSA"},n={0:"Auto",4:"Manual",8:"Shutter",5:"Iris",7:"Gain",6:"ManualFixed"},o={0:"Outdoor",1:"50Hz",2:"60Hz"},r=!1,u=null;c.exports=e.extend({init:function(){g=this,-1!==a.inArray("Region",C.VideoInBacklight.BacklightMode)?g.$("[name=attr_bl_region]").click(function(a){var b=g.$(a.target).attr("mode");a.isTrigger||p("VideoInBacklight","BacklightMode",b),g._showDrawArea("Region"===b?1:0)}):g.$("#attr_bl_region_wrap").remove(),g.$("[slider][cfg][key]").slider({min:1,max:100,complete:function(a,b){var c=g.$(a.target);p(c.attr("cfg"),c.attr("key"),b.value)}}),g.$("#attr_ex_ExposureMinBLC,#attr_ex_ExposureMaxBLC").numberfield({min:.1,max:40,allowNegative:!1,allowDecimal:!0,decimalPrecision:3}).blur(function(){var a=g.$("#attr_ex_ExposureMinBLC").numberfield("value"),b=g.$("#attr_ex_ExposureMaxBLC").numberfield("value");a>b&&g.$("#attr_ex_ExposureMaxBLC").numberfield("value",b=a),z.VideoInBacklight[l][A].ExposureMinBLC=a,p("VideoInBacklight","ExposureMaxBLC",b)}),g.$("#attr_ex_GainMinBLC,#attr_ex_GainMaxBLC").numberfield({min:0,max:100,allowNegative:!1,allowDecimal:!1}).blur(function(){var a=g.$("#attr_ex_GainMinBLC").numberfield("value"),b=g.$("#attr_ex_GainMaxBLC").numberfield("value");a>b&&g.$("#attr_ex_GainMaxBLC").numberfield("value",b=a),z.VideoInBacklight[l][A].GainMinBLC=a,p("VideoInBacklight","GainMaxBLC",b)}),g._backLightExposureCaps()},_backLightExposureCaps:function(){u={};var b=C.VideoInExposure.HDRSupport;b&&b.Support&&(u.WideDynamic={},a.each(b.AntiFlickersupport,function(a,b){u.WideDynamic[b.AntiFlickerMode]=b.SupportModesList}));var c=C.VideoInExposure.SSASupport;c&&c.Support&&(u.SSA={},a.each(c.AntiFlickersupport,function(a,b){u.SSA[b.AntiFlickerMode]=b.SupportModesList}))},render:function(){f.addEvent("RegionChanged",function(a,b,c,e,f){-1===b&&-1===c&&-1===e&&-1===f||0===b&&0===c&&0===e&&0===f||(r&&d.PTZBase.getFlipStatus().done(function(a){h=a.flip,p("VideoInBacklight","BacklightRegion",s([b,c,e,f],h))}).fail(function(){h=!1,p("VideoInBacklight","BacklightRegion",s([b,c,e,f],h))}),r=!0)}),a.subscribe("RegionChanged",function(a,b){-1===b[0]&&-1===b[1]&&-1===b[2]&&-1===b[3]||0===b[0]&&0===b[1]&&0===b[2]&&0===b[3]||d.PTZBase.getFlipStatus().done(function(a){h=a.flip,p("VideoInBacklight","BacklightRegion",s(b,h))}).fail(function(){h=!1,p("VideoInBacklight","BacklightRegion",s(b,h))})});var b=g.$("[sel-for=onSelBLMode]").empty();if(C.VideoInBacklight.Modes){{var c=C.VideoInBacklight.Modes,e=q("VideoInExposure","AntiFlicker"),k=o[e],m=q("VideoInExposure","Mode"),t=n[m];C.VideoInExposure.HDRSupport}if(2===C.VideoInBacklight.WideDynamicRange)if(u.WideDynamic){var v=u.WideDynamic[k];v&&-1!==v.indexOf(t)||(c=a.grep(c,function(a){return"WideDynamic"!==a}))}else c=a.grep(c,function(a){return 0!==e||7===m||8===m||5===m?"WideDynamic"!==a:!0});if(u.SSA){var w=u.SSA[k];w&&-1!==w.indexOf(t)||(c=a.grep(c,function(a){return"SSA"!==a}))}a.each(c,function(a,c){b.append("<option value="+c+" t="+j[c]+"></option>")}),b.translation().val(q("VideoInBacklight","Mode")).change()}else b.parent().remove();C&&C.VideoInFishEye&&z.FishEye&&("Original"!=z.FishEye[l].CalibrateMode?g.$("input[cfg = VideoInBacklight][mode = Region]").prop("disabled",!0):g.$("input[cfg = VideoInBacklight][mode = Region]").prop("disabled",!1)),"flash"==webApp.playMode&&d.ConfigManager.getConfig(["Encode","VideoImageControl"]).done(function(a){if(webApp.resolution.x=a[0].params.table[0].MainFormat[0].Video.Width,webApp.resolution.y=a[0].params.table[0].MainFormat[0].Video.Height,1==a[1].params.table[0].Rotate90||2==a[1].params.table[0].Rotate90){var b;b=webApp.resolution.x,webApp.resolution.x=webApp.resolution.y,webApp.resolution.y=b}i.cover("#attr_video",webApp.resolution.x+"*"+webApp.resolution.y),g.$("[sel-for=onSelBLMode]").change()}),N&&d.ConfigManager.getConfig(["VideoAnalyseRule","VideoAnalyseGlobal"]).done(function(b){if(O=!1,P=!1,b[0]&&"FireDetection"===b[0].params.table[0][0].Type&&b[0].params.table[0][0].Enable===!0&&(O=!0),b[1]&&b[1].params.table[0].Scene){var c=b[1].params.table[0].Scene;(c.Type&&-1!==c.Type.indexOf("SmokeFire")||c.TypeList&&-1!==c.TypeList.indexOf("SmokeFire"))&&(P=!0)}O&&P&&"WideDynamic"===q("VideoInBacklight","Mode")&&(Q=!0,a("#attr_tip").tip("warning",tl("ivs.WDFireConflictTip")))})},leave:function(){f.addEvent("RegionChanged",null),a.unsubscribe("RegionChanged",null),g._showDrawArea(0)},_showDrawArea:function(a){f.SetRegionNum(a),("flash"==webApp.playMode||"h5"===webApp.playMode)&&i.SetRegionNum(a),a&&(r=!1,d.PTZBase.getFlipStatus().done(function(a){h=a.flip;var b=t(q("VideoInBacklight","BacklightRegion"),h);f.SetSelRegionByIndex(0,b[0],b[1],b[2],b[3]),("flash"==webApp.playMode||"h5"===webApp.playMode)&&i.SetSelRegionByIndex(0,b[0],b[1],b[2],b[3])}).fail(function(){var a=t(q("VideoInBacklight","BacklightRegion"));h=!1,f.SetSelRegionByIndex(0,a[0],a[1],a[2],a[3]),("flash"==webApp.playMode||"h5"===webApp.playMode)&&i.SetSelRegionByIndex(0,a[0],a[1],a[2],a[3])}))},onSelBLMode:function(b){var c=g.$(b.target),d=c.val();return g.$("[slider][key]").parent().hide(),g.$("#attr_bl_region_wrap").hide(),g._showDrawArea(0),g.$("#attr_ex_ExposureMinBLC").parent().hide(),g.$("#attr_ex_GainMaxBLC").parent().hide(),Q=!1,"Backlight"===d?K||g.$("[name=attr_bl_region]").each(function(a,b){var c=g.$(b);q("VideoInBacklight","BacklightMode")===c.attr("mode")&&c.click().parent().parent().show()}):"WideDynamic"===d?(K||g.$("[slider][key=WideDynamicRange]").slider("value",q("VideoInBacklight","WideDynamicRange")).parent().show(),O&&P&&(Q=!0,a("#attr_tip").tip("warning",tl("ivs.WDFireConflictTip")))):"GlareInhibition"===d&&(1===webApp.CamType?g.$("[slider][key=GlareInhibition]").parent().hide():g.$("[slider][key=GlareInhibition]").slider("value",q("VideoInBacklight","GlareInhibition")).parent().show(),"Fpga"===C.VideoInBacklight.GlareInhibition&&(g.$("[slider][key=GlareInSensitivity]").slider("value",q("VideoInBacklight","GlareInSensitivity")).parent().show(),g.$("#attr_ex_ExposureMinBLC").numberfield("value",q("VideoInBacklight","ExposureMinBLC")),g.$("#attr_ex_ExposureMaxBLC").numberfield("value",q("VideoInBacklight","ExposureMaxBLC")).parent().show(),g.$("#attr_ex_GainMinBLC").numberfield("value",q("VideoInBacklight","GainMinBLC")),g.$("#attr_ex_GainMaxBLC").numberfield("value",q("VideoInBacklight","GainMaxBLC")).parent().show())),b.isTrigger||p("VideoInBacklight","Mode",d).fail(function(){m[d]&&C.VideoInDefog&&C.VideoInDefog.Support&&"Off"!==q("VideoInDefog","Mode")&&(c.val("Off").change(),p("VideoInBacklight","Mode","Off"),a("#attr_tip").tip("warning",tl(m[d]))),k(["Rotate","TVOut"]).done(function(b){g.$("[btn-for = onSelBLMode]").data("conflict",!1),b&&(a("#attr_tip").tip("warning",tl("com.TVOutRotateWDRSSA")),g.$("[btn-for = onSelBLMode]").data("conflict",!0))})}),!1}})}),define("attr_whitebalance",function(require,b,c){var g=null,h=!1,j={Disable:"com.Off",Auto:"com.Auto",Custom:"sys.Customed",Sunny:"med.Sunday",Cloudy:"med.Cloudy",Home:"med.AtHome",Office:"pfm.Office",Night:"com.Night",HighColorTemperature:"med.HColorTem",LowColorTemperature:"itc.LColorTem",AutoColorTemperature:"com.NoContactBonudTip",CustomColorTemperature:"med.CusColorTem",Indoor:"indoor",Outdoor:"ivs.Outdoor",ATW:"track",Manual:"med.Manual",ManualDatum:"ivs.ManualDatum",AutoOutdoor:"ivs.OutdoorAutomatic",SodiumAuto:"ivs.SodiumAutomatic",Sodium:"ivs.Sodium",PartWhiteBalance:"med.PartWhiteBalance",Natural:"ivs.NaturalLight",StreetLamp:"ivs.StreetLamp",LinkLight:"ivs.LightLink"};c.exports=e.extend({init:function(){g=this,g.$("#wb_red_slider,#wb_blue_slider").slider({min:0,max:100,complete:function(a,b){var c=g.$(a.target);p(c.attr("cfg"),c.attr("key"),b.value)}});var b=g.$("#attr_wb_mode").empty();a.each(C.VideoInWhiteBalance.Modes,function(a,c){b.append("<option value="+c+" t="+j[c]+"></option>")}),b.translation().change(function(a){var b=g.$(a.target),c=b.val();return g._showDrawArea(0),"Manual"===c?(g.$("#wb_blue_slider").slider("value",q("VideoInWhiteBalance","GainBlue")).parent().show(),g.$("#wb_red_slider").slider("value",q("VideoInWhiteBalance","GainRed")).parent().show(),a.isTrigger||d.DevVideoInput.getVideoInStatus().done(function(a){g.$("#wb_blue_slider").slider("value",a.GainBlue),g.$("#wb_red_slider").slider("value",a.GainRed),z.VideoInWhiteBalance[l][A].GainBlue=a.GainBlue,z.VideoInWhiteBalance[l][A].GainRed=a.GainRed,p("VideoInWhiteBalance","Mode",c)}).fail(function(){p("VideoInWhiteBalance","Mode",c)})):(g.$("#wb_red_slider,#wb_blue_slider").parent().hide(),a.isTrigger||("ManualDatum"===c&&"flash"!==webApp.playMode&&"h5"!==webApp.playMode?z.VideoInWhiteBalance[l][A].Mode=c:p("VideoInWhiteBalance","Mode",c)),"ManualDatum"===c&&g._showDrawArea(1)),!1})},render:function(){f.addEvent("RegionChanged",function(a,b,c,e,f){-1===b&&-1===c&&-1===e&&-1===f||0===b&&0===c&&0===e&&0===f||d.PTZBase.getFlipStatus().done(function(a){h=a.flip,p("VideoInWhiteBalance","ManualDatumRect",s([b,c,e,f],h))}).fail(function(){h=!1,p("VideoInWhiteBalance","ManualDatumRect",s([b,c,e,f],h))})}),a.subscribe("RegionChanged",function(a,b){-1===b[0]&&-1===b[1]&&-1===b[2]&&-1===b[3]||0===b[0]&&0===b[1]&&0===b[2]&&0===b[3]||d.PTZBase.getFlipStatus().done(function(a){h=a.flip,p("VideoInWhiteBalance","ManualDatumRect",s(b,h))}).fail(function(){h=!1,p("VideoInWhiteBalance","ManualDatumRect",s(b,h))})}),"flash"==webApp.playMode&&d.ConfigManager.getConfig(["Encode","VideoImageControl"]).done(function(a){if(webApp.resolution.x=a[0].params.table[0].MainFormat[0].Video.Width,webApp.resolution.y=a[0].params.table[0].MainFormat[0].Video.Height,1==a[1].params.table[0].Rotate90||2==a[1].params.table[0].Rotate90){var b;b=webApp.resolution.x,webApp.resolution.x=webApp.resolution.y,webApp.resolution.y=b}i.cover("#attr_video",webApp.resolution.x+"*"+webApp.resolution.y),g.$("#attr_wb_mode").change()}),g.$("#attr_wb_mode").val(q("VideoInWhiteBalance","Mode")).change(),C&&C.VideoInFishEye&&z.FishEye&&("Original"!=z.FishEye[l].CalibrateMode?g.$("option[value = ManualDatum]").prop("disabled",!0):g.$("option[value = ManualDatum]").prop("disabled",!1))},leave:function(){f.addEvent("RegionChanged",null),a.unsubscribe("RegionChanged",null),g._showDrawArea(0)},_showDrawArea:function(a){f.SetRegionNum(a),("flash"==webApp.playMode||"h5"===webApp.playMode)&&i.SetRegionNum(a),a&&d.PTZBase.getFlipStatus().done(function(a){h=a.flip;var b=t(q("VideoInWhiteBalance","ManualDatumRect"),h);f.SetSelRegionByIndex(0,b[0],b[1],b[2],b[3]),("flash"==webApp.playMode||"h5"===webApp.playMode)&&i.SetSelRegionByIndex(0,b[0],b[1],b[2],b[3])}).fail(function(){var a=t(q("VideoInWhiteBalance","ManualDatumRect"));h=!1,f.SetSelRegionByIndex(0,a[0],a[1],a[2],a[3]),("flash"==webApp.playMode||"h5"===webApp.playMode)&&i.SetSelRegionByIndex(0,a[0],a[1],a[2],a[3])})}})}),define("attr_daynight",function(require,b,c){var f=null,g={Color:"com.Colorful",Brightness:"com.Auto",BlackWhite:"com.BlackWhite",AlarmInput:"per.ExternAlarm",Photoresistor:"med.Photoresistor",Gain:"med.Gain",IO:"com.IO"};c.exports=e.extend({init:function(){if(f=this,C.VideoInDayNight.Type?f.$("[name=attr_dn_type]").click(function(a){p("VideoInDayNight","Type",f.$(a.target).attr("dnType"))}):f.$("#attr_dn_type_wrap").remove(),C.VideoInDayNight.Modes&&C.VideoInDayNight.Modes.length){var b=f.$("#attr_dn_mode").empty();a.each(C.VideoInDayNight.Modes,function(a,c){b.append("<option value="+c+" t="+g[c]+"></option>")}),b.translation()}else f.$("#attr_dn_mode").parent().remove();if(C.VideoInDayNight.DelayRange){for(var c=f.$("#attr_dn_delay").empty(),d=C.VideoInDayNight.DelayRange[0];d<=C.VideoInDayNight.DelayRange[1];d++)c.append("<option value="+d+' t="'+d+'+com.Second"></option>');c.translation()}else f.$("#attr_dn_delay").parent().remove();if(-1!==webApp.DeviceType.indexOf("TPC"))if(C.VideoInDayNight.SensitivityRange){for(var e=f.$("#attr_dn_sen").empty(),h=C.VideoInDayNight.SensitivityRange[0];h<=C.VideoInDayNight.SensitivityRange[1];h++)e.append("<option value="+h+' t="'+h+'"></option>');e.translation()}else f.$("#attr_dn_sen").parent().remove();f.$("#attr_dn_mode").change(function(b){var c=f.$(b.target),d=c.val();return"Brightness"===d?(f.$("#attr_dn_sen").val(q("VideoInDayNight","Sensitivity")).parent().show(),f.$("#attr_dn_delay").val(q("VideoInDayNight","Delay")).parent().show()):f.$("#attr_dn_sen,#attr_dn_delay").parent().hide(),b.isTrigger||p(c.attr("cfg"),c.attr("key"),d).fail(function(){C.VideoInDefog.SupportCamDefog&&"Manul"===q("VideoInDefog","Mode")&&q("VideoInDefog","CamDefogEnable")&&(a("#attr_tip").tip("warning",tl("ivs.DayNightDisabledTip")),c.val("Brightness").change(),p(c.attr("cfg"),c.attr("key"),"Brightness"))}),!1}),f.$("#attr_dn_sen,#attr_dn_delay").change(function(a){var b=f.$(a.target);return p(b.attr("cfg"),b.attr("key"),b.val()-0),!1})},render:function(){f.$("[name=attr_dn_type]").each(function(a,b){var c=f.$(b);c.prop("checked",q("VideoInDayNight","Type")===c.attr("dnType"))}),f.$("#attr_dn_mode").each(function(a,b){f.$(b).val(q("VideoInDayNight","Mode")).change()}),f.disabled("#attr_dn_mode",!1),f.disabled("#attr_dn_sen",!1),f.disabled("#attr_dn_delay",!1),d.ConfigManager.getConfig("VideoInMode").done(function(a){2===a[l].Mode&&(f.disabled("#attr_dn_mode",!0),f.disabled("#attr_dn_sen",!0),f.disabled("#attr_dn_delay",!0))})}})}),define("attr_zoomfocus",function(require,b,c){var f,g=null;c.exports=e.extend({init:function(){g=this,C.VideoInZoom&&C.VideoInZoom.DigitalZoomSupport?g.$("[name=attr_zf_DZ]").click(function(b){var c=g.$(b.target);p("VideoInZoom","DigitalZoom",!c.is("[off]")).fail(function(){var b=q("VideoImageControl","Stable");1===b&&g.$("[name=attr_zf_DZ]")[0].checked&&(a("#attr_tip").tip("warning",tl("med.StableOrDigital")),g.$("[name=attr_zf_DZ]")[0].checked=!1,g.$("[name=attr_zf_DZ]")[1].checked=!0,p("VideoInZoom","DigitalZoom",!1))})}):g.$("#attr_zf_DZ_wrap").remove(),C.VideoInFocus&&-1!==a.inArray("AutoTrace",C.VideoInFocus.Focus)?g.$("[name=attr_zf_AFT]").click(function(a){var b=g.$(a.target);p("VideoInFocus","AutoFocusTrace",b.is("[off]")?0:1)}):g.$("#attr_zf_AFT_wrap").remove(),g.$("[slider][key=Speed]").slider({min:0,max:100,complete:function(a,b){p("VideoInZoom","Speed",b.value)}}),-1===webApp.DeviceType.indexOf("TPC")||K||a("[slider][cfg=VideoInZoom][key=Speed]").parent().remove();var b=g.$("[sel-for=onSelectLimit]").empty();if(C.VideoInFocus&&C.VideoInFocus.FocusLimit){C.VideoInFocus.FocusLimitSelectMode&&-1!==a.inArray("Auto",C.VideoInFocus.FocusLimitSelectMode)&&b.append('<option value="Auto" t="com.Auto"></option>');var c=C.VideoInFocus.FocusLimitRange||[100,1e3,2e3,3e3,5e3];a.each(c,function(a,c){b.append(100===c?"<option value=100>10cm</option>":c%10===1?"<option value="+c+">"+(c-1)/1e3+"m+</option>":"<option value="+c+">"+c/1e3+"m</option>")}),b.translation()}else b.parent().remove();C.VideoInFocus&&C.VideoInFocus.Sensitivity||g.$("#attr_zf_sen").parent().remove(),C.VideoInFocus&&C.VideoInFocus.Modes||g.$("#attr_zf_mode").parent().remove(),h.get("PTZCaps").done(function(a){a&&a.SupportLensInit||g.$("[btn-for=onLensInit]").parent().remove()}),g.$("#attr_zf_mode,#attr_zf_sen").change(function(a){var b=g.$(a.target);return p(b.attr("cfg"),b.attr("key"),b.val()-0),!1}),f=g.$("#auto_celibrate_dialog").dialog({confirm:function(){f.dialog("close")},zIndex:10005}),h.get("AutoFovCalibrate").done(function(a){a&&a.Support&&(g.$("#ptz_auto_celibrate").removeClass("fn-hide"),g.$("#iensInitPlace").removeClass("fn-width90").addClass("fn-width40"))})},onSelectLimit:function(a){var b=g.$(a.target),c=b.val();return"Auto"===c?p("VideoInFocus","FocusLimitSelectMode","Auto"):(z.VideoInFocus[l][A].FocusLimitSelectMode="Manual",p("VideoInFocus","FocusLimit",c-0)),!1},onLensInit:function(){d.PTZ.lensInit()},onAutoCelibrate:function(){function a(a){var b=f.find("#auto_celibrate_dialog_content");switch(a){case"processing":b.text(tl("com.AutoFovCelibrating"));break;case"succeed":b.text(tl("com.AutoFovCelibrateSuccess")),c(),clearInterval(e);break;case"failed":b.text(tl("com.AutoFovCelibrateFail")),c(),clearInterval(e)}}function b(){f.find(".i-close").hide(),f.find(".u-button").addClass("fn-hide"),f.find("#auto_celibrate_dialog_content").text(tl("com.AutoFovCelibrating"))}function c(){f.find(".i-close").show(),f.find(".u-button").removeClass("fn-hide")}var e=null,g=420,h=10;b(),d.PTZBase.autoFovCalibrate().done(function(){f.dialog("show"),e=setInterval(function(){g>0?(d.PTZBase.getFovCalibrateStatus().done(function(b){a(b.Status)}),g-=h):a("AutoFovCelibrate failed")},1e3*h)}).fail(function(){a("AutoFovCelibrate failed")})},render:function(){g.$("[name=attr_zf_DZ]").each(function(a,b){var c=g.$(b);c.prop("checked",q("VideoInZoom","DigitalZoom")!==c.is("[off]"))}),g.$("[name=attr_zf_AFT]").each(function(a,b){var c=g.$(b);c.prop("checked",0===q("VideoInFocus","AutoFocusTrace")===c.is("[off]"))}),g.$("[slider][cfg][key]").each(function(a,b){var c=g.$(b);c.slider("value",q(c.attr("cfg"),c.attr("key")))}),g.$("[sel-for=onSelectLimit]").each(function(a,b){var c=g.$(b);c.val("Auto"===q("VideoInFocus","FocusLimitSelectMode")?"Auto":q("VideoInFocus","FocusLimit"))}),g.$("#attr_zf_mode,#attr_zf_sen").each(function(a,b){var c=g.$(b),d=c.attr("key"),e=c.attr("cfg");c.val(q(e,d))})}})}),define("attr_light",function(require,b,c){var f,g=null,i={Manual:"med.Manual",Auto:"SmartIR",Off:"com.Off",ZoomPrio:"med.ZoomPrio",Timing:"ivs.Timing",Linking:"per.AlarmLink",AdjustBrightness:"med.Manual",ExclusiveManual:"med.Manual"},j={FarLight:[0,0,0,0],NearLight:[0,0,0,0],MiddleLight:[0,0,0,0]},k=0,m=null,n={InfraredLight:"ivs.RedLight",WhiteLight:"ivs.WhiteLight",LaserLight:"ivs.LaserLight"};c.exports=e.extend({init:function(){g=this,H&&(i.Auto="com.Auto");var b=null;if(C.LightingControl.Power){var c=C.LightingControl.Power[1],e=C.LightingControl.Power[0],k=C.LightingControl.Power[2];e&&1&e&&(j.NearLight[0]=1),e&&2&e&&(j.NearLight[1]=1),e&&4&e&&(j.NearLight[2]=1),e&&8&e&&(j.NearLight[3]=1),c&&1&c&&(j.FarLight[0]=1),c&&2&c&&(j.FarLight[1]=1),c&&4&c&&(j.FarLight[2]=1),c&&8&c&&(j.FarLight[3]=1),k&&1&k&&(j.MiddleLight[0]=1),k&&2&k&&(j.MiddleLight[1]=1),k&&4&k&&(j.MiddleLight[2]=1),k&&8&k&&(j.MiddleLight[3]=1)}var o=g.$("#attr_light_mode").empty();if(a.each(F.Modes,function(a,b){o.append("<option value="+b+" t="+i[b]+"></option>")}),o.translation().change(g._modeChange),C.LightingControl.Correction&&C.LightingControl.Correction.Support||g.$("[slider][key=Correction]").parent().remove(),C.LightingControl.NearLightNumber)if(1===C.LightingControl.NearLightNumber?(g.$('[slider][key1=NearLight][index=0][key2="Light"]').prev("label").attr("t","itc.NearLight").parent().translation(),g.$("[slider][key1=NearLight][index=1]").parent().remove(),g.$("[slider][key1=NearLight][index=2]").parent().remove(),g.$("[slider][key1=NearLight][index=3]").parent().remove()):2===C.LightingControl.NearLightNumber?(g.$("[slider][key1=NearLight][index=2]").parent().remove(),g.$("[slider][key1=NearLight][index=3]").parent().remove()):3===C.LightingControl.NearLightNumber&&g.$("[slider][key1=NearLight][index=3]").parent().remove(),C.LightingControl.AngleControl&&C.LightingControl.AngleControl[0]){var p=C.LightingControl.AngleControl[0];1&p||g.$("[slider][key1=NearLight][index=0][key2=Angle]").parent().remove(),2&p||g.$("[slider][key1=NearLight][index=1][key2=Angle]").parent().remove(),4&p||g.$("[slider][key1=NearLight][index=2][key2=Angle]").parent().remove(),8&p||g.$("[slider][key1=NearLight][index=3][key2=Angle]").parent().remove()}else g.$("[slider][key1=NearLight][key2=Angle]").parent().remove();else g.$("[slider][key1=NearLight]").parent().remove();if(C.LightingControl.MiddleLightNumber)if(-1===webApp.DeviceType.indexOf("TPC")&&webApp.DeviceType.indexOf("SD")>-1&&(b=!0,g.$("[slider][key1=MiddleLight][key2=Light]").prev("label").each(function(a,b){var c=g.$(b);c.attr("t","per.MiddleLight"+(a+1)).parent().translation()})),1===C.LightingControl.MiddleLightNumber?(b&&g.$('[slider][key1=MiddleLight][index=0][key2="Light"]').prev("label").attr("t","itc.MiddleLight").parent().translation(),g.$("[slider][key1=MiddleLight][index=1]").parent().remove(),g.$("[slider][key1=MiddleLight][index=2]").parent().remove(),g.$("[slider][key1=MiddleLight][index=3]").parent().remove()):2===C.LightingControl.MiddleLightNumber?(g.$("[slider][key1=MiddleLight][index=2]").parent().remove(),g.$("[slider][key1=MiddleLight][index=3]").parent().remove()):3===C.LightingControl.MiddleLightNumber&&g.$("[slider][key1=MiddleLight][index=3]").parent().remove(),C.LightingControl.AngleControl&&C.LightingControl.AngleControl[2]){var q=C.LightingControl.AngleControl[2];1&q||g.$("[slider][key1=MiddleLight][index=0][key2=Angle]").parent().remove(),2&q||g.$("[slider][key1=MiddleLight][index=1][key2=Angle]").parent().remove(),4&q||g.$("[slider][key1=MiddleLight][index=2][key2=Angle]").parent().remove(),8&q||g.$("[slider][key1=MiddleLight][index=3][key2=Angle]").parent().remove()}else g.$("[slider][key1=MiddleLight][key2=Angle]").parent().remove();else g.$("[slider][key1=MiddleLight]").parent().remove();if(C.LightingControl.FarLightNumber)if(1===C.LightingControl.FarLightNumber?(g.$('[slider][key1=FarLight][index=0][key2="Light"]').prev("label").attr("t","itc.FarLight").parent().translation(),g.$("[slider][key1=FarLight][index=1]").parent().remove(),g.$("[slider][key1=FarLight][index=2]").parent().remove(),g.$("[slider][key1=FarLight][index=3]").parent().remove()):2===C.LightingControl.FarLightNumber?(g.$("[slider][key1=FarLight][index=2]").parent().remove(),g.$("[slider][key1=FarLight][index=3]").parent().remove()):3===C.LightingControl.FarLightNumber&&g.$("[slider][key1=FarLight][index=3]").parent().remove(),C.LightingControl.AngleControl&&C.LightingControl.AngleControl[1]){var r=C.LightingControl.AngleControl[1];1&r||g.$("[slider][key1=FarLight][index=0][key2=Angle]").parent().remove(),2&r||g.$("[slider][key1=FarLight][index=1][key2=Angle]").parent().remove(),4&r||g.$("[slider][key1=FarLight][index=2][key2=Angle]").parent().remove(),8&r||g.$("[slider][key1=FarLight][index=3][key2=Angle]").parent().remove()}else g.$("[slider][key1=FarLight][key2=Angle]").parent().remove();else g.$("[slider][key1=FarLight]").parent().remove();if(a.inArray("ExclusiveManual",F.Modes)>-1){g.$("[slider][cfg][key1][index][key2]").each(function(b,c){a(c).attr("cfg","ExclusiveManualLighting")});var s=g.$("[sel-for = onChangeManualType]");a.each(F.LightTypeComplex,function(a,b){s.append("<option value = "+b+" t="+n[b]+"></option>")}),s.translation();var t=["NearLight","MiddleLight","FarLight"];a.each(t,function(b,c){F[c+"Number"]&&a.each(F.LightTypeComplexDetail[c],function(a,b){g.$("[slider][cfg = ExclusiveManualLighting][key1 = "+c+"][index = "+a+"]").attr("lightType",b)})})}h.get("LightingControl").done(function(a){f=a,a&&"LaserLight"===a.LightType&&(g.$("[key1=NearLight][key2=Angle]").prev().each(function(a,b){var c=parseInt(a+1);a>0?(g.$(b).attr("t",tl("ivs.LaserLightAngle")+c),g.$(b).text(tl("ivs.LaserLightAngle")+c)):(g.$(b).attr("t",tl("ivs.LaserLightAngle")),g.$(b).text(tl("ivs.LaserLightAngle")))}),g.$("[key1=NearLight][key2=Light]").prev().each(function(a,b){var c=parseInt(a+1);a>0?(g.$(b).attr("t",tl("ivs.LaserLightIntensity")+c),g.$(b).text(tl("ivs.LaserLightIntensity")+c)):(g.$(b).attr("t",tl("ivs.LaserLightIntensity")),g.$(b).text(tl("ivs.LaserLightIntensity")))})),webApp.IsSDIntel&&a.SupportLaserLightMove?g.$("#LightWrap").show():g.$("#LightWrap").remove()}),g.$("[slider][cfg=Lighting][key=Correction]").slider({min:0,max:100,complete:function(a,b){z.Lighting[l][A].Correction=b.value,d.ConfigManager.setTemporaryConfig("Lighting",z.Lighting)}}),g.$("[slider][cfg=LightingZoomPrio][key=Correction]").slider({min:0,max:100,complete:function(a,b){z.LightingZoomPrio[l][A].Correction=b.value,d.ConfigManager.setTemporaryConfig("LightingZoomPrio",z.LightingZoomPrio)}}),g.$("[slider][cfg][key1][index][key2]").slider({min:0,max:100,complete:function(a,b){var c=A,e=g.$(a.target),f=e.attr("cfg"),h=e.attr("key1"),i=e.attr("index")-0,k=e.attr("key2"),n=b.value;"Light"===k&&j[h][i]&&(n=g._fixValue(b.value),e.slider("value",n)),"ExclusiveManualLighting"===f&&(c=m),z[f][l][c][h][i][k]=n,d.ConfigManager.setTemporaryConfig(f,z[f])}}),F&&a.inArray("Timing",F.Modes)>-1&&g._initTimeTemplate(),g.$("#attr_light_type").change(function(a){g.$(a.target);return z.LightingZoomPrio[l][A].LightType=g.$("#attr_light_type").val(),d.ConfigManager.setTemporaryConfig("LightingZoomPrio",z.LightingZoomPrio),!1}),g.$("div[id ^=light_timesec_]").change(function(a){var b=g.$(a.target).parent().parent();if(index=b.attr("index")-0,"none"!==b.css("display")){var c=[],d=g.$("#light_timesec_begin"+index).timefield("value");c[0]=g.$("#light_timesec_begin"+index).timefield("value").split(":"),c[1]=g.$("#light_timesec_end"+index).timefield("value").split(":"),c[0]=c[0][0]+c[0][1]+c[0][2],c[1]=c[1][0]+c[1][1]+c[1][2],c[0]>c[1]&&g.$("#light_timesec_end"+index).timefield("value",d)}})},_initTimeTemplate:function(){g.$("[cfg=LightingSchedule]").each(function(b){var c=g.$("#light_time_mode"+b).empty();a.each(F.LightTypeComplex,function(a,b){c.append("<option value="+b+" t="+n[b]+"></option>")}),c.translation()}),g.$("#camera_timing").removeClass("fn-hide");var b=g.$("#camera_timing").find('div[id ^="light_timesec_"]').timefield().show();if(b.find("input").css({"min-width":"16px",width:"16px"}),!(F.LightingTimeSectionNum>=4))for(var c=0;c<4-F.LightingTimeSectionNum;c++){var d=3-c;g.$("#light_time_wrap"+d).addClass("fn-hide")}},_fixValue:function(b){var c=0;return a.each(j.FarLight,function(a,b){b&&(c+=g.$("[slider][cfg][key1=FarLight][index="+a+"][key2=Light]").slider("value"))}),a.each(j.NearLight,function(a,b){b&&(c+=g.$("[slider][cfg][key1=NearLight][index="+a+"][key2=Light]").slider("value"))
}),a.each(j.MiddleLight,function(a,b){b&&(c+=g.$("[slider][cfg][key1=MiddleLight][index="+a+"][key2=Light]").slider("value"))}),c>100?b-(c-100):b},render:function(){m=A,H?A+=1:A=k,g.$("#attr_light_mode").val(z.Lighting[l][A].Mode).change(),f&&f.SupportLaserLightMove&&g.$("li[boatCmd]").mousedown(function(a){var b=g.$(a.target).attr("boatCmd"),c=g.$(a.target);return c.hasClass("mouse-down")?!1:(c.addClass("mouse-down"),void g.adjustLaserAxis(b))}).mouseup(function(a){{var b=g.$(a.target);b.attr("boatCmd")}return b.hasClass("mouse-down")?(b.removeClass("mouse-down"),void d.PtzPeripheral.stopAdjustLaserAxis(l)):!1}).mouseout(function(a){{var b=g.$(a.target);b.attr("boatCmd")}return b.hasClass("mouse-down")?(b.removeClass("mouse-down"),void d.PtzPeripheral.stopAdjustLaserAxis(l)):!1}),webApp.DeviceType.indexOf("SD")>-1&&-1===webApp.DeviceType.indexOf("TPC")&&d.ConfigManager.getConfig("PtzPowerLevel").done(function(b){"Saving"===b[0].Level?a("#light_tip_remark").removeClass("fn-hide"):a("#light_tip_remark").addClass("fn-hide")})},adjustLaserAxis:function(a){var b=(g.$("#light_step").val()-0)/8,c={Up:[0,b],Right:[b,0],Down:[0,-b],Left:[-b,0]};d.PtzPeripheral.adjustLaserAxis(l,c[a])},_modeChange:function(b){var c=g.$(b.target),e=c.val();b.isTrigger||(z.Lighting[l][A].Mode=e,d.ConfigManager.setTemporaryConfig("Lighting",z.Lighting),z.LightingZoomPrio&&d.ConfigManager.setTemporaryConfig("LightingZoomPrio",z.LightingZoomPrio),z.LightingSchedule&&d.ConfigManager.setTemporaryConfig("LightingSchedule",z.LightingSchedule)),g.$("#attr_light_wrap").hide(),"ZoomPrio"===e?(a.inArray("ZoomPrio",F.Modes)>-1&&F.LightTypeComplex?(g.$("#attr_light_type").val(z.LightingZoomPrio[l][A].LightType).parent().show().removeClass("fn-hide"),g.$("[slider][key=Correction][cfg=LightingZoomPrio]").each(function(a,b){g.$(b).slider("value",z.LightingZoomPrio[l][A].Correction).parent().show()}),g.$("[slider][key=Correction][cfg=Lighting]").each(function(a,b){g.$(b).parent().hide()})):(g.$("[slider][key=Correction][cfg=Lighting]").each(function(a,b){g.$(b).slider("value",z.Lighting[l][A].Correction).parent().show()}),g.$("[slider][key=Correction][cfg=LightingZoomPrio]").each(function(a,b){g.$(b).parent().hide()}),g.$("#attr_light_type").parent().hide()),g.$("[slider][key1][index][key2]").parent().hide(),g.$("#camera_timing").hide()):"Manual"===e||"AdjustBrightness"===e?(g.$("[slider][key=Correction]").parent().hide(),g.$("[slider][key1][index][key2]").each(function(a,b){var c=A,d=g.$(b),e=d.attr("cfg"),f=d.attr("key1"),h=d.attr("index")-0,i=d.attr("key2");"ExclusiveManualLighting"===e&&(c=m),d.slider("value",z[e][l][c][f][h][i]).parent().show()}),g.$("#camera_timing").hide(),g.$("#attr_light_type").parent().hide()):"Timing"===e?(g.$("#camera_timing").show(),g.$("[slider]").parent().hide(),g.$("div[id^=light_time_wrap]").each(function(a,b){var c=g.$(b),d=c.attr("index")-0;if("none"!==c.css("display")){z.LightingSchedule[l][A][d].TimeSection.split(" ")[0]-0?g.$("#light_time_enable"+d).prop("checked",!0):g.$("#light_time_enable"+d).prop("checked",!1);var e=[];e[d]=z.LightingSchedule[l][A][d].TimeSection.split(" ")[1].split("-"),g.$("#light_timesec_begin"+d).timefield("value",e[d][0]),g.$("#light_timesec_end"+d).timefield("value",e[d][1]),g.$("#light_time_mode"+d).val(z.LightingSchedule[l][A][d].LightType)}}),g.$("#attr_light_type").parent().hide(),g._renderTip(e)):"Linking"===e?(g.$("[slider]").parent().hide(),g.$("#camera_timing").hide(),g.$("#attr_light_type").parent().hide(),g._renderTip(e)):"ExclusiveManual"===e?(g.$("#camera_timing").hide(),g.$("#attr_light_type").parent().hide(),g.$("#attr_light_wrap").show(),g.$("[sel-for= onChangeManualType]").val(z.ExclusiveManualLighting[l][m].LightType).change()):(g.$("[slider]").parent().hide(),g.$("#camera_timing").hide(),g.$("#attr_light_type").parent().hide())},onChangeManualType:function(b){g.$("[slider]").parent().hide();var c=a(b.target).val();b.isTrigger||(z.ExclusiveManualLighting[l][m].LightType=c,d.ConfigManager.setTemporaryConfig("ExclusiveManualLighting",z.ExclusiveManualLighting)),g.$("[slider][key1][index][key2][lightType = "+c+"]").each(function(a,b){var c=A,d=g.$(b),e=d.attr("cfg"),f=d.attr("key1"),h=d.attr("index")-0,i=d.attr("key2");"ExclusiveManualLighting"===e&&(c=m),d.slider("value",z[e][l][c][f][h][i]).parent().show()})},_renderTip:function(a){switch(a){case"Timing":g.$("#light_mode_tip").tip("warning",tl("com.TimingModeTip"));break;case"Linking":D&&E?g.$("#light_mode_tip").tip("warning",tl("com.AlarmLinkTip")):D&&!E?g.$("#light_mode_tip").tip("warning",tl("com.AlarmVideoLinkTip")):g.$("#light_mode_tip").tip("warning",tl("com.IvsLinkTip"))}},leave:function(){H?A-=1:A=m}})}),define("attr_light_V2",function(require,b,c){var f,g=null,i={Manual:"med.Manual",Auto:"SmartIR",Off:"com.Off",ZoomPrio:"med.ZoomPrio",Timing:"ivs.Timing",Linking:"per.AlarmLink",AdjustBrightness:"med.Manual",ExclusiveManual:"med.Manual"},j={FarLight:[0,0,0,0],NearLight:[0,0,0,0],MiddleLight:[0,0,0,0]},k=0,m={InfraredLight:"ivs.RedLight",WhiteLight:"ivs.WhiteLight",LaserLight:"ivs.LaserLight"};c.exports=e.extend({init:function(){g=this,H&&(i.Auto="com.Auto");if(C.LightingControl.Power){var b=C.LightingControl.Power[1],c=C.LightingControl.Power[0],e=C.LightingControl.Power[2];c&&1&c&&(j.NearLight[0]=1),c&&2&c&&(j.NearLight[1]=1),c&&4&c&&(j.NearLight[2]=1),c&&8&c&&(j.NearLight[3]=1),b&&1&b&&(j.FarLight[0]=1),b&&2&b&&(j.FarLight[1]=1),b&&4&b&&(j.FarLight[2]=1),b&&8&b&&(j.FarLight[3]=1),e&&1&e&&(j.MiddleLight[0]=1),e&&2&e&&(j.MiddleLight[1]=1),e&&4&e&&(j.MiddleLight[2]=1),e&&8&e&&(j.MiddleLight[3]=1)}if(C.LightingControl.Correction&&C.LightingControl.Correction.Support||g.$("[slider][key=Correction]").parent().remove(),C.LightingControl.NearLightNumber)if(1===C.LightingControl.NearLightNumber?(g.$('[slider][key1=NearLight][index=0][key2="Light"]').prev("label").attr("t","itc.NearLight").parent().translation(),g.$("[slider][key1=NearLight][index=1]").parent().remove(),g.$("[slider][key1=NearLight][index=2]").parent().remove(),g.$("[slider][key1=NearLight][index=3]").parent().remove()):2===C.LightingControl.NearLightNumber?(g.$("[slider][key1=NearLight][index=2]").parent().remove(),g.$("[slider][key1=NearLight][index=3]").parent().remove()):3===C.LightingControl.NearLightNumber&&g.$("[slider][key1=NearLight][index=3]").parent().remove(),C.LightingControl.AngleControl&&C.LightingControl.AngleControl[0]){var n=C.LightingControl.AngleControl[0];1&n||g.$("[slider][key1=NearLight][index=0][key2=Angle]").parent().remove(),2&n||g.$("[slider][key1=NearLight][index=1][key2=Angle]").parent().remove(),4&n||g.$("[slider][key1=NearLight][index=2][key2=Angle]").parent().remove(),8&n||g.$("[slider][key1=NearLight][index=3][key2=Angle]").parent().remove()}else g.$("[slider][key1=NearLight][key2=Angle]").parent().remove();else g.$("[slider][key1=NearLight]").parent().remove();if(C.LightingControl.MiddleLightNumber)if(1===C.LightingControl.MiddleLightNumber?(g.$("[slider][key1=MiddleLight][index=1]").parent().remove(),g.$("[slider][key1=MiddleLight][index=2]").parent().remove(),g.$("[slider][key1=MiddleLight][index=3]").parent().remove()):2===C.LightingControl.MiddleLightNumber?(g.$("[slider][key1=MiddleLight][index=2]").parent().remove(),g.$("[slider][key1=MiddleLight][index=3]").parent().remove()):3===C.LightingControl.MiddleLightNumber&&g.$("[slider][key1=MiddleLight][index=3]").parent().remove(),C.LightingControl.AngleControl&&C.LightingControl.AngleControl[2]){var o=C.LightingControl.AngleControl[2];1&o||g.$("[slider][key1=MiddleLight][index=0][key2=Angle]").parent().remove(),2&o||g.$("[slider][key1=MiddleLight][index=1][key2=Angle]").parent().remove(),4&o||g.$("[slider][key1=MiddleLight][index=2][key2=Angle]").parent().remove(),8&o||g.$("[slider][key1=MiddleLight][index=3][key2=Angle]").parent().remove()}else g.$("[slider][key1=MiddleLight][key2=Angle]").parent().remove();else g.$("[slider][key1=MiddleLight]").parent().remove();if(C.LightingControl.FarLightNumber)if(1===C.LightingControl.FarLightNumber?(g.$('[slider][key1=FarLight][index=0][key2="Light"]').prev("label").attr("t","itc.FarLight").parent().translation(),g.$("[slider][key1=FarLight][index=1]").parent().remove(),g.$("[slider][key1=FarLight][index=2]").parent().remove(),g.$("[slider][key1=FarLight][index=3]").parent().remove()):2===C.LightingControl.FarLightNumber?(g.$("[slider][key1=FarLight][index=2]").parent().remove(),g.$("[slider][key1=FarLight][index=3]").parent().remove()):3===C.LightingControl.FarLightNumber&&g.$("[slider][key1=FarLight][index=3]").parent().remove(),C.LightingControl.AngleControl&&C.LightingControl.AngleControl[1]){var p=C.LightingControl.AngleControl[1];1&p||g.$("[slider][key1=FarLight][index=0][key2=Angle]").parent().remove(),2&p||g.$("[slider][key1=FarLight][index=1][key2=Angle]").parent().remove(),4&p||g.$("[slider][key1=FarLight][index=2][key2=Angle]").parent().remove(),8&p||g.$("[slider][key1=FarLight][index=3][key2=Angle]").parent().remove()}else g.$("[slider][key1=FarLight][key2=Angle]").parent().remove();else g.$("[slider][key1=FarLight]").parent().remove();if(F.LightTypeComplex){g.$("[slider][cfg][key1][index][key2]").each(function(b,c){a(c).attr("cfg","Lighting_V2")});var q=["NearLight","MiddleLight","FarLight"];a.each(q,function(b,c){F[c+"Number"]&&a.each(F.LightTypeComplexDetail[c],function(a,b){g.$("[slider][cfg = Lighting_V2][key1 = "+c+"][index = "+a+"]").attr("lightType",b)})})}var r=g.$("[sel-for = onChangeManualType]").empty();if(a.each(F.LightTypeComplex,function(a,b){r.append("<option value = "+b+" t="+m[b]+"></option>")}),r.translation(),1===F.LightTypeComplex.length&&r.parent().hide(),!F.ModeListComplex){var s=g.$("#attr_light_V2_mode").empty();a.each(F.Modes,function(a,b){s.append("<option value="+b+" t="+i[b]+"></option>")}),s.translation().change(g._modeChange)}F&&F.Sensitivity&&F.Sensitivity.Support||g.$("[sel-for=onChangeSensitivity]").parent().remove(),h.get("LightingControl").done(function(a){f=a,a&&"LaserLight"===a.LightType&&(g.$("[key1=NearLight][key2=Angle]").prev().each(function(a,b){var c=parseInt(a+1);a>0?(g.$(b).attr("t",tl("ivs.LaserLightAngle")+c),g.$(b).text(tl("ivs.LaserLightAngle")+c)):(g.$(b).attr("t",tl("ivs.LaserLightAngle")),g.$(b).text(tl("ivs.LaserLightAngle")))}),g.$("[key1=NearLight][key2=Light]").prev().each(function(a,b){var c=parseInt(a+1);a>0?(g.$(b).attr("t",tl("ivs.LaserLightIntensity")+c),g.$(b).text(tl("ivs.LaserLightIntensity")+c)):(g.$(b).attr("t",tl("ivs.LaserLightIntensity")),g.$(b).text(tl("ivs.LaserLightIntensity")))})),webApp.IsSDIntel&&a.SupportLaserLightMove?g.$("#LightWrap").show():g.$("#LightWrap").remove()}),g.$("[slider][cfg=Lighting][key=Correction]").slider({min:0,max:100,complete:function(a,b){z.Lighting_V2[l][A][k].Correction=b.value,d.ConfigManager.setTemporaryConfig("Lighting",z.Lighting)}}),g.$("[slider][cfg=Lighting_V2][key=Correction]").slider({min:0,max:100,complete:function(a,b){z.Lighting_V2[l][A][k].Correction=b.value,d.ConfigManager.setTemporaryConfig("Lighting_V2",z.Lighting_V2)}}),g.$("[slider][cfg][key1][index][key2]").slider({min:0,max:100,complete:function(a,b){var c=g.$(a.target),e=c.attr("cfg"),f=c.attr("key1"),h=c.attr("index")-0,i=c.attr("key2"),m=b.value;"Light"===i&&j[f][h]&&(m=g._fixValue(b.value),c.slider("value",m)),z[e][l][A][k][f][h][i]=m,d.ConfigManager.setTemporaryConfig(e,z[e])}}),F&&a.inArray("Timing",F.Modes)>-1&&g._initTimeTemplate(),g.$("#attr_light_V2_type").change(function(a){g.$(a.target);return z.LightingZoomPrio[l][A].LightType=g.$("#attr_light_V2_type").val(),d.ConfigManager.setTemporaryConfig("LightingZoomPrio",z.LightingZoomPrio),!1}),g.$("div[id ^=light_timesec_]").change(function(a){var b=g.$(a.target).parent().parent();if(index=b.attr("index")-0,"none"!==b.css("display")){var c=[],d=g.$("#light_timesec_begin"+index).timefield("value");c[0]=g.$("#light_timesec_begin"+index).timefield("value").split(":"),c[1]=g.$("#light_timesec_end"+index).timefield("value").split(":"),c[0]=c[0][0]+c[0][1]+c[0][2],c[1]=c[1][0]+c[1][1]+c[1][2],c[0]>c[1]&&g.$("#light_timesec_end"+index).timefield("value",d)}})},_initTimeTemplate:function(){g.$("[cfg=LightingSchedule]").each(function(b){var c=g.$("#light_time_mode"+b).empty();a.each(F.LightTypeComplex,function(a,b){c.append("<option value="+b+" t="+m[b]+"></option>")}),c.translation()}),g.$("#camera_timing").removeClass("fn-hide");var b=g.$("#camera_timing").find('div[id ^="light_timesec_"]').timefield().show();if(b.find("input").css({"min-width":"16px",width:"16px"}),!(F.LightingTimeSectionNum>=4))for(var c=0;c<4-F.LightingTimeSectionNum;c++){var d=3-c;g.$("#light_time_wrap"+d).addClass("fn-hide")}},_fixValue:function(b){var c=0;return a.each(j.FarLight,function(a,b){b&&(c+=g.$("[slider][cfg][key1=FarLight][index="+a+"][key2=Light]").slider("value"))}),a.each(j.NearLight,function(a,b){b&&(c+=g.$("[slider][cfg][key1=NearLight][index="+a+"][key2=Light]").slider("value"))}),a.each(j.MiddleLight,function(a,b){b&&(c+=g.$("[slider][cfg][key1=MiddleLight][index="+a+"][key2=Light]").slider("value"))}),c>100?b-(c-100):b},render:function(){g.$("[sel-for = onChangeManualType]").val(z.Lighting_V2[l][A][k].LightType).change(),g.$("#attr_light_V2_mode").val(z.Lighting_V2[l][A][k].Mode).change(),g.$("[sel-for = onChangeSensitivity]").val(z.Lighting_V2[l][A][k].Sensitive),f&&f.SupportLaserLightMove&&g.$("li[boatCmd]").mousedown(function(a){var b=g.$(a.target).attr("boatCmd"),c=g.$(a.target);return c.hasClass("mouse-down")?!1:(c.addClass("mouse-down"),void g.adjustLaserAxis(b))}).mouseup(function(a){{var b=g.$(a.target);b.attr("boatCmd")}return b.hasClass("mouse-down")?(b.removeClass("mouse-down"),void d.PtzPeripheral.stopAdjustLaserAxis(l)):!1}).mouseout(function(a){{var b=g.$(a.target);b.attr("boatCmd")}return b.hasClass("mouse-down")?(b.removeClass("mouse-down"),void d.PtzPeripheral.stopAdjustLaserAxis(l)):!1})},onChangeManualType:function(b){var c=g.$(b.target),e=c.val();if(F.ModeListComplex){var f=g.$("#attr_light_V2_mode").empty();a.each(F.ModeListComplex[e],function(a,b){f.append("<option value="+b+" t="+i[b]+"></option>")}),f.translation().change(g._modeChange)}g.$("#attr_light_V2_mode").find("option[value=Auto]").attr("t","InfraredLight"===e?i.Auto:"com.Auto").parent().translation(),b.isTrigger||(z.Lighting_V2[l][A].length>0?a.each(z.Lighting_V2[l][A],function(a,b){b.LightType===e&&(k=a)}):k=0,z.Lighting_V2[l][A][k].LightType=e,d.ConfigManager.setTemporaryConfig("Lighting_V2",z.Lighting_V2),g.$("#attr_light_V2_mode").val(z.Lighting_V2[l][A][k].Mode).change(),g.$("[sel-for=onChangeSensitivity]").val(z.Lighting_V2[l][A][k].Sensitive))},_modeChange:function(b){var c=g.$(b.target);v=c.val(),b.isTrigger||(z.Lighting_V2[l][A][k].Mode=v,d.ConfigManager.setTemporaryConfig("Lighting_V2",z.Lighting_V2)),"ZoomPrio"===v?(a.inArray("ZoomPrio",F.Modes)>-1&&F.LightTypeComplex?(g.$("[slider][key=Correction][cfg=Lighting_V2]").each(function(a,b){g.$(b).slider("value",z.Lighting_V2[l][A][k].Correction).parent().show()}),g.$("[slider][key=Correction][cfg=LightingZoomPrio]").each(function(a,b){g.$(b).parent().hide()})):(g.$("[slider][key=Correction][cfg=Lighting_V2]").each(function(a,b){g.$(b).slider("value",z.Lighting_V2[l][A][k].Correction).parent().show()}),g.$("[slider][key=Correction][cfg=LightingZoomPrio]").each(function(a,b){g.$(b).parent().hide()}),g.$("#attr_light_type").parent().hide()),g.$("[slider][key1][index][key2]").parent().hide(),g.$("#camera_timing").hide()):"Manual"===v||"AdjustBrightness"===v?(g.$("[slider][key=Correction]").parent().hide(),g.$("[slider][key1][index][key2]").each(function(a,b){var c=g.$(b),d=c.attr("cfg"),e=c.attr("key1"),f=c.attr("index")-0,h=c.attr("key2");z[d][l][A][k][e]?c.slider("value",z[d][l][A][k][e][f][h]).parent().show():c.parent().hide()}),g.$("#camera_timing").hide(),g.$("#attr_light_type").parent().hide()):"Timing"===v?(g.$("#camera_timing").show(),g.$("[slider]").parent().hide(),g.$("div[id^=light_time_wrap]").each(function(a,b){var c=g.$(b),d=c.attr("index")-0;if("none"!==c.css("display")){z.LightingSchedule[l][A][d].TimeSection.split(" ")[0]-0?g.$("#light_time_enable"+d).prop("checked",!0):g.$("#light_time_enable"+d).prop("checked",!1);var e=[];e[d]=z.LightingSchedule[l][A][d].TimeSection.split(" ")[1].split("-"),g.$("#light_timesec_begin"+d).timefield("value",e[d][0]),g.$("#light_timesec_end"+d).timefield("value",e[d][1]),g.$("#light_time_mode"+d).val(z.LightingSchedule[l][A][d].LightType)}}),g.$("#attr_light_type").parent().hide(),g._renderTip(v)):"Linking"===v?(g.$("[slider]").parent().hide(),g.$("#camera_timing").hide(),g.$("#attr_light_type").parent().hide(),g._renderTip(v)):(g.$("[slider]").parent().hide(),g.$("#camera_timing").hide(),g.$("#attr_light_type").parent().hide()),g.$("[sel-for=onChangeSensitivity]").parent().toggle("Auto"===v||"ZoomPrio"===v)},onChangeSensitivity:function(b){var c=1*a(b.target).val();b.isTrigger||(z.Lighting_V2[l][A][k].Sensitive=c,d.ConfigManager.setTemporaryConfig("Lighting_V2",z.Lighting_V2))}})}),define("attr_defog",function(require,b,c){var d=null,f={Off:"Off",Auto:"Auto",Manual:"Manul"},g={Off:"com.Off",Auto:"com.Auto",Manual:"med.Manual"},h={Backlight:"med.BLCOrDefog",GlareInhibition:"med.HLCOrDefog",WideDynamic:"med.WDROrDefog",SSA:"med.SSAOrDefog"};c.exports=e.extend({init:function(){d=this;var b=d.$("[sel-for=onSelectDefogMode]");C.VideoInDefog.Modes&&C.VideoInDefog.Modes.length>0?(b.empty(),a.each(C.VideoInDefog.Modes,function(a,c){b.append("<option value="+f[c]+" t="+g[c]+"></option>")}),b.translation()):b.parent().remove(),C.VideoInDefog.SupportCamDefog&&(-1===webApp.DeviceType.indexOf("TPC")||K||d.$("#attr_defog_wrap").children().eq(0).attr("t","com.LightDefog").text(tl("com.LightDefog")),d.$("[name=attr_defog_enhance]").change(function(){p("VideoInDefog","CamDefogEnable",d.$("[name=attr_defog_enhance]")[0].checked).fail(function(){var b=q("VideoInDayNight","Mode");"Brightness"!==b&&d.$("[name=attr_defog_enhance]")[0].checked&&(a("#attr_tip").tip("warning",tl("med.DayOrDefogTip")),d.$("[name=attr_defog_enhance]")[0].checked=!1,d.$("[name=attr_defog_enhance]")[1].checked=!0,p("VideoInDefog","CamDefogEnable",!1))})})),C.VideoInDefog.LightIntensity&&C.VideoInDefog.LightIntensity.Support?d.$("#attr_defog_grade").slider({min:0,max:100,complete:function(a,b){p("VideoInDefog","LightIntensityLevel",b.value)}}):(d.$("[sel-for=onSelectLightMode]").parent().remove(),d.$("#attr_defog_grade").parent().remove())},render:function(){var a=d.$("[sel-for=onSelectDefogMode]");a.val(q(a.attr("cfg"),a.attr("key"))).change(),C.VideoInDefog.SupportCamDefog&&(q("VideoInDefog","CamDefogEnable")?(d.$("[name=attr_defog_enhance]")[0].checked=!0,d.$("[name=attr_defog_enhance]")[1].checked=!1):(d.$("[name=attr_defog_enhance]")[0].checked=!1,d.$("[name=attr_defog_enhance]")[1].checked=!0))},onSelectDefogMode:function(b){var c=d.$(b.target),e=c.val();return"Manul"===e?(d.$("[sel-for=onSelectIntensity]").val(q("VideoInDefog","Intensity")).parent().show(),d.$("[sel-for=onSelectLightMode]").val(q("VideoInDefog","LightIntensityMode")).change().parent().show(),C.VideoInDefog.SupportCamDefog&&d.$("#attr_defog_wrap").show()):"Auto"===e&&-1!==webApp.DeviceType.indexOf("TPC")?(!K||L?(d.$("[sel-for=onSelectIntensity]").val(q("VideoInDefog","Intensity")).parent().show(),d.$("[sel-for=onSelectLightMode],#attr_defog_grade").parent().hide()):d.$("[sel-for=onSelectIntensity],[sel-for=onSelectLightMode],#attr_defog_grade").parent().hide(),!K&&C.VideoInDefog.SupportCamDefog?d.$("#attr_defog_wrap").show():d.$("#attr_defog_wrap").hide()):(d.$("[sel-for=onSelectIntensity],[sel-for=onSelectLightMode],#attr_defog_grade").parent().hide(),!K&&C.VideoInDefog.SupportCamDefog&&-1!==webApp.DeviceType.indexOf("TPC")?d.$("#attr_defog_wrap").show():d.$("#attr_defog_wrap").hide()),b.isTrigger||p(c.attr("cfg"),c.attr("key"),e).fail(function(){var b=q("VideoInBacklight","Mode"),e=q("VideoInDayNight","Mode");"Brightness"!==e&&d.$("[name=attr_defog_enhance]")[0].checked&&(a("#attr_tip").tip("warning",tl("med.DayOrDefogTip")),d.$("[name=attr_defog_enhance]")[0].checked=!1,d.$("[name=attr_defog_enhance]")[1].checked=!0,p("VideoInDefog","CamDefogEnable",!1)),h[b]&&(a("#attr_tip").tip("warning",tl(h[b])),c.val("Off").change(),p(c.attr("cfg"),c.attr("key"),"Off"))}),!1},onSelectIntensity:function(a){var b=d.$(a.target);return p(b.attr("cfg"),b.attr("key"),b.val()-0),!1},onSelectLightMode:function(a){var b=d.$(a.target),c=b.val();return"Manul"===c?d.$("#attr_defog_grade").slider("value",q("VideoInDefog","LightIntensityLevel")).parent().show():d.$("#attr_defog_grade").parent().hide(),a.isTrigger||p(b.attr("cfg"),b.attr("key"),c),!1}})}),define("attr_ldc",function(require,a,b){var c=null;b.exports=e.extend({init:function(){c=this,c.$("[name=attr_ldc_Cor]").click(function(a){var b=c.$(a.target),e=b.attr("cfg");a.isTrigger||(z[e][l][b.attr("key")]=!b.is("[off]"),d.ConfigManager.setTemporaryConfig(e,z[e]))}),c._initSlider()},_initSlider:function(){m&&(m.SupportStrength?c.$("[data-for=ldcStrength]").removeClass("fn-hide"):c.$("[data-for=ldcStrength]").remove(),m.SupportHorizontalZoom?c.$("[data-for=horizentalZoom]").removeClass("fn-hide"):c.$("[data-for=horizentalZoom]").remove(),m.SupportVerticalZoom?c.$("[data-for=verticalZoom]").removeClass("fn-hide"):c.$("[data-for=verticalZoom]").remove());var a="";if(m&&m.SupportFarEndZoom){if(m.SupportFarEndZoomLevels){c.$("[data-for=VideoInLevel]").removeClass("fn-hide");for(var b=0;b<=m.SupportFarEndZoomLevels;b++)a+=0===b?'<option value="0">'+b+"</option>":'<option value="'+(1+99*b/m.SupportFarEndZoomLevels)+'">'+b+"</option>";c.$("[sel-for=onChangeLDC]").append(a)}}else c.$("[data-for=VideoInLevel]").remove();c.$("[slider][key]").slider({min:0,max:100,complete:function(a,b){var d=c.$(a.target),e=d.attr("cfg"),f=d.attr("key");p(e,f,b.value)}})},render:function(){c.$("[name=attr_ldc_Cor]").each(function(a,b){var d=c.$(b),e=d.attr("cfg"),f=d.attr("key");z[e][l][f]!==d.is("[off]")&&d.click()}),c.$("[slider][cfg][key]").each(function(a,b){var d=c.$(b),e=d.attr("cfg"),f=d.attr("key");d.slider("value",q(e,f))}),c.$("[key=FarEndZoom]").val(q("LDCorrection","FarEndZoom"))},onChangeLDC:function(a){var b=c.$(a.target);return p(b.attr("cfg"),b.attr("key"),b.val()-0),!1}})}),define("attr_fisheye",function(require,b,c){var f={CeilMode:1,WallMode:2,FloorMode:3},g=null,h=null,i=null;c.exports=e.extend({init:function(){g=this,h=g.$("[sel-for = onChangeFitMode]"),i=g.$("[sel-for = onChangeRecordMode]"),h.empty(),a.each(C.VideoInFishEye.MountMode,function(a,b){h.append("<option value="+f[b]+" t="+b+"></option>")}),h.translation(),"Plugin"===C.VideoInFishEye.Type&&i.parent().hide()},render:function(){var a=z.FishEye[l].PlaceHolder;h.val(a).change()},onChangeFitMode:function(b){var c=a(b.target),d=c.attr("cfg"),e=c.val()-0,g=z[d][l].CalibrateMode;z[d][l].PlaceHolder=e-0,i.empty(),a.each(C.VideoInFishEye.CalibrateMode,function(a,b){"Config"!=b&&(e!=f.WallMode||"DoublePanorama"!=b)&&i.append("<option value="+b+" t="+b+"></option>")}),i.translation(),e==f.WallMode&&"DoublePanorama"==g?(i.find("option:first").prop("selected",!0),i.change()):i.val(z.FishEye[l].CalibrateMode).change()},onChangeRecordMode:function(b){var c=a("#page_cameraNewConfig input[cfg = VideoInBacklight][mode = Region]"),d=a("#page_cameraNewConfig #attr_wb_mode"),e=a(b.target),f=e.attr("cfg");z[f][l].CalibrateMode=e.val(),"Original"!=e.val()?(z.VideoInBacklight&&(a.each(z.VideoInBacklight[l],function(a,b){b.BacklightMode="Default"}),c.prop("disabled",!0)),z.VideoInWhiteBalance&&(a.each(z.VideoInWhiteBalance[l],function(a,b){"ManualDatum"==b.Mode&&(b.Mode="Auto")}),d.find("option[value = ManualDatum]").prop("disabled",!0))):(c.prop("disabled",!1),d.find("option[value = ManualDatum]").prop("disabled",!1))},save:function(){var b=a("#set-menu");"Original"==z.FishEye[l].CalibrateMode?(webApp.hideIVS=!1,b.find("[filename = iExclusionConfig],[filename = ivsConfig],[filename = ipcHeatMapConfig]").show()):(webApp.hideIVS=!0,b.find("[filename = iExclusionConfig],[filename = ivsConfig],[filename = ipcHeatMapConfig]").hide(),d.ConfigManager.getConfig("VideoAnalyseGlobal").done(function(a){a[l]&&a[l].Scene&&(a[l].Scene.Type=null,a[l].Scene.TypeList=null,d.ConfigManager.setConfig("VideoAnalyseGlobal",a))}))}})}),define("attr_scene",function(require,b,c){var d=null,f=null,g={General:"com.General",Traffic:"ivs.Traffic",Face:"ivs.Face"};c.exports=e.extend({init:function(){d=this,f=d.$("[sel-for = onChangeSceneMode]"),C.NotifyScene&&C.NotifyScene.Modes&&(f.empty(),a.each(C.NotifyScene.Modes,function(a,b){f.append("<option value="+b+" t="+g[b]+"></option>")})),f.translation()},render:function(){var a=z.VideoInSceneMode[l][A].SceneMode;f.val(a)},onChangeSceneMode:function(a){var b=d.$(a.target),c=b.val();z.VideoInSceneMode[l][A].SceneMode=c,p("VideoInSceneMode","SceneMode",c)}})}),define("attr_jxcq",function(require,a,b){var c=null;b.exports=e.extend({init:function(){c=this,c.bind()},bind:function(){c.$("#func_cameraRestart").on("click",c._onCameraRestart)},_onCameraRestart:function(){d.PTZ.restartCamera().done(function(){c.$(".sd-tip").tip("success",tl("com.OperateSuccessTip"),3e3)}).fail(function(){c.$(".sd-tip").tip("error",tl("com.OperateFailTip"),3e3)})}})})}),define("camera_attr_thermal",function(require,a,b){var c=null;b.exports=e.extend({init:function(){require.async("jsCore/modules/cameraTPC",function(){c=k.$("#camera_attr_tBox").cameraTPC()})},render:function(){c.cameraTPC("render")},leave:function(){c.cameraTPC("leave")},onSelectScene:function(a){c.cameraTPC("selectScene",k.$(a.target))},onDefaultT:function(){c.cameraTPC("onDefaultT")},onRefreshT:function(){c.cameraTPC("onRefreshT")},onSaveT:function(){c.cameraTPC("onSaveT")},destory:function(){c.cameraTPC("destory")}})})}),define("camera_cfg",function(require,b,c){var d=require("jsCore/rpc"),e=(require("jsCore/rpcLogin"),require("jsCore/pageBase"));require("jsCore/modules/timeDrag"),require("widget/js/dui.iconlist"),require("widget/js/dui.iconSelect");var f=null,g=null,h=0,i=0,j=0,k=0,l=0;c.exports=e.extend({init:function(){f=this,f.$("[name=cfg_mode]").click(function(b){var c=a(b.target),d=c.attr("mode");f.$("[mode-for][mode-for!="+d+"]").hide(),f.$("[mode-for="+d+"]").show()}),isEnable("is_show_FourConfig")?(f.$("#cfg_modeSwi,#cfg_modeNor").hide(),f.$("#cfg_modeTS").show(),f.$("[id^=camera_morning_],[id^=camera_day_],[id^=camera_evening_],[id^=camera_night_]").blur(function(b){var c=a(b.target),d=c.val()-0;c.val(10>d?"0"+(d-0):d)}),f.$("#camera_morning_0,#camera_day_0,#camera_evening_0,#camera_night_0").blur(function(b){a(b.target).val()-0<0?a(b.target).val("00"):a(b.target).val()-0>23&&a(b.target).val("23")}),f.$("#camera_morning_1,#camera_morning_2,#camera_day_1,#camera_day_2,#camera_evening_1,#camera_evening_2,#camera_night_1,#camera_night_2").blur(function(b){a(b.target).val()-0<0?a(b.target).val("00"):a(b.target).val()-0>59&&a(b.target).val("59")})):(f.$("#cfg_modeSwi,#cfg_modeNor").show(),f.$("#cfg_modeTS").hide(),f.$("#cfg_alwaysMor,#cfg_alwaysEve").remove()),d.DevVideoInput.getCapsEx().done(function(a){a&&a.VideoInMode&&a.VideoInMode.SwitchByDayNight&&f.$("#c_c_daynight_option").show()}),f.$("#cfg_timeDrag").timeDrag();var b=a("#camera_cfg_channel");-1!==webApp.DeviceType.indexOf("TPC")?webApp.CHANNEL_NUMBER>1&&(b.parent().removeClass("fn-hide"),b.iconSelect({channelNumber:webApp.CHANNEL_NUMBER,allEnable:!1,change:function(a,b){h=b.ch,setTimeout(function(){f._render()},0)}}),b.iconSelect("index",h)):b.parent().remove(),f.render()},render:function(){f._getConfig(!1)},onRefresh:function(){return f._getConfig(!0),!1},onDefault:function(){return d.ConfigManager.getDefault("VideoInMode").done(function(a){g[h]=a[h],f._render(),f.tip("success","com.DefaultSuccessTip")}).fail(function(){f.tip("error","com.DefaultfailureTip")}),!1},onSave:function(){if(isEnable("is_show_FourConfig")&&f.$("[mode=timeswitch]").prop("checked")&&f._chkTimeOrder())return void f.tip("camera_remark1",tl("med.TimeOrderError"),3e3,2);g[h].Config.length=0;var a=f.$("[name=cfg_mode]:checked").attr("mode");if("fulltime"===a)g[h].Mode=0,g[h].Config[0]=f.$("#cfg_daynight").val()-0,g[h].TimeSection[0][1]="0 00:00:00-23:59:59",isEnable("is_show_FourConfig")&&(g[h].TimeSection[0][1]="0 00:00:00-23:59:59");else if("normal"===a)g[h].Mode=0,g[h].Config[0]=2,g[h].TimeSection[0][1]="0 00:00:00-23:59:59";else if("switch"===a){g[h].Mode=1,g[h].Config.push(0),g[h].Config.push(1);var b=f.$("#cfg_timeDrag").timeDrag("startTime"),c=f.$("#cfg_timeDrag").timeDrag("endTime");if(b===c)return f.tip("warning","com.SunTimeErrorTip");g[h].TimeSection[0][0]="1 "+b+"-"+c,g[h].TimeSection[0][1]="0 00:00:00-00:00:00"}else if("daynight"===a)g[h].Mode=2,g[h].Config.push(0),g[h].Config.push(1);else if("timeswitch"===a){g[h].Mode=1,g[h].Config.push(0),g[h].Config.push(1),g[h].Config.push(3),g[h].Config.push(4);var e=f.$("[id^=camera_morning_]"),m=f.$("[id^=camera_day_]"),n=f.$("[id^=camera_evening_]"),o=f.$("[id^=camera_night_]"),p="",q="",r="",s="",t="",u="",v="",w="";p=e[0].value+":"+e[1].value+":"+e[2].value,r=m[0].value+":"+m[1].value+":"+m[2].value,t=n[0].value+":"+n[1].value+":"+n[2].value,v=o[0].value+":"+o[1].value+":"+o[2].value,0===j?j=86400:0===l?l=86400:0===i?i=86400:0===k&&(k=86400),q=f._formatSecond(j-1),s=f._formatSecond(k-1),u=f._formatSecond(l-1),w=f._formatSecond(i-1),g[h].TimeSection[0][0]="1 "+p+"-"+q,g[h].TimeSection[0][1]="1 "+r+"-"+s,g[h].TimeSection[0][2]="1 "+t+"-"+u,g[h].TimeSection[0][3]="1 "+v+"-"+w}return d.ConfigManager.setConfig("VideoInMode",g).done(function(){f.tip("success","com.SaveSuccessTip")}).fail(function(){f.tip("error","com.SaveConfigFailTip")}),!1},_getConfig:function(a){d.ConfigManager.getConfig("VideoInMode").done(function(b){g=b,f._render(),a&&f.tip("success","com.OperateSuccessTip")}).fail(function(){f.tip("error","com.OperateFailTip")})},_render:function(){if(f.$("#cfg_daynight").val(0),0===g[h].Mode)switch(isEnable("is_show_FourConfig")?f.$("#cfg_alwaysMor,#cfg_alwaysEve").show():f.$("#cfg_alwaysMor,#cfg_alwaysEve").remove(),g[h].Config[0]){case 0:f.$("[mode=fulltime]").prop("checked",!0).click();break;case 1:f.$("[mode=fulltime]").prop("checked",!0).click(),f.$("#cfg_daynight").val(1);break;case 2:f.$("[mode=normal]").prop("checked",!0).click();break;case 3:f.$("[mode=fulltime]").prop("checked",!0).click(),f.$("#cfg_daynight").val(3);break;case 4:f.$("[mode=fulltime]").prop("checked",!0).click(),f.$("#cfg_daynight").val(4)}else if(1===g[h].Mode&&isEnable("is_show_FourConfig"))switch(g[h].Config.length){case 4:f.$("[mode=timeswitch]").prop("checked",!0).click()}else 1===g[h].Mode?f.$("[mode=switch]").prop("checked",!0).click():2===g[h].Mode&&f.$("[mode=daynight]").prop("checked",!0).click();var b=g[h].TimeSection[0][0].split(" ")[1];if(f.$("#cfg_timeDrag").timeDrag("startTime",b.split("-")[0]),f.$("#cfg_timeDrag").timeDrag("endTime",b.split("-")[1]),isEnable("is_show_FourConfig")){var c=b.split("-")[0].split(":");a.each(c,function(a){f.$("#camera_morning_"+a).val(c[a])});var d=g[h].TimeSection[0][1].split(" ")[1].split("-")[0].split(":");a.each(d,function(a){f.$("#camera_day_"+a).val(d[a])});var e=g[h].TimeSection[0][2].split(" ")[1].split("-")[0].split(":");a.each(e,function(a){f.$("#camera_evening_"+a).val(e[a])});var i=g[h].TimeSection[0][3].split(" ")[1].split("-")[0].split(":");a.each(i,function(a){f.$("#camera_night_"+a).val(i[a])})}},_chkTimeOrder:function(){var a=f.$("#camera_morning_0").val()-0,b=f.$("#camera_morning_1").val()-0,c=f.$("#camera_morning_2").val()-0,d=f.$("#camera_day_0").val()-0,e=f.$("#camera_day_1").val()-0,g=f.$("#camera_day_2").val()-0,h=f.$("#camera_evening_0").val()-0,m=f.$("#camera_evening_1").val()-0,n=f.$("#camera_evening_2").val()-0,o=f.$("#camera_night_0").val()-0,p=f.$("#camera_night_1").val()-0,q=f.$("#camera_night_2").val()-0,r=60*(60*a+b)+c;i=r;var s=60*(60*d+e)+g;j=s;var t=60*(60*h+m)+n;k=t;var u=60*(60*o+p)+q;l=u;var v=s>r&&t>s&&u>t,w=t>s&&u>t&&r>u,x=u>t&&r>u&&s>r,y=r>u&&s>r&&t>s;return!(v||w||x||y)},_formatSecond:function(a){var b=parseInt(a),c=0,d=0;
b>60&&(c=parseInt(b/60),b=parseInt(b%60),c>60&&(d=parseInt(c/60),c=parseInt(c%60)));var e="";return c>0&&(1===parseInt(c).length&&(c="0"+parseInt(c)),1===parseInt(b).length&&(b="0"+parseInt(b)),e="00:"+c+":"+b),d>0&&(1===parseInt(d).length&&(d="0"+d),1===parseInt(c).length&&(c="0"+parseInt(c)),1===parseInt(b).length&&(b="0"+parseInt(b)),e=d+":"+c+":"+b),e}})}),define("camera_focus",function(require,b,c){require("jsCore/rpcLogin");require("jsCore/modules/zoomFocus");var d=require("jsCore/pageBase"),e=require("jsCore/hlsplayer"),f=require("jsCore/flashplayer"),g=require("jsCore/h5player"),h=null;c.exports=d.extend({init:function(){h=this,"flash"===webApp.playMode||"h5"===webApp.playMode?h.$("#c_f_zoomfocus").zoomFocus({noPlugin:!0}):h.$("#c_f_zoomfocus").zoomFocus(),h.render()},render:function(){"hls"==webApp.playMode?(e.cover("#c_f_video"),plugin.hide(),e.init("","",""),e.beginPlay()):"flash"==webApp.playMode?(f.cover("#c_f_video"),f.playPreview(1,0)):"h5"==webApp.playMode?g.playPreview(1,0,a("#c_f_video")):plugin.cover("#c_f_video",function(a){plugin.SetRegionNum(0),plugin.SetModuleMode(1),plugin.open(),a&&h.$("#c_f_zoomfocus").zoomFocus("render")}),h.$("#c_f_zoomfocus").zoomFocus("render")},leave:function(){h.$("#c_f_zoomfocus").zoomFocus("leave"),plugin.hide(),e&&e.hideAndStopLoad(),f&&f.hide(),g&&g.hide()}})}),define("camera_steady",function(require,b,c){var d=require("jsCore/rpc"),e=(require("jsCore/rpcLogin"),require("jsCore/pageBase")),f=require("jsCore/modules/timeSection"),g=null,h=0,i=null,j=null,k=null,l=null,m={};c.exports=e.extend({init:function(){g=this,i=g.$("[sel-for=onSteadyMode]"),j=g.$("#camera_steady_timeM"),k=g.$("#camera_steady_holdM"),l=g.$("[cfg=Bright]").numberfield({min:0,max:255,allowDecimal:!1,allowNegative:!1}),g.$("#camera_steady_auto_wrap input[id^=camera_steady_]").click(g.onRadio),i.on("change",g._setModeOptions),g.render()},render:function(){g._getConfig(!1)},onSteadytmSet:function(){return m[h][0]&&m[h][0].Config&&m[h][0].Config.TimeSection&&f.open(m[h][0].Config.TimeSection).done(function(a){m[h][0].Config.TimeSection=a}),!1},onRadio:function(){var a=j.is(":checked"),b=k.is(":checked");a&&(g.$("#camera_steady_bright_wrap").show(),g.disabled("#camera_steady_bright_wrap",!1),g.$("#camera_steady_time_wrap").show(),j.prop("checked",!0),m[h][0].Config.AutoMode="Timing"),b&&(g.$("#camera_steady_bright_wrap").hide(),g.$("#camera_steady_time_wrap").hide(),k.prop("checked",!0),m[h][0].Config.AutoMode="Brightness")},onRefresh:function(){return g._getConfig(!0),!1},onDefault:function(){return d.ConfigManager.getDefault("DHRS").done(function(a){m=a,g._setModeOptions(),g._renderElements(),g.tip("success","com.DefaultSuccessTip")}).fail(function(){g.tip("error","com.DefaultfailureTip")}),!1},onConfirm:function(){return g._saveData(),d.ConfigManager.setConfig("DHRS",m).done(function(){g.tip("success","com.SaveSuccessTip")}).fail(function(){g.tip("error","com.SaveConfigFailTip")}),!1},_getConfig:function(a){d.ConfigManager.getConfig("DHRS").done(function(b){m=b,g._renderElements(),a&&g.tip("success","com.OperateSuccessTip")}).fail(function(){g.tip("error","com.OperateFailTip")})},_renderElements:function(){a.each(m,function(a,b){return b&&b[0]&&"SteadyLight"===b[0].Type?(h=a,!1):void 0}),"Timing"==m[h][0].Config.AutoMode?j.prop("checked",!0):k.prop("checked",!0),i.val(m[h][0].Config.Mode),g._setModeOptions(),g.$("#camera_steady_bright").numberfield("value",m[h][0].Config.Brightness),"Timing"==m[h][0].Config.AutoMode?j.prop("checked",!0):k.prop("checked",!0)},_setModeOptions:function(){"Close"==i.val()?(g.$("#camera_steady_bright_wrap").show(),g.disabled("#camera_steady_bright",!0),g.$("#camera_steady_auto_wrap").hide(),g.$("#camera_steady_time_wrap").hide()):"Open"==i.val()?(g.$("#camera_steady_bright_wrap").show(),g.disabled("#camera_steady_bright",!1),g.$("#camera_steady_auto_wrap").hide(),g.$("#camera_steady_time_wrap").hide()):(g.$("#camera_steady_auto_wrap").show(),j.prop("checked")?(g.$("#camera_steady_bright_wrap").show(),g.disabled("#camera_steady_bright",!1),g.$("#camera_steady_time_wrap").show()):(g.$("#camera_steady_bright_wrap").hide(),g.disabled("#camera_steady_bright",!1),g.$("#camera_steady_time_wrap").hide()))},_saveData:function(){g._setModeOptions(),m[h][0].Config.Mode=i.val(),"Timing"==m[h][0].Config.AutoMode?j.prop("checked",!0):k.prop("checked",!0),m[h][0].Config.Brightness=g.$("#camera_steady_bright").numberfield("value")}})}),define("camera_flick",function(require,b,c){var d=require("jsCore/rpc"),e=require("jsCore/pageBase"),f=require("jsCore/plugin"),g=(require("jsCore/rpcLogin"),require("jsCore/ability"));common=require("common/common"),require("widget/js/dui.slider");var h,i=null,j=0,k=0,l="",m={};c.exports=e.extend({init:function(){i=this,i.$("#flick_nY").numberfield({min:0,max:8191,allowDecimal:!1,allowNegative:!1}).blur(function(){i._pluginChange()}),f.CheckFuncSupport(2).done(function(b){b?a("#c_f_fullscreen").show():a("#c_f_fullscreen").hide()}),i.$("input[mode]").click(i.onRadio),i._initSlider(),i.render()},render:function(){f.cover("#flick_video",function(){f.SetRegionNum(0),f.SetModuleMode(1),f.EnableVideoAnalyseModule(!0),f.open()}),f.addEvent("VideoAnalyzeConfig",function(a){k=JSON.parse(a).EventParam.ShapeID,f.GetVideoAnalyseShapeConfigData(k).done(function(a){a&&(a=JSON.parse(a).Line1[0][1],i.$("#flick_nY").numberfield("value",a))})}),i._getConfig(!1)},_pluginChange:function(){f.DeleteAllVideoAnalyseShape(),h=i.$("#flick_nY").numberfield("value"),l='{"Line1":[[0,'+h+"],[8191,"+h+"]]}",f.CreateMainVideoAnalyseShape(0,"LineShapeEvent","LineShape","Line1",l,"MovedHLine").done(function(){})},_getConfig:function(a){d.ConfigManager.getConfig("VideoInFlicker").done(function(b){m=b,i._render(),a&&i.$("#flicker_tip").tip("success",tl("com.OperateSuccessTip"))}).fail(function(){i.$("#flicker_tip").tip("error",tl("com.OperateFailTip"))})},_render:function(){i.$("[data]").each(function(a,b){var c=i.$(b),d=c.attr("key");c.slider("value",parseInt(m[0][d][a]))}),"Open"==m[0].Mode?i.$("[mode=on]").prop("checked",!0):"Close"==m[0].Mode?i.$("[mode=off]").prop("checked",!0):"Auto"==m[0].Mode&&i.$("[mode=auto]").prop("checked",!0),i.$("#flick_nY").numberfield("value",m[0].YCoordinate[0]),i._pluginChange()},_initSlider:function(){g.get("VideoInputCapsEx").always(function(a){j=a&&a.Flicker&&a.Flicker.MaxAmplitude,i.$("[data]").slider({min:0,max:j||64,complete:function(a,b){var c=i.$(a.target);m[0].Amplitude[parseInt(c.attr("data"))]=b.value}})})},onFullScreen:function(){return f.SetFullScreen(),!1},leave:function(){f.addEvent("VideoAnalyzeConfig",null),f.DeleteAllVideoAnalyseShape(),f.hide()},onRadio:function(){i.$("[mode=on]").prop("checked")?m[0].Mode="Open":i.$("[mode=off]").prop("checked")?m[0].Mode="Close":i.$("[mode=auto]").prop("checked")&&(m[0].Mode="Auto")},onDefault:function(){d.ConfigManager.getDefault("VideoInFlicker").done(function(a){m=a,i._render(),i.$("#flicker_tip").tip("success",tl("com.DefaultSuccessTip"))}).fail(function(){i.$("#flicker_tip").tip("error",tl("com.DefaultfailureTip"))})},onRefresh:function(){i._getConfig(!0)},onSave:function(){m[0].YCoordinate[0]=i.$("#flick_nY").numberfield("value"),m[0].YCoordinate[1]=i.$("#flick_nY").numberfield("value"),d.ConfigManager.setConfig("VideoInFlicker",m).done(function(){i.$("#flicker_tip").tip("success",tl("com.SaveSuccessTip"))}).fail(function(){i.$("#flicker_tip").tip("error",tl("com.SaveConfigFailTip"))})}})}),define("camera_matrixSwitch",function(require,a,b){var c=require("jsCore/rpc"),d=(require("jsCore/rpcLogin"),require("jsCore/pageBase")),e=null,f={};b.exports=d.extend({init:function(){e=this,$matrixSwitch=e.$("[sel-for=onSelMatrixSwitch]"),$matrixSwitch.on("change",e._setMatrixSwitch),e.render()},render:function(){e._getConfig(!1)},onRefresh:function(){return e._getConfig(!0),!1},onDefault:function(){return c.ConfigManager.getDefault("CSCMatrixSwitch").done(function(a){f=a,e._renderElements(),e.tip("success","com.DefaultSuccessTip")}).fail(function(){e.tip("error","com.DefaultfailureTip")}),!1},onConfirm:function(){return e._setMatrixSwitch(),c.ConfigManager.setConfig("CSCMatrixSwitch",f).done(function(){e.tip("success","com.SaveSuccessTip")}).fail(function(){e.tip("error","com.SaveConfigFailTip")}),!1},_getConfig:function(a){c.ConfigManager.getConfig("CSCMatrixSwitch").done(function(b){f=b,e._renderElements(),a&&e.tip("success","com.OperateSuccessTip")}).fail(function(){e.tip("error","com.OperateFailTip")})},_renderElements:function(){"BT601"===f[0].RGBTOYUVMatrix?$matrixSwitch.val("BT601"):"BT709"===f[0].RGBTOYUVMatrix&&$matrixSwitch.val("BT709")},_setMatrixSwitch:function(){"BT601"===$matrixSwitch.val()?f[0].RGBTOYUVMatrix="BT601":"BT709"===$matrixSwitch.val()&&(f[0].RGBTOYUVMatrix="BT709")}})})}(jQuery);