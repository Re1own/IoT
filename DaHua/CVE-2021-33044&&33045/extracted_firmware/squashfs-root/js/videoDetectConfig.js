!function(a){define(function(require,b,c){c.exports=require("jsCore/pageTab");var d=require("jsCore/ability");c.exports.prototype.vid_abnormal=d.get("VideoDetectCaps").then(function(a){return a&&a.SupportMovedDetect}),c.exports.prototype.vid_unFocus=a.when(d.get("VideoDetectCaps")).then(function(a){return-1===webApp.DeviceType.indexOf("TPC")&&webApp.DeviceType.indexOf("SD")>-1&&a&&a.UnFocusDetect}),c.exports.prototype.vid_blind=function(){return d.get("VideoDetectCaps").then(function(b){return b&&b.UnFocusDetect&&-1!==webApp.DeviceType.indexOf("IPC")&&a('[data-for=vid_blind][t="med.VideoShelter"]').attr("t","med.VideoOn").parent().translation(),b&&b.SupportBlind})}}),define("vid_motion",function(require,b,c){function d(a){var b,c,d=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/,e=0,f="";if(/^(rgb|RGB)/.test(a))for(b=a.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),e=b.length-1;e>=0;e--)c=Number(b[e]).toString(16),1===c.length&&(c="0"+c),f+=c;else d.test(a)&&(b=a.replace(/#/,"").split(""),6===b.length&&(f=b[4]+b[5]+b[2]+b[3]+b[0]+b[1]));return 6!==f.length?0:parseInt(f,16)}var e=require("jsCore/rpc"),f=require("jsCore/pageBase"),g=require("jsCore/plugin"),h=require("jsCore/rpcLogin"),i=require("common/common"),j=require("jsCore/modules/timeSection"),k=require("jsCore/flashplayer"),l=require("jsCore/h5player"),m=require("jsCore/pluginCanvas");require("widget/js/dui.slider"),require("widget/js/dui.figure"),require("jsCore/modules/eventHandler"),require("widget/js/dui.iconlist"),require("widget/js/dui.iconSelect");var n,o=null,p=null,q=null,r=0,s=0,t=0,u=!!isEnable("is_has_detectPic"),v=null,w=(a("#pre_playType_select"),null);c.exports=f.extend({init:function(){o=this,s=0;var b=o.$("#vid_motion_channel");webApp.CHANNEL_NUMBER>1?(b.parent().removeClass("fn-hide"),b.parent().next("div").removeClass("fn-hide"),b.iconSelect({channelNumber:webApp.CHANNEL_NUMBER,allEnable:!1,change:function(a,b){t=b.ch,o._renderElements()}}),b.iconSelect("index",t)):(b.parent().next("div").remove(),b.parent().remove()),o.$("#v_m_anti").numberfield({min:0,max:100,allowDecimal:!1,allowNegative:!1}),webApp.EventCaps?e.EventManager.getEventLink("VideoMotion").done(function(b){var c=b.name,d=a.extend({},webApp.DefaultEvent),e=webApp.EventCaps;"default"===c[t][0]?d=e:c[t].each(function(a){d[a]=!0,"AlarmOutEnable"===a?d.AlarmOutLatch=e.AlarmOutLatch:"DejitterEnable"===a?d.DejitterRange=e.DejitterRange:"RecordEnable"===a&&(d.RecordLatch=e.RecordLatch)}),o.$("#v_m_event").eventHandler(d)}).fail(function(){o.$("#v_m_event").eventHandler()}):o.$("#v_m_event").eventHandler(),n=o.$("#v_m_dialog").dialog({confirm:function(a,b){p=q,o._detachData(),"flash"===webApp.playMode&&(k.hide(),m.hide()),"h5"===webApp.playMode&&(l.hide(),m.hide()),b.ui.close()},close:function(){o._detachData(),"flash"===webApp.playMode&&(k.hide(),m.hide()),"h5"===webApp.playMode&&(l.hide(),m.hide())},resize:function(){if("flash"===webApp.playMode||"h5"===webApp.playMode){"h5"===webApp.playMode?l.cover(a("#v_m_detzone")):k.cover("#v_m_detzone");var b=q[t].MotionDetectWindow||[],c=[],e=[],f=new Array(v.MotionRows);if(b.length<v.MotionDetectWindow){a.each(b,function(a,b){void 0===b.Id&&(b.Id=a),void 0===b.Name&&(b.Name="Region "+(b.Id+1)),c.push(b.Id)}),a.each(f,function(a){f[a]=0});for(var h=0;h<v.MotionDetectWindow;h++)-1===a.inArray(h,c)&&b.splice(h,0,{Id:h,Name:"Region "+(h+1),Region:f,Sensitive:isEnable("videodetect_default_sensitive")||58,Threshold:isEnable("videodetect_default_threshold")||4})}a.each(b,function(a,b){var c=d(n.find(".videodetect-regions a").eq(a).css("background-color"));e.push(b.Id+"@"+c+"-"+b.Region.join(":"))});var i=function(){m.cover("#v_m_detzone",webApp.resolution.x+"*"+webApp.resolution.y),m.SetGridNum(v.MotionRows,v.MotionColumns),m.SetFuntionInfo("MotionDetect",e.join(" ")),m.SetCurrentDrawId(s)};"h5"===webApp.playMode?w&&w.done(function(a){webApp.resolution.x=a.width,webApp.resolution.y=a.height,i()}):i()}else g.cover("#v_m_detzone")}}).detach().appendTo(document.body),n.dialog("setPosition",[310,615]),n.find("#v_m_sen").slider({complete:function(a,b){q[t].MotionDetectWindow[s].Sensitive=b.value,o._setTempConfig()}}),n.find("#v_m_thr").slider({change:function(a,b){u&&n.find("#v_m_figure").figure("threshold",b.value)},complete:function(a,b){q[t].MotionDetectWindow[s].Threshold=b.value,o._setTempConfig()}}),u&&n.find("#v_m_figure").figure({width:240,equal:1}).parent().show(),n.find("#v_m_region").textfield({validReg:/[:"'{}\[\]<>\\,]/m,validRegRet:!1,errorHandle:"prevent",success:function(){q&&(q[t].MotionDetectWindow[s].Name=a(this).val())}}),n.find(".videodetect-region-item").on("click",function(){s=a(this).data("index"),p[t].curWinId=s,"flash"===webApp.playMode||"h5"===webApp.playMode?m.SetCurrentDrawId(s):g.SetCurrentDrawId(s);var b=q[t].MotionDetectWindow[s];a(this).addClass("videodetect-region-current").siblings().removeClass("videodetect-region-current"),n.find("#v_m_region").textfield("value",b.Name),n.find("#v_m_sen").slider("value",b.Sensitive),n.find("#v_m_thr").slider("value",b.Threshold)});var c=ability.get("VideoDetectCaps"),f=ability.get("PtzManualMotionDetect");a.when(c,f).done(function(a,b){v=a?a:{DetectVersion:["V1.0","V3.0"],MotionColumns:22,MotionDetectWindow:4,MotionRows:18},-1===webApp.DeviceType.indexOf("TPC")&&b===!0&&(v.PtzManual=!0,o.$("label[for=v_m_ptz]").parent().show()),o.render()})},initLinking:function(b){var c={InfraredLight:"ivs.RedLight",WhiteLight:"ivs.WhiteLight",LaserLight:"ivs.LaserLight"},d=b.LinkingDetail.FilckerLighting;o.$("#v_light_duration").numberfield({min:.1*d.FilckerIntevalTime[0],max:.1*d.FilckerIntevalTime[1],allowDecimal:!0,allowNegative:!1}),o.$("#v_light_duration").next("span").next("span").text("("+.1*d.FilckerIntevalTime[0]+"~"+.1*d.FilckerIntevalTime[1]+")"),o.$("#v_light_num").numberfield({min:d.FilckerTimes[0],max:d.FilckerTimes[1],allowDecimal:!1,allowNegative:!1}),o.$("#v_light_num").next("span").next("span").text("("+d.FilckerTimes[0]+"~"+d.FilckerTimes[1]+")");var e=o.$("#v_light_type").empty();a.each(d.LightType,function(a,b){e.append("<option value="+b+" t="+c[b]+"></option>")}),e.translation()},render:function(){o._getConfig(!1),o.$("[cfg=LightLinkEnable]").change(function(a){var b=o.$(a.target),c=b.prop("checked");c?o.$("#v_light_type").parent().parent().show():o.$("#v_light_type").parent().parent().hide()}),o.$("#v_light_duration").change(function(){var a=o.$("#v_light_duration").val()-0;a=Math.round(a)>a?parseInt(a)+.5:Math.round(a)<a?parseInt(a):a,o.$("#v_light_duration").val(a)}),("flash"==webApp.playMode||"h5"===webApp.playMode)&&e.ConfigManager.getConfig(["Encode","VideoImageControl"]).done(function(a){if(webApp.resolution.x=a[0].params.table[0].MainFormat[0].Video.Width,webApp.resolution.y=a[0].params.table[0].MainFormat[0].Video.Height,1==a[1].params.table[0].Rotate90||2==a[1].params.table[0].Rotate90){var b;b=webApp.resolution.x,webApp.resolution.x=webApp.resolution.y,webApp.resolution.y=b}})},destory:function(){o._detachData(),n.remove()},_getConfig:function(a){e.ConfigManager.getConfig("MotionDetect").done(function(b){p=b,o._renderElements(),a&&o.tip("success","com.OperateSuccessTip"),o.disabled("[btn-for=onConfirm]",!1)}).fail(function(){o.tip("error","com.OperateFailTip"),o.disabled("[btn-for=onConfirm]",!0)})},_renderElements:function(){var a=p[t];a.curWinId=0,v.PtzManual&&o.$("#v_m_ptz").prop("checked",a.PtzManualEnable),o.$("#v_m_enable").prop("checked",a.Enable),o.$("#v_m_anti").numberfield("value",a.EventHandler.Dejitter),o.$("#v_m_event").eventHandler("set",a.EventHandler)},setAreaZone:function(){(-1!==webApp.DeviceType.indexOf("TPC")||"nacl"===g.type)&&g.RemoveAllMonDetectReg(),n.dialog("show"),q=a.extend(!0,[],p),s=p[t].curWinId||0,u&&(n.find("#v_m_figure").figure("start"),e.DevVideoDetect.attachMotionData(++r%65535),webApp.NotifyVersion?i.devNotify.subscribe("devVideoDetect.notifyMotionData",window.showMotionFigure):o.$("#v_m_frame").attr("src","/cgi-bin/videomotion.cgi?sessionId="+e.getSession()),a.subscribe("RECONNECTION",o._reconnect));var b=q[t].MotionDetectWindow||[],c=[],f=[],j=new Array(v.MotionRows);if(a.each(b,function(a,b){void 0===b.Id&&(b.Id=a)}),b.length<v.MotionDetectWindow){a.each(b,function(a,b){c.push(b.Id)}),a.each(j,function(a){j[a]=0});for(var x=0;x<v.MotionDetectWindow;x++)-1===a.inArray(x,c)&&b.splice(x,0,{Id:x,Name:"Region "+(x+1),Region:j,Sensitive:isEnable("videodetect_default_sensitive")||58,Threshold:isEnable("videodetect_default_threshold")||4})}q[t].MotionDetectWindow=b,a.each(b,function(a,b){var c=d(n.find(".videodetect-regions a").eq(a).css("background-color"));f.push(b.Id+"@"+c+"-"+b.Region.join(":")),n.find(".videodetect-region-item:eq("+a+")").data("index",b.Id)}),"flash"===webApp.playMode?(a(".ui-video-iconbar-hls").hide(),k.cover(a("#v_m_detzone")),n.find("#v_m_detzone_del").hide(),k.playPreview(1,0),m.cover("#v_m_detzone",webApp.resolution.x+"*"+webApp.resolution.y),m.SetGridNum(v.MotionRows,v.MotionColumns),m.SetFuntionInfo("MotionDetect",f.join(" ")),m.SetCurrentDrawId(s)):"h5"===webApp.playMode?(a(".ui-video-iconbar-hls").hide(),n.find("#v_m_detzone_del").hide(),l&&(w=new a.Deferred,l.playPreview(1,0,a("#v_m_detzone"),null,w)),w&&w.done(function(a){webApp.resolution.x=a.width,webApp.resolution.y=a.height,m.cover("#v_m_detzone",webApp.resolution.x+"*"+webApp.resolution.y),m.SetGridNum(v.MotionRows,v.MotionColumns),m.SetFuntionInfo("MotionDetect",f.join(" ")),m.SetCurrentDrawId(s),n.find(".videodetect-region-item:eq("+s+")").click()})):g.cover("#v_m_detzone",function(){g.SetModuleMode(1),-1!==webApp.DeviceType.indexOf("TPC")?(g.SetVisibleVideoWnd(1,t),h.chkAuthority("Monitor_0"+(t+1))?g.open(g.stream,t,1):g.SetVideoWndTip(t,tl("noVideoAuthoity"))):g.open(),g.SetGridNum(v.MotionRows,v.MotionColumns),g.SetFuntionInfo("MotionDetect",f.join(" ")),g.SetCurrentDrawId(s)});var y=b[s];n.find("#v_m_region").textfield("value",y.Name),n.find("#v_m_sen").slider("value",y.Sensitive),n.find("#v_m_thr").slider("value",y.Threshold,!0),"h5"!==webApp.playMode&&n.find(".videodetect-region-item:eq("+s+")").click(),o._setTempConfig(),g.addEvent("OutPutStringInfo",function(b,c){var d=c.split(" ");a.each(d,function(b,c){if(c){var d=c.split("-"),e=parseInt(d[0].split("@")[0]);a.each(d[1].split(":"),function(a,b){q[t].MotionDetectWindow[e].Region[a]=parseInt(b)})}}),o._setTempConfig()}),a.subscribe("OutPutStringInfo",function(b,c){var d=c.split(" ");a.each(d,function(b,c){if(c){var d=c.split("-"),e=parseInt(d[0].split("@")[0]);a.each(d[1].split(":"),function(a,b){q[t].MotionDetectWindow[e].Region[a]=parseInt(b)})}}),o._setTempConfig()})},onClearArea:function(){-1!==webApp.DeviceType.indexOf("TPC")||"nacl"===g.type?g.RemoveAllMonDetectReg():"flash"===webApp.playMode||"h5"===webApp.playMode?m.RemoveAllMonDetectReg():g.DelSelReg(-2)},onDelArea:function(){-1!==webApp.DeviceType.indexOf("TPC")||"nacl"===g.type?g.RemoveMonDetectReg(s):"flash"===webApp.playMode||"h5"===webApp.playMode?m.RemoveMonDetectReg(s):g.DelSelReg(-1)},onSetPeriod:function(){p&&p[t].EventHandler&&p[t].EventHandler.TimeSection&&j.open(p[t].EventHandler.TimeSection).done(function(a){p[t].EventHandler.TimeSection=a})},onDefault:function(){e.ConfigManager.getDefault("MotionDetect").done(function(a){p[t]=a[t],p[t].curWinId=0,o._renderElements(),o.tip("success","com.DefaultSuccessTip")}).fail(function(){o.tip("error","com.DefaultfailureTip")})},onRefresh:function(){o._getConfig(!0)},onConfirm:function(){s=p[t].curWinId,delete p[t].curWinId,p[t].Enable=o.$("#v_m_enable").prop("checked"),a.inArray("V3.0",v.DetectVersion)>-1&&(p[t].DetectVersion="V3.0"),v.PtzManual&&(p[t].PtzManualEnable=o.$("#v_m_ptz").prop("checked")),p[t].EventHandler=o.$("#v_m_event").eventHandler("get"),p[t].EventHandler.Dejitter=o.$("#v_m_anti").numberfield("value"),e.ConfigManager.setConfig("MotionDetect",p).done(function(){o.$("#v_m_ptz").prop("checked")&&o.$("input[cfg='PtzLinkEnable']").prop("checked")?(o.tip("warning","com.PtzManualLinkFail",2e3),setTimeout(function(){o.tip("success","com.SaveSuccessTip")},3e3)):o.tip("success","com.SaveSuccessTip")}).fail(function(){o.tip("error","com.SaveConfigFailTip")})},_reconnect:function(){e.DevVideoDetect.attachMotionData(++r%65535),webApp.NotifyVersion?i.devNotify.reconnect():o.$("#v_m_frame").attr("src","/cgi-bin/videomotion.cgi?sessionId="+e.getSession())},_setTempConfig:function(){q[t].Enable=!0,e.ConfigManager.setTemporaryConfig("MotionDetect",q)},_detachData:function(){u&&(n.find("#v_m_figure").figure("stop"),e.DevVideoDetect.detachMotionData(r),webApp.NotifyVersion?i.devNotify.detach("devVideoDetect.notifyMotionData"):o.$("#v_m_frame").attr("src",""),a.unsubscribe("RECONNECTION",o._reconnect)),e.ConfigManager.restoreTemporaryConfig("MotionDetect"),g.addEvent("OutPutStringInfo",null),a.subscribe("OutPutStringInfo",null),g.SetGridNum(0,0),g.hide()}}),window.showMotionFigure=function(b){a.each(b.data,function(a,b){b.id===s&&n.find("#v_m_figure").figure("push",b.threshold)})}}),define("vid_blind",function(require,b,c){var d=require("jsCore/rpc"),e=(require("jsCore/rpcLogin"),require("jsCore/pageBase")),f=require("jsCore/modules/timeSection");require("jsCore/modules/eventHandler");var g=null,h=null,i=null,j=0,k=!1;c.exports=e.extend({init:function(){i=this;var b=i.$("#vid_blind_channel");webApp.CHANNEL_NUMBER>1&&-1===webApp.DeviceType.indexOf("TPC")?(b.parent().removeClass("fn-hide"),b.parent().next("div").removeClass("fn-hide"),b.iconSelect({channelNumber:webApp.CHANNEL_NUMBER,allEnable:!1,change:function(a,b){j=b.ch,i._renderElements()}}),b.iconSelect("index",j)):(b.parent().next("div").remove(),b.parent().remove()),a.inArray("PTVSSP",webApp.VSPs)>-1&&i.$("#v_m_percent,#v_m_duration,#v_m_dejitter").parent().show(),i.$("#v_m_percent").numberfield({min:1,max:100,allowDecimal:!1}),i.$("#v_m_duration").numberfield({min:1,max:300,allowDecimal:!1}),i.$("#v_m_dejitter").numberfield({min:0,max:100,allowDecimal:!1}),ability.get("VideoDetectCaps").done(function(a){-1===webApp.DeviceType.indexOf("TPC")&&-1===webApp.DeviceType.indexOf("SD")&&a&&a.UnFocusDetect?(k=!0,i.$("#v_b_videoable").next("span").attr("t","med.VideoShelterEnable").parent().translation(),i.$("#v_b_focusable").parent().show()):i.$("#v_b_focusable").parent().remove()}),webApp.EventCaps?d.EventManager.getEventLink("VideoBlind").done(function(b){var c=b.name,d=a.extend({},webApp.DefaultEvent),e=webApp.EventCaps;"default"===c[j][0]?d=e:c[j].each(function(a){d[a]=!0,"AlarmOutEnable"===a?d.AlarmOutLatch=e.AlarmOutLatch:"DejitterEnable"===a?d.DejitterRange=e.DejitterRange:"RecordEnable"===a&&(d.RecordLatch=e.RecordLatch)}),i.$("#v_b_event").eventHandler(d)}).fail(function(){i.$("#v_b_event").eventHandler()}).always(function(){i.render()}):(i.$("#v_b_event").eventHandler(),i.render())},render:function(){i._getConfig(!1)},_getConfig:function(a){d.ConfigManager.getConfig("BlindDetect").done(function(b){g=b,i._renderElements(),a&&i.tip("success","com.OperateSuccessTip")}).fail(function(){i.tip("error","com.OperateFailTip")}),k&&d.ConfigManager.getConfig("UnFocusDetect").done(function(a){h=a,i.$("#v_b_focusable").prop("checked",h[j].Enable)})},_renderElements:function(){var b=g[j];i.$("#v_b_videoable").prop("checked",b.Enable),i.$("#v_b_event").eventHandler("set",b.EventHandler),a.inArray("PTVSSP",webApp.VSPs)>-1&&(i.$("#v_m_percent").numberfield("value",b.Percent),i.$("#v_m_duration").numberfield("value",b.Duration),i.$("#v_m_dejitter").numberfield("value",b.Dejitter))},onDefault:function(){d.ConfigManager.getDefault("BlindDetect").done(function(a){g[j]=a[j],i._renderElements(),i.tip("success","com.DefaultSuccessTip")}).fail(function(){i.tip("error","com.DefaultfailureTip")}),k&&d.ConfigManager.getDefault("UnFocusDetect").done(function(a){h=a,i.$("#v_b_focusable").prop("checked",h[j].Enable)})},onRefresh:function(){i._getConfig(!0)},onConfirm:function(){if(g){var b=g[j];b.Enable=i.$("#v_b_videoable").prop("checked"),b.EventHandler=i.$("#v_b_event").eventHandler("get"),a.inArray("PTVSSP",webApp.VSPs)>-1&&(b.Percent=i.$("#v_m_percent").numberfield("value"),b.Duration=i.$("#v_m_duration").numberfield("value"),b.Dejitter=i.$("#v_m_dejitter").numberfield("value")),d.ConfigManager.setConfig("BlindDetect",g).done(function(){i.tip("success","com.SaveSuccessTip")}).fail(function(){i.tip("error","com.SaveConfigFailTip")})}h&&(h[j].Enable=i.$("#v_b_focusable").prop("checked"),h[j].EventHandler=g[j].EventHandler,d.ConfigManager.setConfig("UnFocusDetect",h))},onSetPeriod:function(){g&&g[j].EventHandler&&g[j].EventHandler.TimeSection&&f.open(g[j].EventHandler.TimeSection).done(function(a){g[j].EventHandler.TimeSection=a})}})}),define("vid_unFocus",function(require,b,c){var d=require("jsCore/rpc"),e=(require("jsCore/rpcLogin"),require("jsCore/pageBase")),f=require("jsCore/modules/timeSection");require("jsCore/modules/eventHandler");var g=null,h=null,i=0;c.exports=e.extend({init:function(){h=this,webApp.EventCaps?d.EventManager.getEventLink("VideoUnFocus").done(function(b){var c=b.name,d=a.extend({},webApp.DefaultEvent),e=webApp.EventCaps;"default"===c[i][0]?d=e:c[i].each(function(a){d[a]=!0,"AlarmOutEnable"===a?d.AlarmOutLatch=e.AlarmOutLatch:"DejitterEnable"===a?d.DejitterRange=e.DejitterRange:"RecordEnable"===a&&(d.RecordLatch=e.RecordLatch)}),h.$("#v_u_event").eventHandler(d)}).fail(function(){h.$("#v_u_event").eventHandler()}).always(function(){h.render()}):(h.$("#v_u_event").eventHandler(),h.render())},render:function(){h._getConfig(!1)},_getConfig:function(a){d.ConfigManager.getConfig("UnFocusDetect").done(function(b){g=b,h._renderElements(),a&&h.tip("success","com.OperateSuccessTip")}).fail(function(){h.tip("error","com.OperateFailTip")})},_renderElements:function(){h.$("#v_u_focusable").prop("checked",g[i].Enable),h.$("#v_u_event").eventHandler("set",g[i].EventHandler)},onDefault:function(){d.ConfigManager.getDefault("UnFocusDetect").done(function(a){g[i]=a[i],h._renderElements(),h.tip("success","com.DefaultSuccessTip")}).fail(function(){h.tip("error","com.DefaultfailureTip")})},onRefresh:function(){h._getConfig(!0)},onConfirm:function(){g[i].Enable=h.$("#v_u_focusable").prop("checked"),g[i].EventHandler=h.$("#v_u_event").eventHandler("get"),d.ConfigManager.setConfig("UnFocusDetect",g).done(function(){h.tip("success","com.SaveSuccessTip")}).fail(function(){h.tip("error","com.SaveConfigFailTip")})},onSetPeriod:function(){g&&g[i].EventHandler&&g[i].EventHandler.TimeSection&&f.open(g[i].EventHandler.TimeSection).done(function(a){g[i].EventHandler.TimeSection=a})}})}),define("vid_abnormal",function(require,b,c){var d=require("jsCore/rpc"),e=(require("jsCore/rpcLogin"),require("jsCore/pageBase")),f=require("jsCore/modules/timeSection");require("jsCore/modules/eventHandler");var g=null,h=null,i=0;c.exports=e.extend({init:function(){g=this,webApp.EventCaps?d.EventManager.getEventLink("SceneChange").done(function(b){var c=b.name,d=a.extend({},webApp.DefaultEvent),e=webApp.EventCaps;"default"===c[i][0]?d=e:c[i].each(function(a){d[a]=!0,"AlarmOutEnable"===a?d.AlarmOutLatch=e.AlarmOutLatch:"DejitterEnable"===a?d.DejitterRange=e.DejitterRange:"RecordEnable"===a&&(d.RecordLatch=e.RecordLatch)}),g.$("#v_a_event").eventHandler(d)}).fail(function(){g.$("#v_a_event").eventHandler()}).always(function(){g.render()}):(g.$("#v_a_event").eventHandler(),g.render());var b=g.$("#vid_abnormal_channel");webApp.CHANNEL_NUMBER>1?(b.parent().removeClass("fn-hide"),b.parent().next("div").removeClass("fn-hide"),b.iconSelect({channelNumber:webApp.CHANNEL_NUMBER,allEnable:!1,change:function(a,b){i=b.ch,g._renderElements()}}),b.iconSelect("index",i)):(b.parent().next("div").remove(),b.parent().remove())},render:function(){g._getConfig(!1)},_getConfig:function(a){d.ConfigManager.getConfig("MovedDetect").done(function(b){h=b,g._renderElements(),a&&g.tip("success","com.OperateSuccessTip"),g.disabled("[btn-for=onConfirm]",!1)}).fail(function(){g.tip("error","com.OperateFailTip"),g.disabled("[btn-for=onConfirm]",!0)})},_renderElements:function(){g.$("#v_a_enable").prop("checked",h[i].Enable),g.$("#v_a_event").eventHandler("set",h[i].EventHandler)},onDefault:function(){d.ConfigManager.getDefault("MovedDetect").done(function(a){h[i]=a[i],g._renderElements(),g.tip("success","com.DefaultSuccessTip")}).fail(function(){g.tip("error","com.DefaultfailureTip")})},onRefresh:function(){g._getConfig(!0)},onConfirm:function(){h[i].Enable=g.$("#v_a_enable").prop("checked"),h[i].EventHandler=g.$("#v_a_event").eventHandler("get"),d.ConfigManager.getConfig("MovedDetect").done(function(a){a[i]=h[i],d.ConfigManager.setConfig("MovedDetect",a).done(function(){g.tip("success","com.SaveSuccessTip")}).fail(function(){g.tip("error","com.SaveConfigFailTip")})})},onSetPeriod:function(){h&&h[i].EventHandler&&h[i].EventHandler.TimeSection&&f.open(h[i].EventHandler.TimeSection).done(function(a){h[i].EventHandler.TimeSection=a})}})})}(jQuery);