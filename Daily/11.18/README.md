# 麒麟银河

## 麒麟银河系统安全机制-KYSEC

1、麒麟系统为什么称为国内最安全的Linux系统？秘密就在于KYSEC，麒麟系统安全机制。一般情况下Linux下默认的接入控制是DAC，其特点是资源的拥有者可以对他进行任何操作（读、写、执行）。当一个进程准备操作资源时，Linux内核会比较进程和资源的UID和GID，如果权限允许，就可以进行相应的操作。这种方式在实际使用中往往会带来一些问题，如果一个进程是以root的身份运行的，也就是他能对系统的任何资源进行操作，而且不被限制。假如我们的软件存在漏洞呢？这往往是一个灾难性的问题。因此，就引出了另外一种安全接入控制机制MAC。默认情况下，MAC不允许任何访问，组织可以开发任意数量的策略规则指定允许什么，从而避免很多攻击。MAC强制访问控制有三种实现方式：Apparmor、SELinux、kysec。



2、SELinux是美国国家安全局（NSA）对于强制访问控制的实现，是Linux历史上最杰出的系统安全子系统。通过给系统所有用户、进程、文件分别赋予一个安全标记，通过安全策略规则来实施安全控制；只有安全策略允许的操作才能执行成功，安全策略禁止或者没有定制安全策略的操作则执行失败。



3、KYSEC是基于kysec安全标记对执行程序、脚本文件、共享库、内核模块进行保护的一种安全机制。除了系统默认集成的执行程序、脚本文件、共享库、内核模块，任何外来的该4种文件，如拷贝、移动、下载、重新编译生成等，都必须添加到麒麟安全管理工具的相应白名单列表中，才能执行调用。会对白名单列表中的文件进行保护，保护文件不被修改、移动、删除。



KYSEC有三种安全模式：

- 强制模式（Normal）：出现违规操作时，不止会审计记录该操作，还会阻止该操作的运行；
- 警告模式（Warning）：出现违规操作时，会弹出麒麟安全授权认证框进行授权；
- 软模式（Softmode）：出现违规操作时，只会审计记录该操作，而不会阻止该操作的运行。



查看当前kysec的相关安全状态：`getstatus`

![image-20211118092508894](https://i.loli.net/2021/11/18/3euICE6xPo5UORp.png)

* 第一行Kysec status表示当前Kysec状态为normal
* 第二行exec control表示当前执行控制功能状态为
* 



参考资料：

[银河麒麟系统安全机制-KYSEC - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/349663329)

[虎符 2021 线下 PKS体系攻防实战 Kysec 机制绕过 | Clang裁缝店 (xuanxuanblingbling.github.io)](https://xuanxuanblingbling.github.io/ctf/pwn/2021/04/29/pk/)
=======
=======
>>>>>>> 0505b64c38087f21190a92fc914cae0b88619cfc
# 麒麟银河

## 麒麟银河系统安全机制-KYSEC

1、麒麟系统为什么称为国内最安全的Linux系统？秘密就在于KYSEC，麒麟系统安全机制。一般情况下Linux下默认的接入控制是DAC，其特点是资源的拥有者可以对他进行任何操作（读、写、执行）。当一个进程准备操作资源时，Linux内核会比较进程和资源的UID和GID，如果权限允许，就可以进行相应的操作。这种方式在实际使用中往往会带来一些问题，如果一个进程是以root的身份运行的，也就是他能对系统的任何资源进行操作，而且不被限制。假如我们的软件存在漏洞呢？这往往是一个灾难性的问题。因此，就引出了另外一种安全接入控制机制MAC。默认情况下，MAC不允许任何访问，组织可以开发任意数量的策略规则指定允许什么，从而避免很多攻击。MAC强制访问控制有三种实现方式：Apparmor、SELinux、kysec。



2、SELinux是美国国家安全局（NSA）对于强制访问控制的实现，是Linux历史上最杰出的系统安全子系统。通过给系统所有用户、进程、文件分别赋予一个安全标记，通过安全策略规则来实施安全控制；只有安全策略允许的操作才能执行成功，安全策略禁止或者没有定制安全策略的操作则执行失败。



3、KYSEC是基于kysec安全标记对执行程序、脚本文件、共享库、内核模块进行保护的一种安全机制。除了系统默认集成的执行程序、脚本文件、共享库、内核模块，任何外来的该4种文件，如拷贝、移动、下载、重新编译生成等，都必须添加到麒麟安全管理工具的相应白名单列表中，才能执行调用。会对白名单列表中的文件进行保护，保护文件不被修改、移动、删除。



KYSEC有三种安全模式：

- 强制模式（Normal）：出现违规操作时，不止会审计记录该操作，还会阻止该操作的运行；
- 警告模式（Warning）：出现违规操作时，会弹出麒麟安全授权认证框进行授权；
- 软模式（Softmode）：出现违规操作时，只会审计记录该操作，而不会阻止该操作的运行。



查看当前kysec的相关安全状态：`getstatus`

![image-20211118092508894](https://i.loli.net/2021/11/18/3euICE6xPo5UORp.png)

* 第一行Kysec status表示当前Kysec状态为normal
* 第二行exec control表示当前执行控制功能状态为
* 



参考资料：

[银河麒麟系统安全机制-KYSEC - 知乎 (zhihu.com)](https://zhuanlan.zhihu.com/p/349663329)

[虎符 2021 线下 PKS体系攻防实战 Kysec 机制绕过 | Clang裁缝店 (xuanxuanblingbling.github.io)](https://xuanxuanblingbling.github.io/ctf/pwn/2021/04/29/pk/)
