function mToken(a){function b(){var a={versions:function(){{var a=navigator.userAgent;navigator.appVersion}return{trident:a.indexOf("Trident")>-1,presto:a.indexOf("Presto")>-1,webKit:a.indexOf("AppleWebKit")>-1,gecko:a.indexOf("Gecko")>-1&&-1==a.indexOf("KHTML"),mobile:!!a.match(/AppleWebKit.*Mobile.*/),ios:!!a.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),android:a.indexOf("Android")>-1||a.indexOf("Linux")>-1,iPhone:a.indexOf("iPhone")>-1,iPad:a.indexOf("iPad")>-1,webApp:-1==a.indexOf("Safari")}}(),language:(navigator.browserLanguage||navigator.language).toLowerCase()};return a.versions.mobile&&(a.versions.ios||a.versions.android||a.versions.iPhone||a.versions.iPad)?!0:!1}this.obj=a,this.SAR_OK=0,this.SAR_FALSE=1,this.SGD_SM1_ECB=257,this.SGD_SM1_CBC=258,this.SGD_SM1_CFB=260,this.SGD_SM1_OFB=264,this.SGD_SM1_MAC=272,this.SGD_SSF33_ECB=513,this.SGD_SSF33_CBC=514,this.SGD_SSF33_CFB=516,this.SGD_SSF33_OFB=520,this.SGD_SSF33_MAC=528,this.SGD_SM4_ECB=1025,this.SGD_SM4_CBC=1026,this.SGD_SM4_CFB=1028,this.SGD_SM4_OFB=1032,this.SGD_SM4_MAC=1040,this.SGD_VENDOR_DEFINED=2147483648,this.SGD_DES_ECB=this.SGD_VENDOR_DEFINED+529,this.SGD_DES_CBC=this.SGD_VENDOR_DEFINED+530,this.SGD_3DES168_ECB=this.SGD_VENDOR_DEFINED+577,this.SGD_3DES168_CBC=this.SGD_VENDOR_DEFINED+578,this.SGD_3DES112_ECB=this.SGD_VENDOR_DEFINED+545,this.SGD_3DES112_CBC=this.SGD_VENDOR_DEFINED+546,this.SGD_AES128_ECB=this.SGD_VENDOR_DEFINED+273,this.SGD_AES128_CBC=this.SGD_VENDOR_DEFINED+274,this.SGD_AES192_ECB=this.SGD_VENDOR_DEFINED+289,this.SGD_AES192_CBC=this.SGD_VENDOR_DEFINED+290,this.SGD_AES256_ECB=this.SGD_VENDOR_DEFINED+321,this.SGD_AES256_CBC=this.SGD_VENDOR_DEFINED+322,this.SGD_RSA=65536,this.SGD_SM2_1=131328,this.SGD_SM2_2=131584,this.SGD_SM2_3=132096,this.SGD_SM3=1,this.SGD_SHA1=2,this.SGD_SHA256=4,this.SGD_RAW=128,this.SGD_MD5=129,this.SGD_SHA384=130,this.SGD_SHA512=131,this.SGD_CERT_VERSION=1,this.SGD_CERT_SERIAL=2,this.SGD_CERT_ISSUE=5,this.SGD_CERT_VALID_TIME=6,this.SGD_CERT_SUBJECT=7,this.SGD_CERT_DER_PUBLIC_KEY=8,this.SGD_CERT_DER_EXTENSIONS=9,this.SGD_CERT_NOT_BEFORE=16,this.SGD_CERT_ISSUER_CN=33,this.SGD_CERT_ISSUER_O=34,this.SGD_CERT_ISSUER_OU=35,this.SGD_CERT_ISSUER_C=36,this.SGD_CERT_ISSUER_P=37,this.SGD_CERT_ISSUER_L=38,this.SGD_CERT_ISSUER_S=39,this.SGD_CERT_ISSUER_EMAIL=40,this.SGD_CERT_SUBJECT_CN=49,this.SGD_CERT_SUBJECT_O=50,this.SGD_CERT_SUBJECT_OU=51,this.SGD_CERT_SUBJECT_EMALL=52,this.SGD_REMAIN_TIME=53,this.SGD_SIGNATURE_ALG=54,this.SGD_CERT_SUBJECT_C=55,this.SGD_CERT_SUBJECT_P=56,this.SGD_CERT_SUBJECT_L=57,this.SGD_CERT_SUBJECT_S=58,this.SGD_CERT_CRL=65,this.SGD_DEVICE_SORT=513,this.SGD_DEVICE_TYPE=514,this.SGD_DEVICE_NAME=515,this.SGD_DEVICE_MANUFACTURER=516,this.SGD_DEVICE_HARDWARE_VERSION=517,this.SGD_DEVICE_SOFTWARE_VERSION=518,this.SGD_DEVICE_STANDARD_VERSION=519,this.SGD_DEVICE_SERIAL_NUMBER=520,this.SGD_DEVICE_SUPPORT_SYM_ALG=521,this.SGD_DEVICE_SUPPORT_ASYM_ALG=522,this.SGD_DEVICE_SUPPORT_HASH_ALG=523,this.SGD_DEVICE_SUPPORT_STORANGE_SPACE=524,this.SGD_DEVICE_SUPPORT_FREE_SAPCE=525,this.SGD_DEVICE_RUNTIME=526,this.SGD_DEVICE_USED_TIMES=527,this.SGD_DEVICE_LOCATION=528,this.SGD_DEVICE_DESCRIPTION=529,this.SGD_DEVICE_MANAGER_INFO=530,this.SGD_DEVICE_MAX_DATA_SIZE=531,this.TRUE=1,this.FALSE=0,this.GM3000PCSC=0,this.GM3000=1,this.K7=2,this.K5=3,this.TF=4,this.TYPE_UKEY=1,this.TYPE_FPKEY=2;var c=null;this.SOF_GetLastError=function(){return null==c?-1:c.SOF_GetLastError()},this.SOF_LoadLibrary=function(a){var d;if(null==c&&(c=new mTokenPlugin),a==this.GM3000PCSC)d=b()?c.SOF_LoadLibrary("1","mToken OTG","com.longmai.security.plugin.driver.otg.OTGDriver"):c.SOF_LoadLibrary("mtoken_gm3000_pcsc.dll","libgm3000_scard.1.0.so","libgm3000_scard.1.0.dylib");else if(a==this.GM3000)d=b()?c.SOF_LoadLibrary("1","mToken OTG","com.longmai.security.plugin.driver.otg.OTGDriver"):c.SOF_LoadLibrary("mtoken_gm3000.dll","libgm3000.1.0.so","libgm3000.1.0.dylib");else if(a==this.K7)d=c.SOF_LoadLibrary("mtoken_k7.dll","libk7.1.0.so","libk7.1.0.dylib");else if(a==this.K5)d=b()?c.SOF_LoadLibrary("2","mToken K5 Bluetooth","com.longmai.security.plugin.driver.ble.BLEDriver"):c.SOF_LoadLibrary("mtoken_k5.dll","libk5.1.0.so","libk5.1.0.dylib");else{if(a!=this.TF)return-1;d=b()?c.SOF_LoadLibrary("0","mToken TF/SD Card","com.longmai.security.plugin.driver.tf.TFDriver"):c.SOF_LoadLibrary("mtoken_tf.dll","libtf.so","libtf.dylib")}return 0!=d?-2:this.SAR_OK},this.SOF_EnumDevice=function(){if(null==c)return null;var a=c.SOF_EnumDevice();return null==a||a.length<=0?null:a.split("||")},this.SOF_GetVersion=function(){return null==c?null:c.SOF_GetVersion()},this.SOF_GetDeviceInstance=function(a,b){return null==c?-1:c.SOF_GetDeviceInstance(a,b)},this.SOF_ReleaseDeviceInstance=function(){return null==c?-1:c.SOF_ReleaseDeviceInstance()},this.SOF_GetUserList=function(){if(null==c)return null;var a=c.SOF_GetUserList();if(null==a||a.length<=0)return null;for(var b=new Array,d=a.split("&&&"),e=d.length,f=0;e>f;f++)b[f]=d[f].split("||");return b},this.SOF_ExportUserCert=function(a,b){return null==c?null:c.SOF_ExportUserCert(a,b)},this.SOF_GetDeviceInfo=function(a){return null==c?null:c.SOF_GetDeviceInfo(a)},this.SOF_GetCertInfo=function(a,b){return null==c?null:c.SOF_GetCertInfo(a,b)},this.SOF_GetCertInfoByOid=function(a,b){return null==c?null:c.SOF_GetCertInfoByOid(a,b)},this.SOF_Login=function(a){return null==c?-1:c.SOF_Login(a)},this.SOF_LogOut=function(){return null==c?-1:c.SOF_LogOut()},this.SOF_GetPinRetryCount=function(){return null==c?-1:c.SOF_GetPinRetryCount()},this.SOF_ChangePassWd=function(a,b){return null==c?-1:c.SOF_ChangePassWd(a,b)},this.SOF_SetDigestMethod=function(a){return null==c?-1:c.SOF_SetDigestMethod(a)},this.SOF_SetUserID=function(a){return null==c?-1:c.SOF_SetUserID(a)},this.SOF_SetEncryptMethodAndIV=function(a,b){return null==c?-1:c.SOF_SetEncryptMethodAndIV(a,b)},this.SOF_EncryptFileToPKCS7=function(a,b,d,e){return null==c?-1:c.SOF_EncryptFileToPKCS7(a,b,d,e)},this.SOF_SignFileToPKCS7=function(a,b,d){return null==c?-1:c.SOF_SignFileToPKCS7(a,b,d)},this.SOF_VerifyFileToPKCS7=function(a,b){return null==c?-1:c.SOF_VerifyFileToPKCS7(a,b)},this.SOF_DecryptFileToPKCS7=function(a,b,d,e,f,g){return null==c?-1:c.SOF_DecryptFileToPKCS7(a,b,d,e,f,g)},this.SOF_DigestData=function(a,b,d){return null==c?null:c.SOF_DigestData(a,b,d)},this.SOF_SignData=function(a,b,d,e){return null==c?null:c.SOF_SignData(a,b,d,e)},this.SOF_SignDataInteractive=function(a,b,d,e){return null==c?null:c.SOF_SignDataInteractive(a,b,d,e)},this.SOF_SignDataToPKCS7=function(a,b,d,e){return null==c?null:c.SOF_SignDataToPKCS7(a,b,d,e)},this.SOF_VerifyDataToPKCS7=function(a,b,d){return null==c?-1:c.SOF_VerifyDataToPKCS7(a,b,d)},this.SOF_VerifySignedData=function(a,b,d,e){return null==c?-1:c.SOF_VerifySignedData(a,b,d,e)},this.SOF_EncryptDataPKCS7=function(a,b,d){return null==c?null:c.SOF_EncryptDataPKCS7(a,b,d)},this.SOF_DecryptDataPKCS7=function(a,b,d){return null==c?null:c.SOF_DecryptDataPKCS7(a,b,d)},this.SOF_GenRemoteUnblockRequest=function(){return null==c?null:c.SOF_GenRemoteUnblockRequest()},this.SOF_GenResetpwdResponse=function(a,b,d){return null==c?null:c.SOF_GenResetpwdResponse(a,b,d)},this.SOF_RemoteUnblockPIN=function(a){return null==c?null:c.SOF_RemoteUnblockPIN(a)},this.SOF_SignDataToPKCS7=function(a,b,d,e){return null==c?null:c.SOF_SignDataToPKCS7(a,b,d,e)},this.SOF_VerifyDataToPKCS7=function(a,b,d){return null==c?null:c.SOF_VerifyDataToPKCS7(a,b,d)},this.SOF_ExportPubKey=function(a,b,d){return null==c?null:c.SOF_ExportPubKey(a,b,d)},this.SOF_EncryptByPubKey=function(a,b,d){return null==c?null:c.SOF_EncryptByPubKey(a,b,d)},this.SOF_DecryptByPrvKey=function(a,b,d){return null==c?null:c.SOF_DecryptByPrvKey(a,b,d)},this.SOF_CreateKeyPair=function(a,b,d,e){return null==c?null:c.SOF_CreateKeyPair(a,b,d,e)},this.SOF_EnumCertContiner=function(){return null==c?null:c.SOF_EnumCertContiner()},this.SOF_FindContainer=function(a){return null==c?null:c.SOF_FindContainer(a)},this.SOF_DeleteCert=function(a){return null==c?null:c.SOF_DeleteCert(a)},this.SOF_DeleteContainer=function(a){return null==c?null:c.SOF_DeleteContainer(a)},this.SOF_SignByCert=function(a,b){return null==c?null:c.SOF_SignByCert(a,b)},this.SOF_VerifyByCert=function(a,b,d){return null==c?null:c.SOF_VerifyByCert(a,b,d)},this.SOF_GenerateP10Request=function(a,b,d,e,f){return null==c?null:c.SOF_GenerateP10Request(a,b,d,e,f)},this.SOF_ImportCert=function(a,b,d){return null==c?null:c.SOF_ImportCert(a,b,d)},this.SOF_ImportCryptoCertAndKey=function(a,b,d,e,f,g,h){return null==c?null:c.SOF_ImportCryptoCertAndKey(a,b,d,e,f,g,h)},this.SOF_VerifyByExtCert=function(a,b,d,e){return null==c?null:c.SOF_VerifyByExtCert(a,b,d,e)},this.SOF_GenerateRandom=function(a){return null==c?null:c.SOF_GenerateRandom(a)},this.SOF_SymEncryptFile=function(a,b,d,e){return null==c?null:c.SOF_SymEncryptFile(a,b,d,e)},this.SOF_SymDecryptFile=function(a,b,d,e){return null==c?null:c.SOF_SymDecryptFile(a,b,d,e)},this.SOF_SymEncryptData=function(a,b){return null==c?null:c.SOF_SymEncryptData(a,b)},this.SOF_SymDecryptData=function(a,b){return null==c?null:c.SOF_SymDecryptData(a,b)},this.SOF_GenerateQRCode=function(a){return null==c?null:c.SOF_GenerateQRCode(a)},this.SOF_VerifyPinMS=function(a){return null==c?null:c.SOF_VerifyPinMS(a)},this.SOF_GetHardwareType=function(){return null==c?null:c.SOF_GetHardwareType()},this.SOF_VerifyFingerprint=function(){return null==c?null:c.SOF_VerifyFingerprint()},this.SOF_EnumFiles=function(){if(null==c)return null;var a=c.SOF_EnumFiles();return null==a||a.length<=0?null:a.split("||")},this.SOF_ReadFile=function(a,b,d){return null==c?null:c.SOF_ReadFile(a,Number(b),Number(d))},this.SOF_WriteFile=function(a,b,d){return null==c?null:c.SOF_WriteFile(a,b,d)},this.SOF_CreateFile=function(a,b,d,e){return null==c?null:c.SOF_CreateFile(a,b,d,e)},this.SOF_DeleteFile=function(a){return null==c?null:c.SOF_DeleteFile(a)}}function mTokenPlugin(){function AjaxIO(a){null==_xmlhttp&&(_xmlhttp=window.XMLHttpRequest?new XMLHttpRequest:new ActiveXObject("Microsoft.XMLHTTP")),"https:"==document.location.protocol&&(_url="http://127.0.0.1:51235/alpha"),_xmlhttp.open("POST",_url,!1),_xmlhttp.setRequestHeader("Content-type","application/x-www-form-urlencoded"),_xmlhttp.send("json="+a)}function GetHttpResult(){if(4==_xmlhttp.readyState&&200==_xmlhttp.status){var obj=eval("("+_xmlhttp.responseText+")");return obj}return null}var _curDevName="",_url="http://127.0.0.1:51235/alpha",_xmlhttp;this.SOF_GetLastError=function(){var a='{"function":"SOF_GetLastError"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.rtn:-2},this.SOF_LoadLibrary=function(a,b,c){var d='{"function":"SOF_LoadLibrary", "winDllName":"'+a+'", "linuxSOName":"'+b+'", "macDylibName":"'+c+'"}';try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.rtn:-2},this.SOF_EnumDevice=function(){var a='{"function":"SOF_EnumDevice"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.array:null},this.SOF_GetVersion=function(){var a='{"function":"SOF_GetVersion"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.version:-2},this.SOF_GetDeviceInstance=function(a,b){var c='{"function":"SOF_GetDeviceInstance", "deviceName":"'+a+'", "applicationName":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?(0==e.rtn&&(_curDevName=a),e.rtn):-2},this.SOF_ReleaseDeviceInstance=function(){var a='{"function":"SOF_ReleaseDeviceInstance", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.rtn:-2},this.SOF_GetUserList=function(){var a='{"function":"SOF_GetUserList", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.array:null},this.SOF_ExportUserCert=function(a,b){var c='{"function":"SOF_ExportUserCert", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "keySpec":'+b+"}";try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.cert:null},this.SOF_GetDeviceInfo=function(a){var b='{"function":"SOF_GetDeviceInfo", "deviceName":"'+_curDevName+'", "type":'+a+"}";try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.info:null},this.SOF_GetCertInfo=function(a,b){var c='{"function":"SOF_GetCertInfo", "base64EncodeCert":"'+a+'", "type":'+b+"}";try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.info:null},this.SOF_GetCertInfoByOid=function(a,b){var c='{"function":"SOF_GetCertInfoByOid", "base64EncodeCert":"'+a+'", "oid":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.info:null},this.SOF_Login=function(a){var b='{"function":"SOF_Login", "deviceName":"'+_curDevName+'", "passWd":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:-2},this.SOF_LogOut=function(){var a='{"function":"SOF_LogOut", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.rtn:-2},this.SOF_GetPinRetryCount=function(){var a='{"function":"SOF_GetPinRetryCount", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.retryCount:-2},this.SOF_ChangePassWd=function(a,b){var c='{"function":"SOF_ChangePassWd", "deviceName":"'+_curDevName+'",  "oldUpin":"'+a+'", "newUpin":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.rtn:-2},this.SOF_SetDigestMethod=function(a){var b='{"function":"SOF_SetDigestMethod","deviceName":"'+_curDevName+'", "digestMethod":'+a+"}";try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:-2},this.SOF_SetUserID=function(a){var b='{"function":"SOF_SetUserID","deviceName":"'+_curDevName+'", "userID":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:-2},this.SOF_SetEncryptMethodAndIV=function(a,b){var c='{"function":"SOF_SetEncryptMethodAndIV","deviceName":"'+_curDevName+'", "encryptMethod":'+a+', "encryptIV":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.rtn:-2},this.SOF_EncryptFileToPKCS7=function(a,b,c,d){var e='{"function":"SOF_EncryptFileToPKCS7", "deviceName":"'+_curDevName+'", "cert":"'+a+'", "inFile":"'+b.replace(/\\/g,"\\\\")+'", "outFile":"'+c.replace(/\\/g,"\\\\")+'", "type":'+d+"}";try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.envelopData:-2},this.SOF_SignFileToPKCS7=function(a,b,c){var d='{"function":"SOF_SignFileToPKCS7", "deviceName":"'+_curDevName+'",  "containerName":"'+a+'", "KeySpec":'+b+', "inFile":"'+c.replace(/\\/g,"\\\\")+'"}';try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.signed:null},this.SOF_VerifyFileToPKCS7=function(a,b){var c='{"function":"SOF_VerifyFileToPKCS7", "deviceName":"'+_curDevName+'","strPkcs7Data":"'+a+'", "inFile":"'+b.replace(/\\/g,"\\\\")+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.rtn:-2},this.SOF_DecryptFileToPKCS7=function(a,b,c,d,e,f){var g='{"function":"SOF_DecryptFileToPKCS7", "deviceName":"'+_curDevName+'",  "containerName":"'+a+'", "keySpec":'+b+', "pkcs7Data":"'+c+'", "inFile":"'+d.replace(/\\/g,"\\\\")+'", "outFile":"'+e.replace(/\\/g,"\\\\")+'", "type":'+f+"}";try{AjaxIO(g)}catch(h){return-3}var i=GetHttpResult();return i?i.rtn:-2},this.SOF_DigestData=function(a,b,c){var d='{"function":"SOF_DigestData","deviceName":"'+_curDevName+'",  "containerName":"'+a+'", "inData":"'+b+'", "inDataLen":'+c+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.digest:null},this.SOF_SignDataInteractive=function(a,b,c,d){var e=c,f='{"function":"SOF_SignDataInteractive", "deviceName":"'+_curDevName+'",  "containerName":"'+a+'", "keySpec":'+b+', "inData":"'+e+'", "inDataLen":'+d+"}";try{AjaxIO(f)}catch(g){return-3}var h=GetHttpResult();return h?h.signed:null},this.SOF_SignData=function(a,b,c,d){var e='{"function":"SOF_SignDataEx", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "keySpec":'+b+', "inData":"'+c+'", "inDataLen":'+d+"}";try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.signed:null},this.SOF_VerifySignedData=function(a,b,c,d){var e='{"function":"SOF_VerifySignedDataEx","deviceName":"'+_curDevName+'", "base64EncodeCert":"'+a+'", "digestMethod":'+b+', "inData":"'+c+'", "signedValue":"'+d+'"}';try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.rtn:-2},this.SOF_EncryptDataPKCS7=function(a,b,c){var d='{"function":"SOF_EncryptDataPKCS7", "deviceName":"'+_curDevName+'", "base64EncodeCert":"'+a+'", "inData":"'+b+'", "inDataLen":'+c+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.encrypedData:null},this.SOF_DecryptDataPKCS7=function(a,b,c){var d='{"function":"SOF_DecryptDataPKCS7", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "keySpec":'+b+', "inData":"'+c+'"}';try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.decryptedData:null},this.SOF_GenRemoteUnblockRequest=function(){var a='{"function":"SOF_GenRemoteUnblockRequest", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.request:null},this.SOF_GenResetpwdResponse=function(a,b,c){var d='{"function":"SOF_GenResetpwdResponse", "deviceName":"'+_curDevName+'",  "request":"'+a+'", "soPin":"'+b+'", "userPin":"'+c+'"}';try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.request:null},this.SOF_RemoteUnblockPIN=function(a){var b='{"function":"SOF_RemoteUnblockPIN", "deviceName":"'+_curDevName+'", "request":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:-2},this.SOF_SignDataToPKCS7=function(a,b,c,d){var e='{"function":"SOF_SignDataToPKCS7", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "keySpec":'+b+', "inData":"'+c+'",  "detached":'+d+"}";try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.pkcs7:null},this.SOF_VerifyDataToPKCS7=function(a,b,c){var d='{"function":"SOF_VerifyDataToPKCS7", "deviceName":"'+_curDevName+'", "pkcs7":"'+a+'", "original":"'+b+'", "detached":'+c+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.rtn:-2},this.SOF_ExportPubKey=function(a,b,c){var d='{"function":"SOF_ExportPubKeyEx","deviceName":"'+_curDevName+'",  "containerName":"'+a+'", "keySpec":'+b+', "expType":'+c+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.pubKey:null},this.SOF_EncryptByPubKey=function(a,b,c){var d='{"function":"SOF_EncryptByPubKey", "deviceName":"'+_curDevName+'", "pubKey":"'+a+'", "asymPlain":"'+b+'", "keySpec":'+c+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.asymCipher:null},this.SOF_DecryptByPrvKey=function(a,b,c){var d='{"function":"SOF_DecryptByPrvKey", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "asymCipher":"'+c+'", "keySpec":'+b+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.asymPlain:null},this.SOF_CreateKeyPair=function(a,b,c,d){var e='{"function":"SOF_CreateKeyPair","deviceName":"'+_curDevName+'",  "containerName":"'+a+'", "asymAlg":'+c+', "keySpec":'+b+',"keyLength":'+d+"}";try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.rtn:-2},this.SOF_EnumCertContiner=function(){var a='{"function":"SOF_EnumCertContiner", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.containerName:""},this.SOF_FindContainer=function(a){var b='{"function":"SOF_FindContainer","deviceName":"'+_curDevName+'",  "certSN":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.containerName:""},this.SOF_DeleteCert=function(a){var b='{"function":"SOF_DeleteCert","deviceName":"'+_curDevName+'",  "certSN":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:-2},this.SOF_DeleteContainer=function(a){var b='{"function":"SOF_DeleteContainer", "deviceName":"'+_curDevName+'", "certSN":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:-2},this.SOF_SignByCert=function(a,b){var c='{"function":"SOF_SignByCert", "deviceName":"'+_curDevName+'", "certSN":"'+a+'", "inData":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.signed:null},this.SOF_VerifyByCert=function(a,b,c,d){var e='{"function":"SOF_VerifyByCert", "deviceName":"'+_curDevName+'", "certSN":"'+a+'","digestMethod":'+d+', "inData":"'+b+'", "signed":"'+c+'"}';try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.rtn:-2},this.SOF_VerifyByExtCert=function(a,b,c,d){var e='{"function":"SOF_VerifyByExtCert","deviceName":"'+_curDevName+'",  "cert":"'+a+'", "digestMethod":'+d+', "inData":"'+b+'", "signed":"'+c+'"}';try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.rtn:-2},this.SOF_GenerateP10Request=function(a,b,c,d,e){var f='{"function":"SOF_GenerateP10Request", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "certDN":"'+b+'", "asymAlg":'+c+', "keySpec":'+d+',"keyLength":'+e+"}";try{AjaxIO(f)}catch(g){return-3}var h=GetHttpResult();return h?h.outData:null},this.SOF_ImportCert=function(a,b,c){var d='{"function":"SOF_ImportCert", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "cert":"'+b+'", "keySpec":'+c+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.rtn:-2},this.SOF_ImportCryptoCertAndKey=function(a,b,c,d,e,f,g){var h='{"function":"SOF_ImportCryptoCertAndKey", "deviceName":"'+_curDevName+'", "containerName":"'+a+'", "cert":"'+b+'", "asymAlg":'+c+', "sessionKey":"'+d+'", "symAlg":"'+e+'", "encrypedData":"'+f+', + "mode":'+g+"}";try{AjaxIO(h)}catch(i){return-3}var j=GetHttpResult();return j?j.rtn:-2},this.SOF_GenerateRandom=function(a){var b='{"function":"SOF_GenRandom", "deviceName":"'+_curDevName+'", "inDataLen":'+a+"}";try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.outData:-2},this.SOF_SymEncryptFile=function(a,b,c,d){var e='{"function":"SOF_SymEncryptFile", "deviceName":"'+_curDevName+'", "sessionKey":"'+a+'", "inFile":"'+b.replace(/\\/g,"\\\\")+'", "outFile":"'+c.replace(/\\/g,"\\\\")+'", "type":'+d+"}";try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.rtn:-2},this.SOF_SymDecryptFile=function(a,b,c,d){var e='{"function":"SOF_SymDecryptFile", "deviceName":"'+_curDevName+'", "sessionKey":"'+a+'", "inFile":"'+b.replace(/\\/g,"\\\\")+'", "outFile":"'+c.replace(/\\/g,"\\\\")+'", "type":'+d+"}";try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.rtn:-2},this.SOF_SymEncryptData=function(a,b){var c='{"function":"SOF_SymEncryptData", "deviceName":"'+_curDevName+'", "sessionKey":"'+a+'", "inData":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.outData:null},this.SOF_SymDecryptData=function(a,b){var c='{"function":"SOF_SymDecryptData", "deviceName":"'+_curDevName+'", "sessionKey":"'+a+'", "inData":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.outData:null},this.SOF_GenerateQRCode=function(a){var b=a.replace(/"/g,'\\"'),c='{"module":"libQR","function":"SOF_GenerateQRCode", "inData":"'+b+'"}';try{AjaxIO(c)}catch(d){return-3}var e=GetHttpResult();return e?e.outData:null},this.SOF_VerifyPinMS=function(a){var b='{"function":"SOF_VerifyPinMS", "deviceName":"'+_curDevName+'", "passWd":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:-2},this.SOF_GetHardwareType=function(){var a='{"function":"SOF_GetHardwareType", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.type:-2},this.SOF_VerifyFingerprint=function(){var a='{"function":"SOF_VerifyFingerprint", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.rtn:-2},this.SOF_EnumFiles=function(){var a='{"function":"SOF_EnumFiles", "deviceName":"'+_curDevName+'"}';try{AjaxIO(a)}catch(b){return-3}var c=GetHttpResult();return c?c.array:-2},this.SOF_ReadFile=function(a,b,c){var d='{"function":"SOF_ReadFile", "deviceName":"'+_curDevName+'", "fileName":"'+a+'", "offset":'+b+',"length":'+c+"}";try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.outData:void 0},this.SOF_WriteFile=function(a,b,c){var d='{"function":"SOF_WriteFile", "deviceName":"'+_curDevName+'", "fileName":"'+a+'", "offset":'+b+',"inData":"'+c+'"}';try{AjaxIO(d)}catch(e){return-3}var f=GetHttpResult();return f?f.rtn:void 0},this.SOF_CreateFile=function(a,b,c,d){var e='{"function":"SOF_CreateFile", "deviceName":"'+_curDevName+'","fileName":"'+a+'", "length" :'+b+', "readRight":'+c+',"writeRight":'+d+"}";try{AjaxIO(e)}catch(f){return-3}var g=GetHttpResult();return g?g.rtn:void 0},this.SOF_DeleteFile=function(a){var b='{"function":"SOF_DeleteFile", "deviceName":"'+_curDevName+'","fileName":"'+a+'"}';try{AjaxIO(b)}catch(c){return-3}var d=GetHttpResult();return d?d.rtn:void 0}}var split;split=split||function(a){var b,c=String.prototype.split,d=/()??/.exec("")[1]===a;return b=function(b,e,f){if("[object RegExp]"!==Object.prototype.toString.call(e))return c.call(b,e,f);var g,h,i,j,k=[],l=(e.ignoreCase?"i":"")+(e.multiline?"m":"")+(e.extended?"x":"")+(e.sticky?"y":""),m=0,e=new RegExp(e.source,l+"g");for(b+="",d||(g=new RegExp("^"+e.source+"$(?!\\s)",l)),f=f===a?-1>>>0:f>>>0;(h=e.exec(b))&&(i=h.index+h[0].length,!(i>m&&(k.push(b.slice(m,h.index)),!d&&h.length>1&&h[0].replace(g,function(){for(var b=1;b<arguments.length-2;b++)arguments[b]===a&&(h[b]=a)}),h.length>1&&h.index<b.length&&Array.prototype.push.apply(k,h.slice(1)),j=h[0].length,m=i,k.length>=f)));)e.lastIndex===h.index&&e.lastIndex++;return m===b.length?(j||!e.test(""))&&k.push(""):k.push(b.slice(m)),k.length>f?k.slice(0,f):k},String.prototype.split=function(a,c){return b(this,a,c)},b}();