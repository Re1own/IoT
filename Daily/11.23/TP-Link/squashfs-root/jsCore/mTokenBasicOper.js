function addOption(a,b,c){if(1==c)for(var d=0;d<a.length;++d)b.options.add(new Option(a[d],d));if(2==c)for(var d=0;d<a.length;++d)b.options.add(new Option(a[d][1],d))}function enumDevice(){var a=document.getElementById("platform").value,b=0,c=document.getElementById("sele_devices");if(c.options.length=0,b=token.SOF_LoadLibrary("GM3000PCSC"==a?token.GM3000PCSC:"GM3000"==a?token.GM3000:"K7"==a?token.K7:"TF"==a?token.TF:token.K5),0!=b)return void alert(tl("pfm.LoadOcxFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError());var d=token.SOF_EnumDevice();null!=d?addOption(d,c,1):alert(tl("pfm.UnFindAnyKey"))}function getUserList(){var a=document.getElementById("sele_devices"),b=document.getElementById("sele_contentList");b.options.length=0;var c=a.selectedIndex;if(0>c)return void alert(tl("pfm.PleaseSelectDevice"));var d=a.options[c].text,e=token.SOF_GetDeviceInstance(d,"");if(0!=e)return void alert(tl("pfm.InitFaild")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError());var f=token.SOF_GetUserList();null!=f&&f.length>0?addOption(f,b,2):alert(null==f?tl("pfm.NoCertInDev"):tl("pfm.GetCertListFailed")+","+tl("com.ErrorCode")+","+token.SOF_GetLastError())}function verifyUserPin(){var a=0,b="",c=token.SOF_GetHardwareType();if(c==token.TYPE_FPKEY)alert(tl("pfm.PleasePressInspectSignWhenLampBlink")),a=token.SOF_VerifyFingerprint(),b=tl(0==a?"pfm.FingerprintVerificationSuccess":"pfm.FingerprintVerificationFailed");else{var d=document.getElementById("txt_pwd").value;a=token.SOF_Login(d),b=tl(0==a?"pfm.PswVerificationSuccess":"pfm.PswVerificationFailed")}if(0!=a){var e=token.SOF_GetLastError(),f=token.SOF_GetPinRetryCount();return document.getElementById("tryCount").value=tl("com.LoginTimes").replace("XXXX"," "+f+" "),void alert(b+tl("com.ErrorCode")+","+e)}document.getElementById("tryCount").value="",alert(b)}function changeUserPin(){var a=document.getElementById("txt_pwd").value,b=document.getElementById("txt_Changepwd").value,c=token.SOF_ChangePassWd(a,b);alert(0!=c?tl("com.ChangePwdFailTip")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError():tl("com.ChangePwdSuccessTip"))}function getVersion(){var a=token.SOF_GetVersion();document.getElementById("contorlInfo").value=a}function exportUserCert(){document.getElementById("cerInfo").value="";var a=document.getElementById("sele_contentList");if(a.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var b=document.getElementById("sele_cerType"),c=a.options[a.selectedIndex].text;if(null==c||""==c)return void alert(tl("pfm.SelectContainerFirst"));var d=b.options[b.selectedIndex].value,e=token.SOF_ExportUserCert(c,d);null!=e&&""!=e?document.getElementById("cerInfo").value=e:alert(tl("pfm.GetCertInfoFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function getCertInfo(){if(signCert=document.getElementById("cerInfo").value,""==signCert)return void alert(tl("pfm.ExportCertFirst"));var a=document.getElementById("showcerInfo");a.value="";var b="";if(token){var c=token.SOF_GetCertInfo(signCert,token.SGD_CERT_ISSUER_CN);b+="Issuer: "+c+"\r",c=token.SOF_GetCertInfo("",token.SGD_CERT_SUBJECT),b+="Subject: "+c+"\r",c=token.SOF_GetCertInfo("",token.SGD_CERT_SUBJECT_CN),b+="Subject_CN: "+c+"\r",c=token.SOF_GetCertInfo("",token.SGD_CERT_SUBJECT_EMALL),b+="Subject_EMail: "+c+"\r",c=token.SOF_GetCertInfo("",token.SGD_CERT_SERIAL),b+="Serial: "+c+"\r",c=token.SOF_GetCertInfo("",token.SGD_CERT_CRL),b+="cRLDistributionPoints: "+c+"\r",c=token.SOF_GetCertInfo("",token.SGD_CERT_NOT_BEFORE),b+="not before: "+c+"\r",c=token.SOF_GetCertInfo("",token.SGD_CERT_VALID_TIME),b+="validTimeTo: "+c+"\r",b+=tl("com.ViewHelpFilesForMoreHelp"),a.value=b}}function getDeviceInfo(){var a=document.getElementById("deviceInfo");a.value="";var b;if(token){var c=token.SOF_GetDeviceInfo(token.SGD_DEVICE_NAME);b="Device name: "+c+"\r";var c=token.SOF_GetDeviceInfo(token.SGD_DEVICE_SUPPORT_STORANGE_SPACE);b+="Device total space: "+c+"\r";var c=token.SOF_GetDeviceInfo(token.SGD_DEVICE_SUPPORT_FREE_SAPCE);b+="Device free space: "+c+"\r";var c=token.SOF_GetDeviceInfo(token.SGD_DEVICE_HARDWARE_VERSION);b+="Hardware version: "+c+"\r";var c=token.SOF_GetDeviceInfo(token.SGD_DEVICE_SERIAL_NUMBER);b+="Device serial number: "+c+"\r";var c=token.SOF_GetDeviceInfo(token.SGD_DEVICE_MANUFACTURER);b+="Device manufacturer: "+c+"\r",b+=tl("com.ViewHelpFilesForMoreHelp"),a.value=b}}function signData(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(0==b)return void alert(tl("pfm.SelectKeyToSign"));var c=document.getElementById("mech").value,d=document.getElementById("userID").value,e=document.getElementById("originalData").value,f=token.SOF_SetDigestMethod(Number(c));f=token.SOF_SetUserID(d);var g=document.getElementById("sele_contentList");if(g.selectedIndex<0)return void alert(tl("pfm.EnumContainerFirst"));var h=g.options[g.selectedIndex].text;if(null==h||""==h)return void alert(tl("pfm.SelectContainerFirst"));var i=token.SOF_SignData(h,b,_Base64encode(e),e.length);null!=i&&""!=i?document.getElementById("signedData").value=i:alert(tl("pfm.SignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function signData_P7(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(0==b)return void alert(tl("pfm.SelectKeyToSign"));var c=document.getElementById("mech").value,d=document.getElementById("userID").value,e=document.getElementById("originalData").value,f=token.SOF_SetDigestMethod(Number(c));f=token.SOF_SetUserID(d);var g=document.getElementById("sele_contentList");if(g.selectedIndex<0)return void alert(tl("pfm.EnumContainerFirst"));var h=g.options[g.selectedIndex].text;return null==h||""==h?void alert(tl("pfm.SelectContainerFirst")):(signed=token.SOF_SignDataToPKCS7(h,b,_Base64encode(e),0),void(null!=signed&&""!=signed?document.getElementById("signedData").value=signed:alert(tl("pfm.SignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())))}function signFile(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(0==b)return void alert(tl("pfm.SelectKeyToSign"));var c=document.getElementById("mech").value,d=document.getElementById("userID").value,e=document.getElementById("signFile").value,f=token.SOF_SetDigestMethod(Number(c));f=token.SOF_SetUserID(d);var g=document.getElementById("sele_contentList");if(g.selectedIndex<0)return void alert(tl("pfm.EnumContainerFirst"));var h=g.options[g.selectedIndex].text;if(null==h||""==h)return void alert(tl("pfm.SelectContainerFirst"));var i=token.SOF_SignFileToPKCS7(h,b,e);null!=i&&""!=i?document.getElementById("signedData").value=i:alert(tl("pfm.SignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function verifySignFile(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(0==b)return void alert(tl("pfm.SelectKeyToSign"));var c=document.getElementById("mech").value,d=document.getElementById("userID").value,e=document.getElementById("signFile").value,f=document.getElementById("signedData").value;if(null==f||f.length<=0)return void alert(tl("pfm.SignFirst"));var g=document.getElementById("sele_contentList");if(g.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var a=document.getElementById("sele_cerType"),h=g.options[g.selectedIndex].text;if(null==h||""==h)return void alert(tl("pfm.SelectContainerFirst"));var i=(token.SOF_ExportUserCert(h,b),token.SOF_SetDigestMethod(Number(c)));i=token.SOF_SetUserID(d),i=token.SOF_VerifyFileToPKCS7(f,e),alert(0!=i?tl("pfm.InspectionSignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError():tl("pfm.InspectionSignSuccess"))}function verifySign(){var a=document.getElementById("mech").value,b=document.getElementById("userID").value,c=document.getElementById("originalData").value,d=document.getElementById("signedData").value;if(null==d||d.length<=0)return void alert(tl("pfm.SignFirst"));var e=document.getElementById("sele_contentList");if(e.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var f=document.getElementById("sele_cerType"),g=e.options[e.selectedIndex].text;if(null==g||""==g)return void alert(tl("pfm.SelectContainerFirst"));var h=f.options[f.selectedIndex].value,i=document.getElementById("cerInfo").value;""==i&&(i=token.SOF_ExportUserCert(g,h));var j=token.SOF_SetUserID(b);j=token.SOF_VerifySignedData(i,Number(a),_Base64encode(c),d),alert(0!=j?tl("pfm.InspectionSignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError():tl("pfm.InspectionSignSuccess"))}function verifySign_P7(){var a=document.getElementById("mech").value,b=document.getElementById("userID").value,c=document.getElementById("originalData").value,d=document.getElementById("signedData").value;if(null==d||d.length<=0)return void alert(tl("pfm.SignFirst"));var e=document.getElementById("sele_contentList");if(e.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var f=document.getElementById("sele_cerType"),g=e.options[e.selectedIndex].text;if(null==g||""==g)return void alert(tl("pfm.SelectContainerFirst"));var h=f.options[f.selectedIndex].value,i=(token.SOF_ExportUserCert(g,h),token.SOF_SetDigestMethod(Number(a)));i=token.SOF_SetUserID(b),i=token.SOF_VerifyDataToPKCS7(d,_Base64encode(c),0),alert(0!=i?tl("pfm.InspectionSignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError():tl("pfm.InspectionSignSuccess"))}function encryptData(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(1==b)return void alert(tl("pfm.SelectCertToEncry"));var c=document.getElementById("encrymech").value,d=document.getElementById("iv").value,e=document.getElementById("enData").value,f=document.getElementById("sele_contentList");if(f.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var g=f.options[f.selectedIndex].text;if(null==g||""==g)return void alert(tl("pfm.SelectContainerFirst"));var h=token.SOF_ExportUserCert(g,b);token.SOF_SetEncryptMethodAndIV(c,_Base64encode(d));var i=token.SOF_EncryptDataPKCS7(h,_Base64encode(e),e.length);null!=i||""==i?document.getElementById("enedData").value=i:alert(tl("pfm.PublicKeyEncryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function encryptFile(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(1==b)return void alert(tl("pfm.SelectCertToEncry"));var c=document.getElementById("encrymech").value,d=document.getElementById("iv").value,e=document.getElementById("enFile").value,f=document.getElementById("enDstFile").value,g=document.getElementById("sele_contentList");if(g.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var h=g.options[g.selectedIndex].text;if(null==h||""==h)return void alert(tl("pfm.SelectContainerFirst"));var i=token.SOF_ExportUserCert(h,b);token.SOF_SetEncryptMethodAndIV(c,_Base64encode(d));var j=token.SOF_EncryptFileToPKCS7(i,e,f,1);null!=j?document.getElementById("enedData").value=j:alert(tl("pfm.PublicKeyEncryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function decryptFile(){var a=document.getElementById("encrymech").value,b=document.getElementById("iv").value,c=document.getElementById("enFile").value,d=document.getElementById("enDstFile").value,e=document.getElementById("enedData").value;if(null==e||e.length<=0)return void alert(tl("pfm.EncryFirst"));var f=document.getElementById("sele_contentList");if(f.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var g=f.options[f.selectedIndex].text;if(null==g||""==g)return void alert(tl("pfm.SelectContainerFirst"));token.SOF_SetEncryptMethodAndIV(a,_Base64encode(b));var h=document.getElementById("sele_cerType"),i=h.options[h.selectedIndex].value;c+=".plainText",decryptedData=token.SOF_DecryptFileToPKCS7(g,i,e,d,c,1),0!=decryptedData?alert(tl("pfm.DecryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError()):(document.getElementById("deData").value=c,alert(tl("pfm.DecrySuccess")+","+tl("pfm.TargetFile")+c))}function decryptData(){var a=document.getElementById("encrymech").value,b=document.getElementById("iv").value,c=document.getElementById("enedData").value;if(null==c||c.length<=0)return void alert(tl("pfm.EncryFirst"));var d=document.getElementById("sele_contentList");if(d.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var e=d.options[d.selectedIndex].text;if(null==e||""==e)return void alert(tl("pfm.SelectContainerFirst"));token.SOF_SetEncryptMethodAndIV(a,_Base64encode(b));var f=document.getElementById("sele_cerType"),g=f.options[f.selectedIndex].value;decryptedData=token.SOF_DecryptDataPKCS7(e,g,c),null!=decryptedData&&""!=decryptedData?document.getElementById("deData").value=_Base64decode(decryptedData):alert(tl("pfm.DecryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function digestData(){var a=document.getElementById("digestmech").value,b=document.getElementById("digestData").value,c=document.getElementById("userID").value;token.SOF_SetDigestMethod(a),ret=token.SOF_SetUserID(c);var d=document.getElementById("sele_contentList");if(d.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var e=d.options[d.selectedIndex].text;return null==e||""==e?void alert(tl("pfm.SelectContainerFirst")):(digest=token.SOF_DigestData(e,_Base64encode(b),b.length),void(null!=digest?document.getElementById("digestedData").value=digest:alert(tl("pfm.DataAbstractFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())))}function GenRemoteUnlockPin(){var a=token.SOF_GenRemoteUnblockRequest();return null==a||""==a?void alert(tl("pfm.FailedToGenerateUnlockReq")):void(document.getElementById("remoteUnlockPin").value=a)}function GenUnlockPinResponse(){var a=document.getElementById("remoteUnlockPin").value,b=document.getElementById("SoPinData").value,c=document.getElementById("newPinData").value,d=token.SOF_GenResetpwdResponse(a,b,c);return null==d||""==d?void alert(tl("pfm.FailedToGenerateUnlockReq")):void(document.getElementById("remoteUnlockPin").value=d)}function RemoteUnlockPin(){var a=document.getElementById("remoteUnlockPin").value,b=token.SOF_RemoteUnblockPIN(a);return 0!=b?void alert(tl("com.UnlockFailed")):void alert(tl("com.UnlockSuccess"))}function exportPubKey(){document.getElementById("PubKey").value="";var a=document.getElementById("sele_contentList");if(a.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var b=document.getElementById("sele_cerType"),c=a.options[a.selectedIndex].text;if(null==c||""==c)return void alert(tl("pfm.SelectContainerFirst"));var d=b.options[b.selectedIndex].value,e=token.SOF_ExportPubKey(c,d);null!=e&&""!=e?document.getElementById("PubKey").value=e:alert(tl("pfm.GetPublicKeyFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function encryptbyPubKey(){var a=document.getElementById("PubKey").value,b=document.getElementById("AsymPlain").value,c=document.getElementById("sele_cerType"),d=c.options[c.selectedIndex].value,e=token.SOF_EncryptByPubKey(a,_Base64encode(b),d);null!=e&&""!=e?document.getElementById("AsymCipher").value=e:alert(tl("pfm.PublicKeyEncryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function decryptbyPrvKey(){var a=document.getElementById("sele_contentList");if(a.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var b=document.getElementById("sele_cerType"),c=a.options[a.selectedIndex].text;if(null==c||""==c)return void alert(tl("pfm.SelectContainerFirst"));var d=b.options[b.selectedIndex].value,e=document.getElementById("AsymCipher").value,f=token.SOF_DecryptByPrvKey(c,d,e);null!=f?document.getElementById("AsymPlain").value=_Base64decode(f):alert(tl("pfm.PrivateKeyDecryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function TransSignData(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(0==b)return void alert(tl("pfm.SelectKeyToSign"));var c=document.getElementById("TransDigestmech").value,d=document.getElementById("userID").value,e=document.getElementById("TransPacket").value,f=token.SOF_SetDigestMethod(Number(c));f=token.SOF_SetUserID(d);var g=document.getElementById("sele_contentList");if(g.selectedIndex<0)return void alert(tl("pfm.EnumContainerFirst"));var h=g.options[g.selectedIndex].text;if(null==h||""==h)return void alert(tl("pfm.SelectContainerFirst"));alert(tl("com.Info")+":"+tl("pfm.PressButtonInOneMinWhenLampBlink"));var i=token.SOF_SignDataInteractive(h,b,_Base64encode(e),e.length);null!=i&&""!=i?document.getElementById("TransSignedData").value=i:alert(tl("pfm.SignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function TransVerifySignature(){var a=document.getElementById("TransDigestmech").value,b=document.getElementById("userID").value,c=document.getElementById("TransPacket").value,d=document.getElementById("TransSignedData").value;if(null==d||d.length<=0)return void alert(tl("pfm.SignFirst"));var e=document.getElementById("sele_contentList");if(e.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var f=document.getElementById("sele_cerType"),g=e.options[e.selectedIndex].text;if(null==g||""==g)return void alert(tl("pfm.SelectContainerFirst"));var h=f.options[f.selectedIndex].value,i=token.SOF_ExportUserCert(g,h),j=token.SOF_SetUserID(b);j=token.SOF_VerifySignedData(i,Number(a),_Base64encode(c),d),alert(0!=j?tl("pfm.InspectionSignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError():tl("pfm.InspectionSignSuccess"))}function BB_signData(){var a=document.getElementById("sele_cerType"),b=a.options[a.selectedIndex].value;if(0==b)return void alert(tl("pfm.SelectKeyToSign"));var c=document.getElementById("BB_mech").value,d=document.getElementById("BB_userID").value,e=document.getElementById("BB_originalData").value,f=token.SOF_SetDigestMethod(Number(c));f=token.SOF_SetUserID(d);var g=document.getElementById("sele_contentList");if(g.selectedIndex<0)return void alert(tl("pfm.EnumContainerFirst"));var h=g.options[g.selectedIndex].text;if(null==h||""==h)return void alert(tl("pfm.SelectContainerFirst"));alert(tl("com.Info")+":"+tl("pfm.PressButtonInTwentySecondsWhenLampBlink"));var i=token.SOF_SignDataInteractive(h,b,_Base64encode(e),e.length);null!=i&&""!=i?document.getElementById("BB_signedData").value=i:alert(tl("pfm.SignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function BB_verifySign(){var a=document.getElementById("BB_mech").value,b=document.getElementById("BB_userID").value,c=document.getElementById("BB_originalData").value,d=document.getElementById("BB_signedData").value;if(null==d||d.length<=0)return void alert(tl("pfm.SignFirst"));var e=document.getElementById("sele_contentList");if(e.selectedIndex<0)return void alert(tl("pfm.SelectContainerFirst"));var f=document.getElementById("sele_cerType"),g=e.options[e.selectedIndex].text;if(null==g||""==g)return void alert(tl("pfm.SelectContainerFirst"));var h=f.options[f.selectedIndex].value,i=token.SOF_ExportUserCert(g,h),j=token.SOF_SetUserID(b);j=token.SOF_VerifySignedData(i,Number(a),_Base64encode(c),d),alert(0!=j?tl("pfm.InspectionSignFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError():tl("pfm.InspectionSignSuccess"))}function SymEncryptData(){var a=document.getElementById("Sym_encrymech").value,b=document.getElementById("Sym_SessionKey").value,c=document.getElementById("Sym_iv").value,d=document.getElementById("Sym_InData").value;token.SOF_SetEncryptMethodAndIV(a,_Base64encode(c));var e=token.SOF_SymEncryptData(_Base64encode(b),_Base64encode(d));null!=e||""==e?document.getElementById("Sym_enedData").value=e:alert(tl("pfm.PublicKeyEncryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function SymDecryptData(){var a=document.getElementById("Sym_encrymech").value,b=document.getElementById("Sym_SessionKey").value,c=document.getElementById("Sym_iv").value,d=document.getElementById("Sym_enedData").value;token.SOF_SetEncryptMethodAndIV(a,_Base64encode(c)),decryptedData=token.SOF_SymDecryptData(_Base64encode(b),d),null!=decryptedData&&""!=decryptedData?document.getElementById("Sym_deData").value=_Base64decode(decryptedData):alert(tl("pfm.DecryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function SymEncryptFile(){var a=document.getElementById("Sym_encrymech").value,b=document.getElementById("Sym_SessionKey").value,c=document.getElementById("Sym_iv").value,d=document.getElementById("Sym_srcFile").value,e=document.getElementById("Sym_DstFile").value;token.SOF_SetEncryptMethodAndIV(a,_Base64encode(c));var f=token.SOF_SymEncryptFile(_Base64encode(b),d,e,1);alert(0==f?tl("pfm.EncrySuccess"):tl("pfm.PublicKeyEncryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function SymDecryptFile(){var a=document.getElementById("Sym_encrymech").value,b=document.getElementById("Sym_SessionKey").value,c=document.getElementById("Sym_iv").value,d=document.getElementById("Sym_DstFile").value,e=document.getElementById("Sym_decDstFile").value;token.SOF_SetEncryptMethodAndIV(a,_Base64encode(c));var f=token.SOF_SymDecryptFile(_Base64encode(b),d,e,1);alert(0==f?tl("pfm.DecrySuccess"):tl("pfm.DecryFailed")+","+tl("com.ErrorCode")+":"+token.SOF_GetLastError())}function btnEnumFiles(){var a=document.getElementById("sel_fileList");a.options.length=0;var b=token.SOF_EnumFiles();addOption(b,a,1)}function btnReadFile(){var a=document.getElementById("sel_fileList"),b=a.selectedIndex;if(0>b)return void alert(tl("pfm.PleaseSelectDevice"));var c=a.options[b].text,d=token.SOF_ReadFile(c,0,0);document.getElementById("file_data").value=d}function btnWriteFile(){var a=document.getElementById("sel_fileList"),b=a.selectedIndex;if(0>b)return void alert(tl("pfm.PleaseSelectDevice"));var c=a.options[b].text,d=document.getElementById("file_data").value,e=token.SOF_WriteFile(c,0,d);0!=e&&alert("Failed to write file.")}if(webCaps.is_show_Ushield)var token=new mToken("mTokenPlugin");var signed;