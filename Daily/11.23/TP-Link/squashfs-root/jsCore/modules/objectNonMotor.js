!function(a){define(function(require,b,c){function d(b,c){var d=this;d.options=a.extend({},g,c),d.e=a(b).empty().append(f).translation(),d.init()}var e=require("../plugin"),f=require("./objectNonMotor.html");require("widget/js/dui.scroll");var g=null,h={CarPlate:tl("ivs_osd.TitleBit2"),VehicleColor:tl("com.Color"),VehicleType:tl("ivs_osd.TitleBit19"),VehicleSign:tl("ivs_osd.TitleBit32"),Sex:tl("Gender"),BagStatus:tl("ivs.Bag"),UpClothes:tl("ivs.UpClothes"),DownClothes:tl("ivs.DownClothes"),"com.Cyan":tl("com.Cyan"),"com.RedColor":tl("com.RedColor"),"com.BlueColor":tl("com.BlueColor"),"com.black":tl("com.black"),"com.GreenColor":tl("com.GreenColor"),"com.Yellow":tl("com.Yellow"),"com.white":tl("com.white"),"com.gray":tl("com.gray"),"com.Pink":tl("com.Pink"),"com.Purple":tl("com.Purple"),"com.DarkViolet":tl("com.DarkViolet"),"com.Maroon":tl("com.Maroon"),"com.Silver":tl("com.Silver"),"com.DimGray":tl("com.DimGray"),"com.WhiteSmoke":tl("com.WhiteSmoke"),"com.DeepSkyBlue":tl("com.DeepSkyBlue"),"com.DarkOrange":tl("com.DarkOrange"),"com.MistyRose":tl("com.MistyRose"),"com.Tomato":tl("com.Tomato"),"com.Olive":tl("com.Olive"),"com.Gold":tl("com.Gold"),"com.DarkOliveGreen":tl("com.DarkOliveGreen"),"com.ChartReuse":tl("com.ChartReuse"),"com.GreenYellow":tl("com.GreenYellow"),"com.ForestGreen":tl("com.ForestGreen"),"com.SeaGreen":tl("com.SeaGreen"),"com.Brown":tl("com.Brown"),"com.OrangeColor":tl("com.OrangeColor"),"com.Yes":tl("com.Yes"),"com.No":tl("com.No"),Glasses_Y:tl("Glasses_Y"),Glasses_N:tl("Glasses_N"),Male:tl("Male"),Female:tl("Female"),Unknown:tl("com.Unknow"),"ivs.LongSleeve":tl("ivs.LongSleeve"),"ivs.ShortSleeve":tl("ivs.ShortSleeve"),"ivs.Trousers":tl("ivs.Trousers"),"ivs.Shorts":tl("ivs.Shorts"),"ivs.Dress":tl("ivs.Dress"),"ivs.Vest":tl("ivs.Vest"),"ivs.ShortShorts":tl("ivs.ShortShorts"),"ivs.ShortSkirt":tl("ivs.ShortSkirt"),NonMotorColor:tl("ivs_osd.TitleBit11"),NumOfCycling:tl("ivs.Rider"),HelmetStatus:tl("ivs.Helmet"),"CoatColor+CoatType":tl("ivs.UpClothes"),"TrousersColor+TrousersType":tl("ivs.DownClothes"),Age:tl("Age"),Emotion:tl("Emotion"),Glasses:tl("Glasses"),"UpperBodyColor+UpClothes":tl("ivs.UpClothes"),NonMotorType:tl("ivs_osd.TitleBit19"),Tricycle:tl("itc.Tricycle"),Motorcycle:tl("ivs.TwoWheeledVehicle"),Neutral:tl("Normal"),Anger:tl("Rage"),Laugh:tl("Laughter"),Happy:tl("Jolly"),WearGlasses:tl("WearGlasses"),NoGlasses:tl("NoGlasses"),SunGlasses:tl("SunGlasses")},i={FDPictureUrl:["Sex","Age","Emotion","Glasses"],HumanTrait:["Sex","CoatColor+CoatType","TrousersColor+TrousersType","BagStatus"],NonMotorDetect:["NonMotorType","NonMotorColor","NumOfCycling","UpperBodyColor+UpClothes"]};a.fn.objectNonMotor=function(){var b=arguments[0],c=2<=arguments.length?Array.prototype.slice.call(arguments,1):[],e=this;return this.each(function(){var f=a(this),g=f.data("objectNonMotor");if(g||f.data("objectNonMotor",g=new d(f,b)),"string"===a.type(b)&&a.isFunction(g[b])){var h=g[b].apply(g,c);if(void 0!==h)return e=h,!1}}),e},d.prototype.init=function(){var b=this;b.hasInfo=!1,b.curPicNum=0,b.$picList=b.$("#object_list"),e.addEvent("HumanTrait",function(a){a=JSON.parse(a),a.HumanBody&&(a.HumanBody.Time=a.Time,b.handleInfo(a.HumanBody,"HumanTrait")),a.HumanFace&&(a.HumanFace.Time=a.Time,b.handleInfo(a.HumanFace,"FDPictureUrl"))}),e.addEvent("NonMotorDetect",function(a){a=JSON.parse(a),b.handleInfo(a,"NonMotorDetect")}),e.addEvent("TrafficJunctionObject",function(a){a=JSON.parse(a),a.NonMotorInfo&&(a.NonMotorInfo.Time=a.Time,b.handleInfo(a.NonMotorInfo,"NonMotorDetect"),a.NonMotorInfo.HumanFace&&(a.NonMotorInfo.HumanFace.Time=a.Time,b.handleInfo(a.NonMotorInfo.HumanFace,"FDPictureUrl")))}),b.$(".object").scroll({scrollYEnable:!1,scrollXEnable:!0,contentWrap:".object-pic",content:"#object_list",xBar:".object-scrollX",actionList:{x:".object-dragX"}}),b.$objectDialog=b.$("#object_dialog").dialog({close:function(){e.cover(b.options.video),webApp.hide_by_dialog=!1}}).detach().appendTo(document.body),b.e.on("mousedown",function(a){a.stopPropagation()}),b.$objectDialog.on("mousedown",function(a){a.stopPropagation()}),ability.get("IVSCaps").done(function(b){var c=b.SupportedScenes.ObjectDetect.SupportedRules.FaceDetection,d="";c&&a.each(c.FeatureList,function(a,b){d+='<li><span t="'+b+'+:"></span><span key='+b+"></span></li>"})}),b.$("#object_list").delegate("li","click",function(){webApp.hide_by_dialog=!0,e.hide();var c=a(this).data("info")||{};b.showInfo(c),b.$objectDialog.dialog("show"),a(".u-mask").on("mousedown.face",function(a){a.stopPropagation()})})},d.prototype.handleInfo=function(a,b){var c=this;c.hasInfo||(c.$("#object_list").show(),c.$(".object-none").hide(),c.hasInfo=!0),++c.curPicNum>200&&(c.$picList.find("li:last").remove(),c.curPicNum--),c.addObject(a,b)},d.prototype.showInfo=function(b){var c=this,d=b.Type,e=c.$objectDialog.find("[show-for = "+d+"]").show();c.$objectDialog.find("[show-for][show-for != "+d+"]").hide(),c.$objectDialog.find("[key = Time]").html(b.Time||"--"),e.find(".attrImg").prop("src",b.url||b.PrewViewUrl),e.find("[key]").each(function(){var c=a(this).attr("key");a(this).html(h[b[c]]||tl(b[c]))})},d.prototype.addObject=function(b,c){var d=this;b.Type=c;var e=a("<li></li>");e.data("info",b);var f='<img src="'+(b.url||b.PrewViewUrl)+'" /><div class="traffic-detail">';a.each(i[c],function(a,c){var d="";if(c.indexOf("+")>-1){for(var e=c.split("+"),g=0;g<e.length;g++){var i=b[e[g]];"Unknown"!==i&&void 0!==i&&"com.other"!==i&&(d+=h[i])}d=d||h.Unknown}else d=h[b[c]],d=void 0===d?tl(b[c]):d;f+="<div><span>"+h[c]+":</span><span>"+d+"</span></div>"}),f+='</div><div class="face-info"><span class="fn-left">'+b.Time+"</span></div>",e.html(f),d.$picList.prepend(e),d.resize()},d.prototype.resize=function(){var a=this;a.$(".object").scroll("resize")},d.prototype.destroy=function(){var a=this;a.hasInfo=!1,a.curPicNum=0,a.$("#object_list").empty().hide(),a.$(".object-none").show(),e.StopRecvFacePic(),e.StopHttpServer()},d.prototype.$=function(a){return this.e.find(a)},c.exports=d})}(jQuery);